function add_zero(lngValue){var strResult=lngValue.toString();if(lngValue<10)strResult="0"+strResult;return strResult}function transferNullToBlank(strValue){if(strValue==null)return"";return strValue}function left(mainStr,lngLen){if(mainStr==null)return null;if(lngLen>0)return mainStr.substring(0,lngLen);else return null}
function right(mainStr,lngLen){if(mainStr==null)return null;if(mainStr.length-lngLen>=0&&mainStr.length>=0&&mainStr.length-lngLen<=mainStr.length)return mainStr.substring(mainStr.length-lngLen,mainStr.length);else return null}function convertHHMMToDt(strDate){if(strDate&&strDate!="")return new Date($("#hidShowDate").val()+" "+strDate+":00");else return""}
function htmlEncode(text){try{return text.replace(/&/g,"&amp").replace(/\"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}catch(e){return""}}function htmlDecode(text){try{return text.replace(/&amp;/g,"&").replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">")}catch(e){return""}}function LimitString(strString,nLimitNum){if(strString.length>nLimitNum)strString=left(strString,nLimitNum-1)+"...";return strString}
Array.prototype.indexOf=function(val){for(var i=0;i<this.length;i++)if(this[i]==val)return i;return-1};Array.prototype.removeValue=function(val){var index=this.indexOf(val);if(index>-1)this.splice(index,1)};Array.prototype.remove=function(dx){if(isNaN(dx)||dx>this.length)return false;for(var i=0,n=0;i<this.length;i++)if(this[i]!=this[dx])this[n++]=this[i];this.length-=1};String.prototype.LTrim=function(){return this.replace(/(^\s*)/g,"")};
String.prototype.RTrim=function(){return this.replace(/(\s*$)/g,"")};String.prototype.Trim=function(){return this.replace(/(^\s*)|(\s*$)/g,"")};function OperationObj(callMethodName,parameter,callBackMethodName,excuteMethodName){this.callMethodName=callMethodName;this.parameter=parameter;this.callBackMethodName=callBackMethodName;this.excuteMethodName=excuteMethodName}
function DoCallBack(callMethodName,parameter,callBackMethodName,excuteMethodName){parameter.PreRefreshDateTime=GetPreRefreshDate();if(gOperationList.length==0)switch(callMethodName){case C_CALLBACK_WND101:gCallbackSC3240101.doCallback(parameter,callBackMethodName);break;case C_CALLBACK_WND201:gCallbackSC3240201.doCallback(parameter,callBackMethodName);break;case C_CALLBACK_WND301:gCallbackSC3240301.doCallback(parameter,callBackMethodName);break;case C_CALLBACK_WND501:gCallbackSC3240501.doCallback(parameter,
callBackMethodName);break;case C_CALLBACK_WND701:gCallbackSC3240701.doCallback(parameter,callBackMethodName);break}var objSubOperation=new OperationObj(callMethodName,parameter,callBackMethodName,excuteMethodName);ReplaceOperationList(objSubOperation)}
function AfterCallBack(){if(gOperationList.length>0)gOperationList.shift();if(gOperationList.length>0)switch(gOperationList[0].callMethodName){case C_CALLBACK_WND101:gCallbackSC3240101.doCallback(gOperationList[0].parameter,gOperationList[0].callBackMethodName);break;case C_CALLBACK_WND201:gCallbackSC3240201.doCallback(gOperationList[0].parameter,gOperationList[0].callBackMethodName);break;case C_CALLBACK_WND301:if(GetOperationType(gOperationList[0].parameter.ButtonID)==C_OPERATIONTYPE_OTHER)gCallbackSC3240301.doCallback(gOperationList[0].parameter,
gOperationList[0].callBackMethodName);else if(gOpenningSubBoxId==gOperationList[0].parameter.ButtonID)gCallbackSC3240301.doCallback(gOperationList[0].parameter,gOperationList[0].callBackMethodName);else AfterCallBack();break;case C_CALLBACK_WND501:gCallbackSC3240501.doCallback(gOperationList[0].parameter,gOperationList[0].callBackMethodName);break;case C_CALLBACK_WND701:gCallbackSC3240701.doCallback(gOperationList[0].parameter,gOperationList[0].callBackMethodName);break}}
function ClearOperationList(){gOperationList=new Array}
function ReplaceOperationList(addItem){if(gOperationList.length>1){var replaceFlg=false;if(addItem.callMethodName==C_CALLBACK_WND301&&GetOperationType(addItem.parameter.ButtonID)==C_OPERATIONTYPE_GETSUBBOXCHIP)for(var i=1;i<gOperationList.length;++i)switch(gOperationList[i].excuteMethodName){case "ShowReceptionchip":case "ShowAddWorkchip":case "ShowCompletionchip":case "ShowCarWashchip":case "ShowDeliverdCarchip":case "ShowNoShowchip":case "ShowStopchip":if(replaceFlg)gOperationList.splice(i,1);else{gOperationList.splice(i,
1,addItem);replaceFlg=true}break}else if(addItem.callMethodName==C_CALLBACK_WND101&&addItem.excuteMethodName=="GetTechnicians")for(var i=1;i<gOperationList.length;++i)if(gOperationList[i].excuteMethodName=="GetTechnicians"){replaceFlg=true;break}if(!replaceFlg)gOperationList.push(addItem)}else gOperationList.push(addItem)}
function DateFormat(inDate,fmt){var reDate=fmt;var o={"M+":inDate.getMonth()+1,"d+":inDate.getDate(),"H+":inDate.getHours(),"m+":inDate.getMinutes(),"s+":inDate.getSeconds(),"q+":Math.floor((inDate.getMonth()+3)/3),"S":inDate.getMilliseconds()};if(/(y+)/.test(fmt))reDate=reDate.replace(RegExp.$1,(inDate.getFullYear()+"").substr(4-RegExp.$1.length));for(var k in o)if((new RegExp("("+k+")")).test(fmt))reDate=reDate.replace(RegExp.$1,RegExp.$1.length==1?o[k]:("00"+o[k]).substr((""+o[k]).length));return reDate}
;
