jQuery.event.special.chipTap={setup:function(){return function(){var touchStart=false;var touchMove=false;var singleTap=false;$(this).bind(C_TOUCH_START,function(event){if(event.type=="touchstart")gTouchStartFlg=true;else if(gTouchStartFlg)return;touchStart=true;touchMove=false;singleTap=!singleTap});$(this).bind(C_TOUCH_MOVE,function(event){if(event.type=="touchmove");else if(gTouchStartFlg)return;if(!touchStart)return;touchMove=true;singleTap=false});$(this).bind(C_TOUCH_END,function(event){if(event.type==
"touchend");else if(gTouchStartFlg)return;if(!touchStart)return;if(touchMove)return;touchStart=false;touchMove=false;var obj=$(this);obj.trigger("chipTap")})}}()};
$(function(){SetServerTimeDifference();GetSC3240101WordIni();GetSC3240301WordIni();$("#MainAreaActiveIndicator").addClass("show");gArrTimeoutValue=new Array;RefreshMainWndTimer(ReDisplay);gUpdatingDisplayFlg=true;gMaxRow=parseInt(document.getElementById("hidMaxRow").value);if(document.getElementById("hidDateFormatMMdd").value!="")gDateFormatMMdd=document.getElementById("hidDateFormatMMdd").value;if(document.getElementById("hidDateFormatHHmm").value!="")gDateFormatHHmm=document.getElementById("hidDateFormatHHmm").value;
if(document.getElementById("hidDateFormatYYYYMMddHHmm").value!="")gDateFormatYYYYMMddHHmm=document.getElementById("hidDateFormatYYYYMMddHHmm").value;gOpeCode=parseInt(document.getElementById("hidOpeCode").value);if(gOpeCode==C_OPECODE_CT||gOpeCode==C_OPECODE_CHT){if($(".InitFooterButton_Space").length==2)$(".InitFooterButton_Space").width(90)}else if($(".InitFooterButton_Space").length==2)$(".InitFooterButton_Space").width(48);SetFooterApplication();SetStallDate();CreateTable();InitializationSubChip("");
HideAplicationButton();var jsonData=$("#hidSessionValue").val();if(jsonData!=""){var objSelectedChip=$.parseJSON(htmlDecode(jsonData));$("#hidSessionValue").val("");var dtShowDate=new Date(objSelectedChip.DATE);dtShowDate.setHours(0);dtShowDate.setMinutes(0);dtShowDate.setSeconds(0);dtShowDate.setMilliseconds(0);var dtNow=GetServerTimeNow();dtNow.setHours(0);dtNow.setMinutes(0);dtNow.setSeconds(0);dtNow.setMilliseconds(0);if(objSelectedChip.SUB_CHIP_TYPE!=0){if(objSelectedChip.RO_STATUS==C_RO_STATUS_STARTWAIT||
objSelectedChip.RO_STATUS==C_RO_STATUS_WORKING||objSelectedChip.TEMP_FLG==C_TEMP_FLAG_ON)gSearchedSubChipAreaId=C_RECEPTION;else if(objSelectedChip.RO_STATUS==C_RO_STATUS_WAITING_FM_APPROVAL)gSearchedSubChipAreaId=C_ADDITIONALWORK;else if(objSelectedChip.SVC_STATUS==C_SVCSTATUS_DROPOFFCUSTOMER||objSelectedChip.SVC_STATUS==C_SVCSTATUS_WAITINGCUSTOMER)gSearchedSubChipAreaId=C_DELIVERDCAR;else if(objSelectedChip.SVC_STATUS==C_SVCSTATUS_CARWASHWAIT||objSelectedChip.SVC_STATUS==C_SVCSTATUS_CARWASHSTART)gSearchedSubChipAreaId=
C_CARWASH;else if(objSelectedChip.SVC_STATUS==C_SVCSTATUS_NOSHOW&&objSelectedChip.STALL_USE_STATUS==C_STALLUSE_STATUS_NOSHOW)gSearchedSubChipAreaId=C_NOSHOW;else if(objSelectedChip.STALL_USE_STATUS==C_STALLUSE_STATUS_STOP)gSearchedSubChipAreaId=C_STOP;else if(objSelectedChip.INSPECTION_STATUS==C_INSPECTION_APPROVAL)gSearchedSubChipAreaId=C_COMPLETIONINSPECTION;gSearchedChipId=objSelectedChip.STALL_USE_ID;gSearchedChipRoNum=objSelectedChip.RO_NUM;gSearchedChipRoSeq=objSelectedChip.RO_SEQ}else{gSearchedChipId=
objSelectedChip.STALL_USE_ID;var nChangeDays=(dtShowDate.getTime()-dtNow.getTime())/(24*60*60*1E3);ClickChangeDate(nChangeDays)}}var jsonData={Method:"ShowMainArea",ShowDate:$("#hidShowDate").val()};gCallbackSC3240101.doCallback(jsonData,SC3240101AfterCallBack)});
function ShowMainArea(method){if(gCanScrollFlg)ScrollWindowToNowTime(true);else gCanScrollFlg=true;var strBackSubChipId="";var objBackSubChip=null;$(".TimingLineDeli").css("visibility","hidden");if(gArrObjSubChip[gSelectedChipId]&&(gArrObjSubChip[gSelectedChipId].subChipAreaId==C_RECEPTION||gArrObjSubChip[gSelectedChipId].subChipAreaId==C_NOSHOW||gArrObjSubChip[gSelectedChipId].subChipAreaId==C_STOP)){strBackSubChipId=gSelectedChipId;CreateChips();SubChipTap(gArrObjSubChip[strBackSubChipId]);objBackSubChip=
gMovingChipObj}else{if(gOpenningSubBoxId!="")SetSubChipBoxClose();CreateChips();if(gSelectedChipId=="")CreateFooterButton(C_FT_DISPTP_UNSELECTED,0)}ShowCalendar();InitRedTimeLinePropty();gMainAreaActiveIndicator.hide();if(method=="ShowMainArea"){ClearMainWndTimer();gUpdatingDisplayFlg=false}if(strBackSubChipId!=""){gSelectedChipId=strBackSubChipId;gMovingChipObj=objBackSubChip}}
function RefreshMainArea(strChipData){if(gCanScrollFlg)ScrollWindowToNowTime(true);else gCanScrollFlg=true;SetSubChipBoxClose();ShowLatestChips(strChipData,false,true);InitRedTimeLinePropty();gMainAreaActiveIndicator.hide();ClearMainWndTimer();gUpdatingDisplayFlg=false}function SetServerTimeDifference(){var pageLoadServerTime=new Date($("#hidServerTime").val());var pageLoadClientTime=new Date;gServerTimeDifference=pageLoadServerTime-pageLoadClientTime}
function GetServerTimeNow(){var serverTime=new Date;serverTime.setTime(serverTime.getTime()+gServerTimeDifference);return serverTime}function GetSC3240101WordIni(){var strWordIni=$("#hidMsgData").val();if(gSC3240101WordIni==null){gSC3240101WordIni=$.parseJSON(strWordIni);for(var strWordNo in gSC3240101WordIni)gSC3240101WordIni[strWordNo]=htmlDecode(gSC3240101WordIni[strWordNo]);$("#hidMsgData").attr("value","")}}
function ShowSC3240101Msg(strWordNo,stallId){if(gSC3240101WordIni!=null)if(gSC3240101WordIni[strWordNo]!=null){var strMsg=gSC3240101WordIni[strWordNo];if(strWordNo==911){strMsg=strMsg.replace("{0}",add_zero(gStartWorkTime.getHours()));strMsg=strMsg.replace("{1}",add_zero(gStartWorkTime.getMinutes()))}else if(strWordNo==912){strMsg=strMsg.replace("{0}",add_zero(gEndWorkTime.getHours()));strMsg=strMsg.replace("{1}",add_zero(gEndWorkTime.getMinutes()))}else if(strWordNo==937){var stallName=$("#ulStall #stallId_"+
stallId+" #lblStallName").text();if(stallName!=" "&&stallName!=C_STR_DEFAULT_VALUE)strMsg=strMsg.replace("{0}",stallName);else strMsg=gSC3240101WordIni[910]}alert(strMsg)}}function ConfirmSC3240101Msg(strWordNo){if(gSC3240101WordIni!=null)if(gSC3240101WordIni[strWordNo]!=null)return confirm(gSC3240101WordIni[strWordNo])}
function RefreshMainWndTimer(refreshFunc){var refreshTime=Number($("#MstPG_RefreshTimerTime").val());var rtValue=setTimeout(function(){var messageString=$("#MstPG_RefreshTimerMessage1").val();alert(messageString);ClearAllMainWndTimer();refreshFunc()},refreshTime);gArrTimeoutValue.push(rtValue)}function ClearMainWndTimer(){if(gArrTimeoutValue.length>0){clearTimeout(gArrTimeoutValue[0]);gArrTimeoutValue.splice(0,1)}}
function ClearAllMainWndTimer(){for(var nLoop=0;nLoop<gArrTimeoutValue.length;nLoop++)clearTimeout(gArrTimeoutValue[nLoop]);gArrTimeoutValue.length=0;ClearOperationList()}
function SetStallDate(){var strStartWorkTime=$("#hidShowDate").val()+" "+document.getElementById("hidStallStartTime").value;var strEndWorkTime=$("#hidShowDate").val()+" "+document.getElementById("hidStallEndTime").value;gStartWorkTime=new Date(strStartWorkTime);gEndWorkTime=new Date(strEndWorkTime);gResizeInterval=parseInt(document.getElementById("hidIntervlTime").value);gRefreshTimerInterval=parseInt(document.getElementById("hidTabletSmbRefreshInterval").value);if(gEndWorkTime-gStartWorkTime<0)gEndWorkTime.setTime(gEndWorkTime.getTime()+
24*60*60*1E3)}function ClickGBook(){gMainAreaActiveIndicator.show();var strParam;if(gArrObjSubChip[gSelectedChipId]){strParam="{";strParam+='"OperationCode":"'+C_FT_BTNID_GBOOK+'"';strParam+=',"VclID":"'+gArrObjSubChip[gSelectedChipId].vclId+'"';strParam+="}"}else{strParam="{";strParam+='"OperationCode":"'+C_FT_BTNID_GBOOK+'"';strParam+=',"VclID":"'+gArrObjChip[gSelectedChipId].vclId+'"';strParam+="}"}__doPostBack("",strParam);return false}
function GetDeliDelayExpectedTimeLine(carWashNeedFlg,scheDeliDateTime,svcStatus,inspectionType){var nDeliWorkTime=parseInt($("#hidStandardDeliWrTime").val(),10);var nDeliPreTime=parseInt($("#hidStandardDeliPreTime").val(),10);var nWashTime=parseInt($("#hidStandardWashTime").val(),10);var nInspectionTime=parseInt($("#hidStandardInspectionTime").val(),10);var dtScheDeliLater=new Date;var addLongTime=0;if(nDeliPreTime>nWashTime)addLongTime=nDeliPreTime;else addLongTime=nWashTime;if(svcStatus==C_SVCSTATUS_CARWASHSTART||
svcStatus==C_SVCSTATUS_DROPOFFCUSTOMER||svcStatus==C_SVCSTATUS_WAITINGCUSTOMER)dtScheDeliLater.setTime(scheDeliDateTime.getTime()-nDeliWorkTime*6E4);else if(svcStatus==C_SVCSTATUS_CARWASHWAIT)dtScheDeliLater.setTime(scheDeliDateTime.getTime()-(nWashTime+nDeliWorkTime)*6E4);else{if(inspectionType==C_NOTFINISH_FINAL_INSPECTION)dtScheDeliLater.setTime(scheDeliDateTime.getTime()-(nInspectionTime+nDeliWorkTime)*6E4);else dtScheDeliLater.setTime(scheDeliDateTime.getTime()-nDeliWorkTime*6E4);if(carWashNeedFlg==
"1")dtScheDeliLater.setTime(dtScheDeliLater.getTime()-addLongTime*6E4);else dtScheDeliLater.setTime(dtScheDeliLater.getTime()-nDeliPreTime*6E4)}return dtScheDeliLater};
