function CreateTable(){gSelectedCellId="";var nWorkTime=gEndWorkTime.getHours()-gStartWorkTime.getHours();if(gEndWorkTime.getMinutes()>0)nWorkTime+=1;gMaxCol=nWorkTime*4;BindAllAreaClickEvent();BindStallAreaClickEvent();$("#divScrollTime").css("width",gMaxCol*C_CELL_WIDTH+"px");var strHtml="";for(var nRow=1;nRow<=gMaxRow;nRow++)strHtml+="<div class='TbRow Row"+nRow+"'></div>";document.getElementById("ulChipAreaBack_lineBox").innerHTML="";document.getElementById("ulChipAreaBack_lineBox").innerHTML=
strHtml;$(".TbRow").css("width",gMaxCol*C_CELL_WIDTH+"px");var nTop=0;for(var nRow=1;nRow<=gMaxRow;nRow++){$(".Row"+nRow).css("top",nTop);$(".stallNo"+nRow).css("top",nTop);nTop+=C_CELL_HEIGHT}$(".NameList").css("visibility","visible");$(".ChipArea").css("width",gMaxCol*C_CELL_WIDTH+C_CHIPAREA_OFFSET_LEFT+"px");$(".ChipArea").css("height",gMaxRow*C_CELL_HEIGHT+C_CHIPAREA_OFFSET_TOP+"px");$("#divScrollStall").css("height",gMaxRow*C_CELL_HEIGHT+C_CHIPAREA_OFFSET_TOP+"px");if(gMaxRow<8){var nChipAreaTrimmingHeight=
gMaxRow*C_CELL_HEIGHT+C_CHIPAREA_OFFSET_TOP;$(".ChipArea_trimming").height(nChipAreaTrimmingHeight);$(".SMB_Main").height(nChipAreaTrimmingHeight)}$(".ChipArea_trimming").SmbFingerScroll({mergeLeft:$("#divScrollTime")[0],mergeTop:$("#divScrollStall")[0],minLeft:$(".ChipArea_trimming").width()-$(".ChipArea").width(),minTop:$(".ChipArea_trimming").height()-$(".ChipArea").height()});$(".ChipArea_trimming .scroll-inner").height(gMaxRow*C_CELL_HEIGHT+C_CHIPAREA_OFFSET_TOP);$(".ChipArea_trimming .scroll-inner").width(gMaxCol*
C_CELL_WIDTH+C_CHIPAREA_OFFSET_LEFT);$("#divScrollStall").css({"box-shadow":"2px 2px 10px #000"});$("#StopMemoScrollBox").SC3240101StopmemoFingerscroll();$("#StopMemoScrollBox .scroll-inner").height($("#StopMemoScrollBox .innerDataBox").height());BindCellTapEvent();BindStopWndEvent();BindTechniacianTapEvent();BindCustomerDetailEvent();$("#MainArea").bind(C_TOUCH_END,function(e){if(gStopFingerScrollFlg){$(".ChipArea_trimming").SmbFingerScroll({action:"restart"});gStopFingerScrollFlg=false}});
if(gScrollTimerInterval=="")gScrollTimerInterval=setInterval("SlideTimeLineInOneMinute()",C_INTERVAL_TIME);if(gFuncRefreshTimerInterval=="")gFuncRefreshTimerInterval=setInterval("RefreshSMB()",gRefreshTimerInterval*1E3);var template$=$("#pullDownToRefreshTemplate .pullDownToRefresh");$("#PullDownToRefreshDiv").append(template$)}
function ShowIdleArea(strStallIdleInfo){$(".Idle").remove();$("#ulStall li").removeClass("WhiteBack");var stallIdleList=$.parseJSON(strStallIdleInfo);for(var keyString in stallIdleList)switch(stallIdleList[keyString].IDLE_TYPE){case "0":SetIdleStallColorWhite(stallIdleList[keyString].STALL_ID);break;case "1":DrawRestArea(stallIdleList[keyString].STALL_IDLE_ID,stallIdleList[keyString].STALL_ID,stallIdleList[keyString].IDLE_START_TIME,stallIdleList[keyString].IDLE_END_TIME);break;case "2":DrawUnavailableArea(stallIdleList[keyString].STALL_IDLE_ID,
stallIdleList[keyString].STALL_ID,stallIdleList[keyString].IDLE_START_DATETIME,stallIdleList[keyString].IDLE_END_DATETIME,stallIdleList[keyString].ROW_LOCK_VERSION,stallIdleList[keyString].IDLE_MEMO);break}}
function UpdateIdleArea(strStallIdleInfo){var stallIdleList=$.parseJSON(strStallIdleInfo);for(var keyString in stallIdleList){var bSelectedFlg=false;switch(stallIdleList[keyString].IDLE_TYPE){case "2":if($("#"+C_UNAVALIABLECHIPID+stallIdleList[keyString].STALL_IDLE_ID).length==1){if($("#"+C_UNAVALIABLECHIPID+stallIdleList[keyString].STALL_IDLE_ID).hasClass("SelectedChipShadow"))bSelectedFlg=true;$("#"+C_UNAVALIABLECHIPID+stallIdleList[keyString].STALL_IDLE_ID).remove()}DrawUnavailableArea(stallIdleList[keyString].STALL_IDLE_ID,
stallIdleList[keyString].STALL_ID,stallIdleList[keyString].IDLE_START_DATETIME,stallIdleList[keyString].IDLE_END_DATETIME,stallIdleList[keyString].ROW_LOCK_VERSION,stallIdleList[keyString].IDLE_MEMO);if(bSelectedFlg)$("#"+C_UNAVALIABLECHIPID+stallIdleList[keyString].STALL_IDLE_ID).addClass("SelectedChipShadow SelectedChipZIndex");break}}}
function DrawRestArea(strStallIdleId,strStallId,strStartTime,strEndTime){var nRowNum=parseInt($("#stallId_"+strStallId)[0].className.substr(7));var dtShow=new Date($("#hidShowDate").val());var dtStartTime=new Date(strStartTime);var dtEndTime=new Date(strEndTime);dtStartTime.setFullYear(dtShow.getFullYear());dtEndTime.setFullYear(dtShow.getFullYear());dtStartTime.setMonth(dtShow.getMonth());dtEndTime.setMonth(dtShow.getMonth());dtStartTime.setDate(dtShow.getDate());dtEndTime.setDate(dtShow.getDate());
var nLeft=Math.round(GetXPosByTime(dtStartTime))+1;var nWidth=Math.round(GetXPosByTime(dtEndTime)-GetXPosByTime(dtStartTime))-1;var objRest=$("<div />").addClass("RestArea");objRest.attr("id",C_RESTCHIPID+strStallIdleId);objRest.append(gSC3240101WordIni[13]);objRest.css("left",nLeft).css("width",nWidth);$(".Row"+nRowNum).append(objRest);BindRestAreaEvent(C_RESTCHIPID+strStallIdleId)}
function DrawUnavailableArea(strStallIdleId,strStallId,strStartTime,strEndTime,nRowLockVersion,strIdleMemo){var bOtherFlg=false;if($("#"+C_UNAVALIABLECHIPID+strStallIdleId).length==1){$("#"+C_UNAVALIABLECHIPID+strStallIdleId).remove();SetTableUnSelectedStatus();SetChipUnSelectedStatus();bOtherFlg=true}var nRowNo=parseInt($("#stallId_"+strStallId)[0].className.substr(7));var dtStartTime=new Date(strStartTime);var dtEndTime=new Date(strEndTime);var dtShow=new Date($("#hidShowDate").val());var dtShowStartTime,
dtShowEndTime;if(dtStartTime-gStartWorkTime>=0&&dtStartTime-gEndWorkTime<0)dtShowStartTime=new Date(dtStartTime);else dtShowStartTime=new Date(gStartWorkTime);if(dtEndTime-gStartWorkTime>=0&&dtEndTime-gEndWorkTime<0)dtShowEndTime=new Date(dtEndTime);else dtShowEndTime=new Date(gEndWorkTime);var nShowWidth=Math.round(GetXPosByTime(dtShowEndTime)-GetXPosByTime(dtShowStartTime))-1;var nShowLeft=Math.round(GetXPosByTime(dtShowStartTime))+1;var objUnvaliable=CreateUnavailableChip(C_UNAVALIABLECHIPID+strStallIdleId,
strIdleMemo);objUnvaliable.css({"left":nShowLeft,"width":nShowWidth});$(".Row"+nRowNo).append(objUnvaliable);BindUnavailableAreaEvent(C_UNAVALIABLECHIPID+strStallIdleId);$("#"+C_UNAVALIABLECHIPID+strStallIdleId).data("ROW_LOCK_VERSION",nRowLockVersion);var nIdleTime=GetIdleChipMinutes(dtStartTime,dtEndTime);$("#"+C_UNAVALIABLECHIPID+strStallIdleId).data("IDLE_TIME",nIdleTime);$("#"+C_UNAVALIABLECHIPID+strStallIdleId).data("START_TIME",strStartTime);$("#"+C_UNAVALIABLECHIPID+strStallIdleId).data("END_TIME",
strEndTime);if(bOtherFlg){TapUnavailableArea(C_UNAVALIABLECHIPID+strStallIdleId);var nLeft=Math.round(GetXPosByTime(dtShowStartTime))+1;drawUnavailableAreaAtPos(nLeft,nRowNo);$("#"+C_MOVINGUNAVALIABLECHIPID+" .ShadowBox").css("display","none")}}
function GetIdleChipMinutes(dtStartTime,dtEndTime){var nOffsetdays=GetOffsetDays(dtStartTime,dtEndTime);var nStartTime=0;var nMidTime=0;var nEndTime=0;var nIdleTime=0;if(nOffsetdays>=1){nStartTime=(gEndWorkTime.getHours()-dtStartTime.getHours())*60+(gEndWorkTime.getMinutes()-dtStartTime.getMinutes());if(nStartTime<0)nStartTime=0;nEndTime=(dtEndTime.getHours()-gStartWorkTime.getHours())*60+(dtEndTime.getMinutes()-gStartWorkTime.getMinutes());if(nEndTime<0)nEndTime=0;if(nOffsetdays>1)nMidTime=(gEndWorkTime-
gStartWorkTime)/60/1E3*(nOffsetdays-1);nIdleTime=nStartTime+nEndTime+nMidTime}else nIdleTime=(dtEndTime-dtStartTime)/60/1E3;return nIdleTime}
function CreateUnavailableChip(strStallIdleId,strIdleMemo){var objUnvaliable=$("<div />").addClass(C_UNAVALIABLECHIPID);objUnvaliable.attr("id",strStallIdleId);var unavailableChipHtml="";unavailableChipHtml+="<div id=UnavailableUpperText>"+gSC3240101WordIni[12]+"</div> ";unavailableChipHtml+="<div id=UnavailableLowerText class=UnavailableEllipsis>"+strIdleMemo+"</div> ";var objShadowBox="<div class=ShadowBox>"+unavailableChipHtml+"</div>";objUnvaliable.append(objShadowBox);return objUnvaliable}
function BindRestAreaEvent(strStallIdleId){$("#"+strStallIdleId).bind("chipTap",function(e){if(gSelectedChipId!=""){var nRowNo=GetRowNoByChipId(strStallIdleId);if(IsUnavailableArea(gSelectedChipId))return false;else if(gSelectedChipId==C_OTHERDTCHIPID)if(gOtherDtChipObj.stallIdleId)return false;else return;else $(".Row"+nRowNo).append($("#"+C_MOVINGCHIPID))}})}
function BindUnavailableAreaEvent(strStallIdleId){$("#"+strStallIdleId).bind("chipTap",function(e){TapUnavailableArea(strStallIdleId)}).bind(C_TOUCH_START,function(e){var scrollMainObjPos=$(".ChipArea_trimming").find(".scroll-inner").position();gTranslateValStallX=scrollMainObjPos.left;gTranslateValStallY=scrollMainObjPos.top;gOnTouchingFlg=true;$("#"+strStallIdleId+" .ShadowBox").stop(true,true).addClass("TapBlueBack")}).bind(C_TOUCH_MOVE+" "+C_TOUCH_END,function(e){gOnTouchingFlg=false;$("#"+strStallIdleId+
" .ShadowBox").stop(true,true).removeClass("TapBlueBack")})}
function BindUnavaliableMovingChipTapEvent(){$("#"+C_MOVINGUNAVALIABLECHIPID).bind("chipTap",function(e){if(GetDisplayPopupWindow())return;$("#"+gSelectedChipId+" .ShadowBox").removeClass("TapBlueBack");$("#"+C_MOVINGUNAVALIABLECHIPID+" .ShadowBox").removeClass("TapBlueBack");setTimeout(function(){TapMovingUnavaliableChip()},0);gCanTbRowTapFlg=false}).bind(C_TOUCH_START,function(e){gOnTouchingFlg=true;if($("#"+C_MOVINGUNAVALIABLECHIPID+" .ShadowBox").css("display")=="none")$("#"+gSelectedChipId+" .ShadowBox").addClass("TapBlueBack");
else $("#"+C_MOVINGUNAVALIABLECHIPID+" .ShadowBox").addClass("TapBlueBack")}).bind(C_TOUCH_END,function(e){$("#"+gSelectedChipId+" .ShadowBox").removeClass("TapBlueBack");$("#"+C_MOVINGUNAVALIABLECHIPID+" .ShadowBox").removeClass("TapBlueBack");gOnTouchingFlg=false}).bind(C_TOUCH_MOVE,function(e){$("#"+gSelectedChipId+" .ShadowBox").removeClass("TapBlueBack");$("#"+C_MOVINGUNAVALIABLECHIPID+" .ShadowBox").removeClass("TapBlueBack");gOnTouchingFlg=false})}
function TapUnavailableArea(strStallIdleId){if(gSelectedChipId!=""){var nRowNo=GetRowNoByChipId(strStallIdleId);if(IsUnavailableArea(gSelectedChipId))return false;else if(gSelectedChipId==C_OTHERDTCHIPID)if(gOtherDtChipObj.stallIdleId)return false;else return;else if(gArrObjChip[gSelectedChipId])if(IsDefaultDate(gArrObjChip[gSelectedChipId].rsltStartDateTime))$(".Row"+nRowNo).append($("#"+C_MOVINGCHIPID));return}SetSubChipBoxClose();gSelectedChipId=strStallIdleId;if(gShowLaterStallFlg==true){ShowAllStall();
ScrollToShowChip(strStallIdleId)}SetTableSelectedStatus();CreateFooterButton(C_FT_DISPTP_SELECTED,C_FT_BTNTP_UNAVAILABLE)}
function drawUnavailableAreaAtPos(nLeft,nRowNo){if(gSelectedChipId=="")return 0;var strChipId=gSelectedChipId;if($("#"+C_MOVINGUNAVALIABLECHIPID).length==0){var objUnavailableArea=$("<div />").addClass(C_UNAVALIABLECHIPID);objUnavailableArea.attr("id",C_MOVINGUNAVALIABLECHIPID);var objShadowBox=$("<div />").addClass("ShadowBox");var nWidth;var selectedChipLowerText="";if(gSelectedChipId==C_OTHERDTCHIPID){nWidth=gOtherDtChipObj.width;gSelectedChipId=C_UNAVALIABLECHIPID+gOtherDtChipObj.stallIdleId;
$("#"+gSelectedChipId).data("IDLE_TIME",Math.round((nWidth+1)*15/C_CELL_WIDTH));if(gOtherDtChipObj.idleMemo!=undefined)selectedChipLowerText=gOtherDtChipObj.idleMemo;else selectedChipLowerText=""}else{nWidth=$("#"+gSelectedChipId).width();nLeft=$("#"+gSelectedChipId).position().left;selectedChipLowerText=document.getElementById(strChipId).getElementsByTagName("div").item(2).textContent;var dtStartTime=new Date($("#"+gSelectedChipId).data("START_TIME"));var dtEndTime=new Date($("#"+gSelectedChipId).data("END_TIME"));
var nIdleTime=GetIdleChipMinutes(dtStartTime,dtEndTime);$("#"+gSelectedChipId).data("IDLE_TIME",nIdleTime)}var unavailableChipHtml="";unavailableChipHtml+="<div id=UnavailableUpperText>"+gSC3240101WordIni[12]+"</div> ";unavailableChipHtml+="<div id=UnavailableLowerText class=UnavailableEllipsis>"+selectedChipLowerText+"</div> ";var objShadowBox="<div class=ShadowBox>"+unavailableChipHtml+"</div>";objUnavailableArea.append(objShadowBox);var objTimeKnobPointL,objTimeKnobPointR;objTimeKnobPointL=$("<div />").addClass("TimeKnobPointL TimeKnobPoint_gray");
objTimeKnobPointR=$("<div />").addClass("TimeKnobPointR TimeKnobPoint_gray");objUnavailableArea.append(objTimeKnobPointL);objUnavailableArea.append(objTimeKnobPointR);var objFrontFace=$("<div />").addClass("Front");objUnavailableArea.append(objFrontFace);$(".Row"+nRowNo).append(objUnavailableArea);$("#"+C_MOVINGUNAVALIABLECHIPID).css("width",nWidth);$("#"+C_MOVINGUNAVALIABLECHIPID).css("left",nLeft);var nOverDaysType=GetUnavailableChipOverDaysType(gSelectedChipId);if(nOverDaysType>C_OVERDAYS_NONE)switch(nOverDaysType){case C_OVERDAYS_LEFT:$("#"+
C_MOVINGUNAVALIABLECHIPID+" .TimeKnobPointL").remove();BindChipResize(C_MOVINGUNAVALIABLECHIPID,0,2);break;case C_OVERDAYS_RIGHT:$("#"+C_MOVINGUNAVALIABLECHIPID+" .TimeKnobPointR").remove();BindChipResize(C_MOVINGUNAVALIABLECHIPID,0,1);break;case C_OVERDAYS_BOTH:$("#"+C_MOVINGUNAVALIABLECHIPID+" .TimeKnobPointL").remove();$("#"+C_MOVINGUNAVALIABLECHIPID+" .TimeKnobPointR").remove();break}else BindChipResize(C_MOVINGUNAVALIABLECHIPID,0,0);$("#"+C_MOVINGUNAVALIABLECHIPID+" .CpInner").css("opacity",
C_OPACITY_TRANSPARENT);$("#"+C_MOVINGUNAVALIABLECHIPID+" .CpInner").css("visibility","hidden");ChangeChipZIndex(C_MOVINGUNAVALIABLECHIPID,"MovingChipZIndex");BindUnavaliableMovingChipTapEvent();return 1}else{if($("#"+C_MOVINGUNAVALIABLECHIPID+" .ShadowBox").css("display")=="none"){var nChipWidthTime=parseInt($("#"+gSelectedChipId).data("IDLE_TIME"));var nChipWidth=C_CELL_WIDTH/15*nChipWidthTime-1;$("#"+C_MOVINGUNAVALIABLECHIPID).css("width",nChipWidth)}$("#"+C_MOVINGUNAVALIABLECHIPID).css("left",
nLeft);$(".Row"+nRowNo).append($("#"+C_MOVINGUNAVALIABLECHIPID));return 2}}
function TapMovingUnavaliableChip(){var nMovingChipLeft,nMovingChipWidth;var strChipId=gSelectedChipId;nMovingChipLeft=$("#"+C_MOVINGUNAVALIABLECHIPID).position().left;if($("#"+gSelectedChipId).data("IDLE_TIME"))nMovingChipWidth=parseInt($("#"+gSelectedChipId).data("IDLE_TIME"))*C_CELL_WIDTH/15-1;else nMovingChipWidth=$("#"+C_MOVINGUNAVALIABLECHIPID).width();var nBackLeft,nBackRow,nBackWidth;var nRow=GetRowNoByChipId(C_MOVINGUNAVALIABLECHIPID);if(gOtherDtChipObj==null){nBackWidth=$("#"+strChipId).width();
nBackLeft=$("#"+strChipId).position().left;nBackRow=GetRowNoByChipId(strChipId);if(nMovingChipLeft==nBackLeft&&nMovingChipWidth==nBackWidth&&nRow==nBackRow){SetTableUnSelectedStatus();SetChipUnSelectedStatus();return}}if(CheckChipPos(C_MOVINGUNAVALIABLECHIPID)==false){ShowSC3240101Msg(914);$("#"+C_MOVINGUNAVALIABLECHIPID).remove();SetTableUnSelectedStatus();SetChipUnSelectedStatus();return}var nRowLockVersion;if(gOtherDtChipObj){strChipId=C_UNAVALIABLECHIPID+gOtherDtChipObj.stallIdleId;$("#"+strChipId).css("visibility",
"visible");$("#"+strChipId).css("top","1px");$("#"+strChipId).css("height","72px");$("#"+strChipId).css("opacity",C_OPACITY);if($("#"+strChipId).data("IDLE_TIME")==undefined||$("#"+strChipId).data("IDLE_TIME")==null)$("#"+strChipId).data("IDLE_TIME",15/C_CELL_WIDTH*(gOtherDtChipObj.width+1));nRowLockVersion=gOtherDtChipObj.rowLockVersion;gOtherDtChipObj=null;$("#"+strChipId).unbind();BindUnavailableAreaEvent(strChipId)}else nRowLockVersion=$("#"+strChipId).data("ROW_LOCK_VERSION");$("#"+strChipId).css("left",
nMovingChipLeft);$("#"+strChipId).css("width",nMovingChipWidth);$(".Row"+nRow).append($("#"+strChipId));var tStartTime=GetTimeByXPos(nMovingChipLeft-1);if($("#"+C_MOVINGUNAVALIABLECHIPID+" .ui-resizable-w").length==0)tStartTime=new Date($("#"+strChipId).data("START_TIME"));SetTableUnSelectedStatus();SetChipUnSelectedStatus();var nIdleTime=parseInt($("#"+strChipId).data("IDLE_TIME"));var strStallId=$(".stallNo"+nRow)[0].id;var jsonData={Method:"UpdateStallUnavailable",StallIdleId:right(strChipId,strChipId.length-
C_UNAVALIABLECHIPID.length),StallId:right(strStallId,strStallId.length-8),ShowDate:$("#hidShowDate").val(),DisplayStartDate:tStartTime,ScheWorkTime:nIdleTime,RowLockVersion:nRowLockVersion};$("#"+strChipId).data("ROW_LOCK_VERSION",parseInt(nRowLockVersion)+1);DoCallBack(C_CALLBACK_WND101,jsonData,SC3240101AfterCallBack,jsonData.Method)}
function IsUnavailableArea(strChipId){if(strChipId===undefined)return false;if(strChipId.toString().indexOf(C_UNAVALIABLECHIPID)>-1&&strChipId!=C_MOVINGUNAVALIABLECHIPID)return true;return false}function IsKariKariChip(strChipId){if(strChipId===undefined)return false;if(strChipId.toString().indexOf(C_KARIKARICHIPID)>-1)return true;return false}function IsRestArea(strChipId){if(strChipId===undefined)return false;if(strChipId.toString().indexOf(C_RESTCHIPID)>-1)return true;return false}
function AdjuestTechnicianNameArea(){var strHtml;var nHeight=$(".stallNo1 .Technician").height();var nCount=4;for(var nRow=1;nRow<=gMaxRow;nRow++){for(var nLoop=1;nLoop<=4;nLoop++){strHtml=document.getElementById("spanTechnician"+nRow+"_"+nLoop).innerHTML;if(strHtml.trim()==""){nCount=nLoop-1;break}}if(nCount==1){$(".stallNo"+nRow+" .Technician .TechnicianName").css("line-height",""+nHeight/nCount+"px");$(".stallNo"+nRow+" .Technician .TechnicianName:eq(0)").css({"position":"","top":""});$(".stallNo"+
nRow+" .Technician .TechnicianName:eq(2)").css({"position":"","top":""})}else if(nCount==3){$(".stallNo"+nRow+" .Technician .TechnicianName").css("line-height",""+nHeight/nCount+"px");$(".stallNo"+nRow+" .Technician .TechnicianName:eq(0)").css({"position":"relative","top":"7px"});$(".stallNo"+nRow+" .Technician .TechnicianName:eq(2)").css({"position":"relative","top":"-7px"})}else{$(".stallNo"+nRow+" .Technician .TechnicianName").css("line-height",""+nHeight/4+"px");$(".stallNo"+nRow+" .Technician .TechnicianName:eq(0)").css({"position":"",
"top":""});$(".stallNo"+nRow+" .Technician .TechnicianName:eq(2)").css({"position":"","top":""})}nCount=4}}
function UpdateStallArea(strStallContents){gArrObjStall.length=0;var listStall=$.parseJSON(strStallContents);for(var keyString in listStall)gArrObjStall.push(listStall[keyString]);for(var nLoop=1;nLoop<=gMaxRow;nLoop++){var strStallId=$(".stallNo"+nLoop)[0].id;strStallId=strStallId.substring(8,strStallId.length);var arrStaffNames=GetTechnicianNumsByStallId(strStallId);UpdateTechnicianNameAreaByStallNo(nLoop,arrStaffNames)}AdjuestTechnicianNameArea();$("#ulStall .Technician span").CustomLabel({useEllipsis:true})}
function GetTechnicianNumsByStallId(strStallId){var arrStaffNames=new Array;for(var nLoop=0;nLoop<gArrObjStall.length;nLoop++)if(gArrObjStall[nLoop].STALLID==strStallId)arrStaffNames.push(gArrObjStall[nLoop].USERNAME);return arrStaffNames}
function UpdateTechnicianNameAreaByStallNo(nRowNo,arrStaffNames){$("#spanTechnician"+nRowNo+"_1").text("");$("#spanTechnician"+nRowNo+"_2").text("");$("#spanTechnician"+nRowNo+"_3").text("");$("#spanTechnician"+nRowNo+"_4").text("");$("#spanTechnician"+nRowNo+"_4").removeClass("TextAlignRight");if(arrStaffNames=="")return;arrStaffNames.sort();if(arrStaffNames.length==2){$("#spanTechnician"+nRowNo+"_1").text("　");$("#spanTechnician"+nRowNo+"_2").text(arrStaffNames[0],7);$("#spanTechnician"+nRowNo+
"_3").text(arrStaffNames[1],7);$("#spanTechnician"+nRowNo+"_4").text("　")}else if(arrStaffNames.length<=4)for(var nLoop=1;nLoop<=arrStaffNames.length;nLoop++)$("#spanTechnician"+nRowNo+"_"+nLoop).text(arrStaffNames[nLoop-1],7);else{for(var nLoop=1;nLoop<=3;nLoop++)$("#spanTechnician"+nRowNo+"_"+nLoop).text(arrStaffNames[nLoop-1],7);var strString=gSC3240101WordIni[2];strString=strString.replace("{0}",arrStaffNames.length-3);$("#spanTechnician"+nRowNo+"_4").text(strString);$("#spanTechnician"+nRowNo+
"_4").addClass("TextAlignRight")}}
function SetLaterStallColorRed(){var arrDelayStallId=new Array;var nDelayChipNums=0;for(var nChipNo in gArrObjChip){if(CheckgArrObjChip(nChipNo)==false)continue;gArrObjChip[nChipNo].refleshChipRedColor();if(gArrObjChip[nChipNo].delayStatus>C_NO_DELAY){arrDelayStallId=$.grep(arrDelayStallId,function(n,i){return n==gArrObjChip[nChipNo].stallId},true);arrDelayStallId.push(gArrObjChip[nChipNo].stallId);nDelayChipNums++}}$("#ulStall li").removeClass("RedBack");for(var nStallIdLoop in arrDelayStallId)$("#stallId_"+arrDelayStallId[nStallIdLoop]).addClass("RedBack");
if(arrDelayStallId.length>0){SetFooter(C_FT_BTNID_LATER,C_FT_BTNCLR_RED,C_FT_BTNDISP_OFF,nDelayChipNums);if(bkButtonID==C_FT_BTNID_LATER)bkButtonID="";if(gShowLaterStallFlg)if(bkButtonID=="")FooterIconReplace(C_FT_BTNID_LATER)}else SetFooter(C_FT_BTNID_LATER,"",C_FT_BTNDISP_OFF,"")}function SetIdleStallColorWhite(strStallId){$("#stallId_"+strStallId).addClass("WhiteBack")}
function ShowLaterStall(){if(gShowLaterStallFlg==true)ShowAllStall();else{gShowLaterStallFlg=true;$(".ChipArea_trimming").SmbFingerScroll({action:"move",moveY:$(".scroll-inner").position().top,moveX:$(".scroll-inner").position().left});var nLaterRowNum=0;for(var nLoop=1;nLoop<=gMaxRow;nLoop++)if($(".stallNo"+nLoop).hasClass("RedBack")==false){$(".stallNo"+nLoop).css("visibility","hidden");$(".Row"+nLoop).css("visibility","hidden")}else{$(".Row"+nLoop).css("top",nLaterRowNum*C_CELL_HEIGHT);$(".stallNo"+
nLoop).css("top",nLaterRowNum*C_CELL_HEIGHT);$(".stallNo"+nLoop).data("LATER_ROWNUM",nLaterRowNum+1);nLaterRowNum++}$("#ulStall li").css("position","absolute");if(nLaterRowNum<8){var nTableHeight=nLaterRowNum*C_CELL_HEIGHT+C_CHIPAREA_OFFSET_TOP;$(".SMB_Main").css("height",nTableHeight);SetTimeLineHeight(nTableHeight);$(".ChipArea_trimming").SmbFingerScroll({minTop:0})}else $(".ChipArea_trimming").SmbFingerScroll({minTop:$(".ChipArea_trimming").height()-nLaterRowNum*C_CELL_HEIGHT-$(".TimeLine").height()})}}
function ShowAllStall(){gShowLaterStallFlg=false;$(".TbRow").css("visibility","visible");$("#ulStall li").css("visibility","visible");var nTop=0;for(var nRow=1;nRow<=gMaxRow;nRow++){$(".Row"+nRow).css("top",nTop);$(".stallNo"+nRow).css("top",nTop);nTop+=C_CELL_HEIGHT}if(gMaxRow<8)$(".SMB_Main").css("height",gMaxRow*C_CELL_HEIGHT+C_CHIPAREA_OFFSET_TOP);else $(".SMB_Main").css("height",8*C_CELL_HEIGHT+C_CHIPAREA_OFFSET_TOP);var nHeight=$(".TimeLine").height();SetTimeLineHeight(gMaxRow*C_CELL_HEIGHT+
nHeight);$(".ChipArea_trimming").SmbFingerScroll({minTop:$(".ChipArea_trimming").height()-$(".ChipArea").height(),action:"move",moveY:$(".scroll-inner").position().top,moveX:$(".scroll-inner").position().left});var nCount=GetButtonIconCount(C_FT_BTNID_LATER);if(nCount>0)SetFooter(C_FT_BTNID_LATER,C_FT_BTNCLR_RED,C_FT_BTNDISP_OFF,nCount);else SetFooter(C_FT_BTNID_LATER,"",C_FT_BTNDISP_OFF,nCount);if(bkButtonID==C_FT_BTNID_LATER)bkButtonID=""}
function CancelSelectedStatus(){if(gSelectedChipId!=""){if(!gSelectedChipId)return;var strSelectedId=gSelectedChipId;SetTableUnSelectedStatus();SetChipUnSelectedStatus();var strSubChipId=GetRelationSubChipId(strSelectedId);if(strSubChipId!="")strSelectedId=strSubChipId;if(gArrObjSubChip[strSelectedId]){FooterIconReplace(gArrObjSubChip[strSelectedId].subChipAreaId);if(gArrObjSubChip[strSelectedId].subChipAreaId!=C_RECEPTION&&gArrObjSubChip[strSelectedId].subChipAreaId!=C_NOSHOW&&gArrObjSubChip[strSelectedId].subChipAreaId!=
C_STOP){SetChipUnSelectedStatus();SetTableUnSelectedStatus();SetSubChipBoxClose();CreateFooterButton(C_FT_DISPTP_UNSELECTED,0);gCancelFlg=true;setTimeout(function(){gCancelFlg=false},500);return}}gCancelFlg=true;setTimeout(function(){gCancelFlg=false},500)}else{SetSubChipBoxClose();CreateFooterButton(C_FT_DISPTP_UNSELECTED,0)}}
function BindStallAreaClickEvent(){for(var nLoop=1;nLoop<=gMaxRow;nLoop++){var strStallNameID=".stallNo";strStallNameID+=nLoop;$(strStallNameID).bind("click touchstart",function(e){var objSelectedElement=e.target;var objChildNode=objSelectedElement;var objParentNode=objSelectedElement.parentNode;var nTimeOut=0;while(objParentNode.tagName!="LI"){if(nTimeOut>10)return;objChildNode=objParentNode;objParentNode=objChildNode.parentNode;nTimeOut++}var strSelectedStallId=objParentNode.id;strSelectedStallId=
"."+strSelectedStallId+" ."+objChildNode.className;$(strSelectedStallId).addClass("SelectedStole");$(document.body).bind("mousedown touchend",function(e){$(strSelectedStallId).removeClass("SelectedStole")})})}}
function BindAllAreaClickEvent(){$("#this_form").unbind("touchstart");$("#this_form").bind("touchstart",function(e){var nDispWindow=GetDisplayPopupWindow();if(nDispWindow==C_DISP_DETAIL){if($(event.target).is("#ChipDetailPopup, #ChipDetailPopup *, #MstPG_registOverlayBlack, .icrop-CustomLabel-tooltip")===false){CloseChipDetail();gCancelFlg=true;setTimeout(function(){gCancelFlg=false},500);return false}}else if(nDispWindow==C_DISP_STOP){if($(event.target).is(".popStopWindowBase, .popStopWindowBase *, #MstPG_registOverlayBlack, .icrop-CustomLabel-tooltip")===
false){CancelStopWindow();return false}}else if(nDispWindow==C_DISP_REST){if($(event.target).is(".popRestWindow, .popRestWindow *, #MstPG_registOverlayBlack, .icrop-CustomLabel-tooltip")===false){CancelRestWindow();return false}}else if(nDispWindow==C_DISP_TECH){if($(event.target).is(".popTechnicianWindow, .popTechnicianWindow *, #MstPG_registOverlayBlack, .icrop-CustomLabel-tooltip, .#divScrollStall .Technician,.#divScrollStall .Technician * ")===false){CancelTechnicianWindow();return false}}else if(nDispWindow==
C_DISP_NEW){if($(event.target).is("#NewChipPopup, #NewChipPopup *, #MstPG_registOverlayBlack, .icrop-CustomLabel-tooltip")===false){CloseNewChip();gCancelFlg=true;setTimeout(function(){gCancelFlg=false},500);return false}}else if(nDispWindow==C_DISP_DUPL){if($(event.target).is(".PopUpChipBoxBorder, .PopUpChipBoxBorder *, #MstPG_registOverlayBlack, .icrop-CustomLabel-tooltip")===false)RemovePopUpBox()}else if(nDispWindow==C_DISP_UNAVAILABLE){if($(event.target).is("#UnavailableSettingPopup, #UnavailableSettingPopup *, #MstPG_registOverlayBlack, .icrop-CustomLabel-tooltip")===
false){CloseUnavailableSetting();gCancelFlg=true;setTimeout(function(){gCancelFlg=false},500);return false}}else if($(event.target).is(".PopUpChipBoxBorder, .PopUpChipBoxBorder *, .popRestWindow, .popRestWindow *,.popStopWindowBase, .popStopWindowBase *,#ChipDetailPopup, #ChipDetailPopup, #MstPG_registOverlayBlack, .icrop-CustomLabel-tooltip, #SubArea , #SubArea *, .TimingLineSet, .TimingLineSet *, .ChipArea_trimming, .ChipArea_trimming *, #DummyChipDetailPopup, #DummyChipDetailPopup *, .LeftButton_trimming, .LeftButton_trimming *, .RightButton_trimming, .RightButton_trimming *, .FooterButton, .FooterButton *, #BtnDummyRO, .Front, #MovingChip, #MovingChip *, #NewChipPopup, #NewChipPopup *, .Date, .Date *")===
false){if(gSelectedChipId){var tapYPos=getTapYPosition();if(tapYPos>=748-$("#foot").height()-1)e.preventDefault()}CancelSelectedStatus();gCancelFlg=true;setTimeout(function(){gCancelFlg=false},500)}}).bind("gesturestart",function(e){if($(".scroll-inner").position().top<=0){gStopFingerScrollFlg=true;$(".ChipArea_trimming").SmbFingerScroll({action:"stop"})}}).bind("estureend",function(e){if(gStopFingerScrollFlg){$(".ChipArea_trimming").SmbFingerScroll({action:"restart"});gStopFingerScrollFlg=false}})}
function GetDisplayPopupWindow(){var nRtValue=C_DISP_NONE;if($("#ChipDetailPopup").css("display")!="none")nRtValue=C_DISP_DETAIL;if($(".popStopWindowBase").css("display")!="none")nRtValue=C_DISP_STOP;if($(".popRestWindow").css("display")!="none")nRtValue=C_DISP_REST;if($(".popTechnicianWindow").css("display")!="none")nRtValue=C_DISP_TECH;if($("#NewChipPopup").css("display")!="none")nRtValue=C_DISP_NEW;if($(".PopUpChipBoxBorder").length==1)nRtValue=C_DISP_DUPL;if($("#UnavailableSettingPopup").css("display")!=
"none")nRtValue=C_DISP_UNAVAILABLE;return nRtValue}
function BindTechniacianTapEvent(){var nTouchXPos;$("#divScrollStall .Technician").bind("chipTap",function(e){SetChipUnSelectedStatus();SetTableUnSelectedStatus();SetSubChipBoxClose();var nRowNo=parseInt(e.target.parentNode.className.substr(7));var nLaterRowNo=0;if(gShowLaterStallFlg)nLaterRowNo=$("#"+e.target.parentNode.id).data("LATER_ROWNUM");ShowTechnicianDialog(nRowNo,nLaterRowNo);jsonData={Method:"GetTechnicians"};DoCallBack(C_CALLBACK_WND101,jsonData,SC3240101AfterCallBack,jsonData.Method)})}
function BindCellTapEvent(){var nTouchXPos;$("#ulChipAreaBack_lineBox .TbRow").bind("chipTap",function(e){if(GetDisplayPopupWindow())return;if($("#SubChip_LoadingScreen").css("display")==="block")return;if(gSelectedChipId!=""){var strClassName=e.target.className;if(left(strClassName,3)=="MCp")return;if(!gCanTbRowTapFlg){gCanTbRowTapFlg=true;return}var nRowNo;if(strClassName.indexOf(" Row")>0)nRowNo=parseInt(strClassName.substring(strClassName.indexOf(" Row")+4,strClassName.length));else nRowNo=GetRowNoByChipId(e.target.id);
if($(".stallNo"+nRowNo).hasClass("WhiteBack"))return;if(gArrObjSubChip[gSelectedChipId])if(gArrObjSubChip[gSelectedChipId].subChipAreaId!=C_RECEPTION&&gArrObjSubChip[gSelectedChipId].subChipAreaId!=C_NOSHOW&&gArrObjSubChip[gSelectedChipId].subChipAreaId!=C_STOP){if(IsChipInTapPos(nRowNo,nTouchXPos)==1)return;SetChipUnSelectedStatus();SetTableUnSelectedStatus();SetSubChipBoxClose();CreateFooterButton(C_FT_DISPTP_UNSELECTED,0);return}if(gMovingChipObj!=null)if(IsDefaultDate(gMovingChipObj.rsltStartDateTime)==
false&&IsDefaultDate(gMovingChipObj.rsltEndDateTime)==true&&(gOpenningSubBoxId!=C_RECEPTION||gOpenningSubBoxId==C_RECEPTION&&CheckgArrObjSubChip(gSelectedChipId)==false))return;else if(IsDefaultDate(gMovingChipObj.rsltEndDateTime)==false&&(gOpenningSubBoxId!=C_RECEPTION||gOpenningSubBoxId==C_RECEPTION&&CheckgArrObjSubChip(gSelectedChipId)==false))return;if(IsChipInTapPos(nRowNo,nTouchXPos)==1||IsChipInTapPos(nRowNo,nTouchXPos)==3)return;else if(IsChipInTapPos(nRowNo,nTouchXPos)==2)if(gSelectedChipId==
C_OTHERDTCHIPID)if(gOtherDtChipObj.stallIdleId)return;var nColNo=GetColNoByTouchXPos(nTouchXPos-$(".scroll-inner").position().left);var bCheckFlg=false;var dtCheckStartTime=new Date;var dtCheckEndTime=new Date;dtCheckStartTime.setTime(gStartWorkTime.getTime());dtCheckEndTime.setTime(gEndWorkTime.getTime());if(dtCheckEndTime.getMinutes()==0)dtCheckEndTime.setTime(dtCheckEndTime.getTime()-60*60*1E3);if(nColNo>=0&&nColNo<=4){dtCheckStartTime.setMinutes((nColNo-1)*15);if(dtCheckStartTime-gStartWorkTime<
0){$("#BlueDiv").css("visibility","hidden");ShowSC3240101Msg(911);gShowBlueDivFlg=false;SetChipUnSelectedStatus();SetTableUnSelectedStatus();return}}if(nColNo>=gMaxCol-3&&nColNo<=gMaxCol){dtCheckEndTime.setMinutes((3-gMaxCol+nColNo)*15);if(dtCheckEndTime-gEndWorkTime>=0){$("#BlueDiv").css("visibility","hidden");ShowSC3240101Msg(912);gShowBlueDivFlg=false;SetChipUnSelectedStatus();SetTableUnSelectedStatus();return}}var nLeft=(nColNo-1)*C_CELL_WIDTH+1;gSelectedCellId="C_"+nRowNo+"_"+nColNo;if(gSelectedChipId==
C_OTHERDTCHIPID)if(gOtherDtChipObj.stallUseId)$("#"+gOtherDtChipObj.stallUseId).css("visibility","hidden");else $("#"+C_UNAVALIABLECHIPID+gOtherDtChipObj.stallIdleId).css("visibility","hidden");else if(gSelectedChipId==C_NEWCHIPID){$("#"+gSelectedChipId).css("left",nLeft);$(".Row"+nRowNo).append($("#"+gSelectedChipId));SetChipPrototypeTimeAndStallIdData(C_NEWCHIPID);var scrollMainObjPos=$(".ChipArea_trimming").find(".scroll-inner").position();gTranslateValStallX=scrollMainObjPos.left;gTranslateValStallY=
scrollMainObjPos.top;return}else if(gSelectedChipId==C_COPYCHIPID){$("#"+C_COPYCHIPID).css("visibility","hidden");var strStallId=$(".stallNo"+nRowNo)[0].id;gCopyChipObj.setStallId(strStallId.replace("stallId_",""))}if(IsUnavailableArea(gSelectedChipId)){if(gCanMoveUnavailableFlg){var nStatus=drawUnavailableAreaAtPos(nLeft,nRowNo);if(nStatus==1){$("#"+C_MOVINGUNAVALIABLECHIPID+" .ShadowBox").css("display","none");$("#"+C_MOVINGUNAVALIABLECHIPID+" .Front").css("display","none");gCanMoveUnavailableFlg=
false;setTimeout(function(){gCanMoveUnavailableFlg=true},500)}else{$("#"+C_MOVINGUNAVALIABLECHIPID+" .ShadowBox").css("display","");$("#"+C_MOVINGUNAVALIABLECHIPID+" .Front").css("display","");if($("#"+C_MOVINGUNAVALIABLECHIPID+" .TimeKnobPointL").length==0||$("#"+C_MOVINGUNAVALIABLECHIPID+" .TimeKnobPointR").length==0){var nChipWidthTime=parseInt($("#"+gSelectedChipId).data("IDLE_TIME"));$("#"+C_MOVINGUNAVALIABLECHIPID).css("width",nChipWidthTime*C_CELL_WIDTH/15);if($("#"+C_MOVINGUNAVALIABLECHIPID+
" .TimeKnobPointL").length==0){var objTimeKnobPointL=$("<div />").addClass("TimeKnobPointL TimeKnobPoint_gray");$("#"+C_MOVINGUNAVALIABLECHIPID).append(objTimeKnobPointL)}if($("#"+C_MOVINGUNAVALIABLECHIPID+" .TimeKnobPointR").length==0){var objTimeKnobPointR=$("<div />").addClass("TimeKnobPointR TimeKnobPoint_gray");$("#"+C_MOVINGUNAVALIABLECHIPID).append(objTimeKnobPointR)}SetTimeKnobPointRPosbyChipWidth(C_MOVINGUNAVALIABLECHIPID);BindChipResize(C_MOVINGUNAVALIABLECHIPID,0,0)}}}}else if(gSelectedChipId==
C_OTHERDTCHIPID&&gOtherDtChipObj.stallIdleId)drawUnavailableAreaAtPos(nLeft,nRowNo);else{if(gArrObjSubChip[gSelectedChipId])if(gMovingChipObj.roJobSeq=="0"&&gOpenningSubBoxId==C_RECEPTION&&IsDefaultDate(gMovingChipObj.rsltStartDateTime)==false){gMovingChipObj.inspectionRsltId=0;gMovingChipObj.cwRsltStartDateTime=new Date(C_DATE_DEFAULT_VALUE);gMovingChipObj.cwRsltEndDateTime=new Date(C_DATE_DEFAULT_VALUE);gMovingChipObj.carWashRsltId="0";gMovingChipObj.rsltStartDateTime=new Date(C_DATE_DEFAULT_VALUE);
gMovingChipObj.rsltEndDateTime=new Date(C_DATE_DEFAULT_VALUE);gMovingChipObj.rsltDeliDateTime=new Date(C_DATE_DEFAULT_VALUE);gMovingChipObj.stallUseStatus="00";gMovingChipObj.upperDisp="";gMovingChipObj.lowerDisp="";gMovingChipObj.svcClassName="";gMovingChipObj.svcClassNameEng="";$("#"+C_MOVINGCHIPID).remove();gMovingChipObj.createChip(C_CHIPTYPE_STALL_MOVING);$("#"+C_MOVINGCHIPID).css("width",C_SubChipWidth-1);AdjustChipItemByWidth(C_MOVINGCHIPID);BindChipResize(C_MOVINGCHIPID,0,0);$("#"+C_MOVINGCHIPID+
" .CpInner").css({"opacity":C_OPACITY_TRANSPARENT,"visibility":"hidden"});ChangeChipZIndex(C_MOVINGCHIPID,"MovingChipZIndex");BindMovingSubChipTapEvent()}drawSelectedChipAtPos(nLeft,nRowNo);$("#"+C_MOVINGCHIPID).css("top",1);var nOverDaysStatus=C_OVERDAYS_NONE;var strColorClass=" TimeKnobPoint_orange";if($("#"+C_MOVINGCHIPID+" .CpInner").hasClass("StRez"))strColorClass=" TimeKnobPoint_blue";if($("#"+C_MOVINGCHIPID+" .TimeKnobPointL").length==0&&$("#"+C_MOVINGCHIPID+" .TimeKnobPointR").length==0){nOverDaysStatus=
C_OVERDAYS_BOTH;var objTimeKnobPointL=$("<div />").addClass("TimeKnobPointL"+strColorClass);$("#"+C_MOVINGCHIPID).append(objTimeKnobPointL);var objTimeKnobPointR=$("<div />").addClass("TimeKnobPointR"+strColorClass);$("#"+C_MOVINGCHIPID).append(objTimeKnobPointR)}else{if($("#"+C_MOVINGCHIPID+" .TimeKnobPointL").length==0){nOverDaysStatus=C_OVERDAYS_RIGHT;var objTimeKnobPointL=$("<div />").addClass("TimeKnobPointL"+strColorClass);$("#"+C_MOVINGCHIPID).append(objTimeKnobPointL)}if($("#"+C_MOVINGCHIPID+
" .TimeKnobPointR").length==0){nOverDaysStatus=C_OVERDAYS_LEFT;var objTimeKnobPointR=$("<div />").addClass("TimeKnobPointR"+strColorClass);$("#"+C_MOVINGCHIPID).append(objTimeKnobPointR)}}if(nOverDaysStatus>C_OVERDAYS_NONE){var nWorkTime=gMovingChipObj.scheWorkTime;if(IsDefaultDate(gMovingChipObj.rsltEndDateTime)==false)nWorkTime=gMovingChipObj.rsltWorkTime;var nWidth=nWorkTime*C_CELL_WIDTH/15;if(nWidth<C_CELL_WIDTH/15*gResizeInterval-1)nWidth=C_CELL_WIDTH/15*gResizeInterval;$("#"+C_MOVINGCHIPID).css("width",
nWidth-1);AdjustChipItemByWidth(C_MOVINGCHIPID);SetTimeKnobPointRPosbyChipWidth(C_MOVINGCHIPID);BindChipResize(C_MOVINGCHIPID,0,0)}$("#"+C_MOVINGCHIPID+" .CpInner").css("visibility","visible")}}else{if(gPopupBoxId!="")SetChipUnSelectedStatus();SetSubChipBoxClose();CreateFooterButton(C_FT_DISPTP_UNSELECTED,0)}}).bind(C_TOUCH_START,function(e){nTouchXPos=getTapXPosition();var strClassName=e.target.className;var strId=e.target.id;var nIndex=strClassName.indexOf(" Row");if(nIndex==-1&&strId.indexOf(C_RESTCHIPID)!=
0)return;if(gOnTouchingFlg)return;var nRowNo;if(strId.indexOf(C_RESTCHIPID)==0){var strParentClassName=$("#"+strId).offsetParent()[0].className;nRowNo=parseInt(strParentClassName.substring(9,strParentClassName.length))}else nRowNo=parseInt(strClassName.substring(nIndex+4,strClassName.length));var nColNo=GetColNoByTouchXPos(nTouchXPos-$(".scroll-inner").position().left);var nLeft=(nColNo-1)*C_CELL_WIDTH;if(gShowBlueDivFlg)$("#BlueDiv").css("left",nLeft).css("top",$(".Row"+nRowNo).position().top).css("visibility",
"visible");else gShowBlueDivFlg=true;if(gSelectedChipId!="")return;if($(".ChipArea").data("tapHold"))return;$(".ChipArea").data("tapHold",setTimeout(function(){CreateNewChip(nRowNo,nColNo);$(".ChipArea").data("tapHold",null)},1E3))}).bind(C_TOUCH_MOVE,function(e){$("#BlueDiv").css("visibility","hidden");if($(".ChipArea").data("tapHold"))clearTimeout($(".ChipArea").data("tapHold"));$(".ChipArea").data("tapHold",null)}).bind(C_TOUCH_END,function(e){$("#BlueDiv").css("visibility","hidden");if($(".ChipArea").data("tapHold"))clearTimeout($(".ChipArea").data("tapHold"));
$(".ChipArea").data("tapHold",null)})}
function BindStopWndEvent(){$("#StopTimeTxt").click(function(){if($(this).hasClass(C_SC3240201CLASS_TEXTBLACK)==false){$("#StopTimeTxt").css("display","block");$(".popStopWindowBase #StopTimeTxt").parent().css("display","inline-block");$(".StopTimeLabel").css("display","none")}}).blur(function(){if($(this).hasClass(C_SC3240201CLASS_TEXTBLACK)==false){var nMinutes=smbScript.RoundUpToNumUnits($("#StopTimeTxt").val(),gResizeInterval,0,C_MAXSTOPTIME);$(".popStopWindowBase .StopTimeLabel").html(nMinutes+gSC3240101WordIni[27]);
$("#StopTimeTxt").css("display","none");$(".popStopWindowBase #StopTimeTxt").parent().css("display","inline-block");$(".StopTimeLabel").css("display","block")}});$("#dpDetailStopMemo").click(function(){$("#dpDetailStopMemo").focus()}).blur(function(){var e=document.getElementById("dpDetailStopMemo");if(e.selectedIndex!=0){$("#lblDetailStopMemo").text(e.options[e.selectedIndex].text);var strText=$("#txtStopMemo").val();strText+=e.options[e.selectedIndex].text;$("#txtStopMemo").val(strText);DeleteOverString($("#txtStopMemo"));
AdjusterStopTextArea()}});$("#txtStopMemo").blur(function(){DeleteOverString($("#txtStopMemo"));AdjusterStopTextArea();$("#btnJobStopDummy").focus()}).click(function(){DeleteOverString($("#txtStopMemo"));$("#txtStopMemo").focus()}).bind("paste",function(e){setTimeout(function(){DeleteOverString($("#txtStopMemo"));AdjusterStopTextArea()},0)}).bind("keyup",function(){DeleteOverString($("#txtStopMemo"));AdjusterStopTextArea()}).bind("keydown",function(){DeleteOverString($("#txtStopMemo"))})}
function DeleteOverString(ta){var maxLen=ta.attr("maxlen");if(ta.val().length>maxLen)ta.val(ta.val().substring(0,maxLen))}
function AdjusterStopTextArea(){var textArea=$("#txtStopMemo");textArea.height(100);var tmp_sh=textArea.attr("scrollHeight");while(tmp_sh>textArea.attr("scrollHeight")){tmp_sh=textArea.attr("scrollHeight");textarea[0].scrollHeight++}if(textArea.attr("scrollHeight")>=textArea.attr("offsetHeight")){textArea.height(textArea.attr("scrollHeight"));$("#StopMemoScrollBox .scroll-inner").height(437+textArea.attr("scrollHeight")-100);$("#StopMemoScrollBox .scroll-inner").css({"transform":"translate3d(0px, 0px, 0px)"})}}
function IsChipInTapPos(nRowNo,nTouchXPos){var nRtFlg=0;var bRestFlg=false;var bChipFlg=false;$(".Row"+nRowNo).children("div").each(function(index,e){if(e.id!=C_MOVINGCHIPID&&e.id!=gSelectedChipId)if(e.offsetLeft+e.offsetWidth>=nTouchXPos-C_SCREEN_CHIPAREA_OFFSET_LEFT-$(".scroll-inner").position().left&&e.offsetLeft<=nTouchXPos-C_SCREEN_CHIPAREA_OFFSET_LEFT-$(".scroll-inner").position().left)if(IsUnavailableArea(e.id)||IsRestArea(e.id))bRestFlg=true;else bChipFlg=true});if(bChipFlg)nRtFlg+=1;if(bRestFlg)nRtFlg+=
2;return nRtFlg}
function SetTableSelectedStatus(){var strChipId=gSelectedChipId;$(".MCp .Front").addClass("BlackBack");$(".SCp .Front").addClass("BlackBack");$(".WhiteBorder p").css("border","gray 3px solid");if(IsChipOrSubChip(gSelectedChipId)==C_CHIPTYPE_SUBCHIP){var arrChipIds=FindRelationChipsFromSubChip("",gArrObjSubChip[gSelectedChipId].svcInId);if(arrChipIds.length>0)strChipId=arrChipIds[0][0]}if(strChipId!=C_NEWCHIPID&&IsRelationChip(strChipId)==true)for(var strId in gArrObjChip){if(CheckgArrObjChip(strId)==false)continue;
if(gArrObjChip[strId].svcInId==gArrObjChip[strChipId].svcInId){$("#"+strId+" .Front").removeClass("BlackBack");if(IsDefaultDate(gArrObjChip[strId].rsltStartDateTime)==false&&IsDefaultDate(gArrObjChip[strId].rsltEndDateTime)==true)ChangeChipZIndex(strId,"SelectedRelationWorkingChipZIndex");else if(IsDefaultDate(gArrObjChip[strId].rsltEndDateTime)==false)ChangeChipZIndex(strId,"SelectedRelationWorkOverChipZIndex");else ChangeChipZIndex(strId,"SelectedRelationRezChipZIndex")}}else if(strChipId==C_OTHERDTCHIPID){if(gOtherDtChipObj.KEY)$("#"+
gOtherDtChipObj.KEY+" .Front").removeClass("BlackBack");else $("#"+gOtherDtChipObj.stallUseId+" .Front").removeClass("BlackBack");if(gOtherDtChipObj.svcInId){var strRelationChipId="";for(var strId in gArrObjChip){if(CheckgArrObjChip(strId)==false)continue;if(gOtherDtChipObj.svcInId==gArrObjChip[strId].svcInId){$("#"+strId+" .Front").removeClass("BlackBack");ChangeChipZIndex(strId,"SelectedRelationRezChipZIndex");strRelationChipId=strId}}if(strRelationChipId)ShowRelationLine(strRelationChipId)}}else $("#"+
strChipId+" .Front").removeClass("BlackBack");if(gSelectedChipId==strChipId){$("#"+strChipId).addClass("SelectedChipShadow");$(".MCp").removeClass("SelectedChipZIndex");ChangeChipZIndex(strChipId,"SelectedChipZIndex")}clearInterval(gFuncRefreshTimerInterval);gScrollTimerInterval="";gFuncRefreshTimerInterval=""}
function SetTableUnSelectedStatus(){$(".MCp .Front").removeClass("BlackBack");$(".SCp .Front").removeClass("BlackBack");$(".WhiteBorder p").css("border","#FFF 3px solid");if(gFuncRefreshTimerInterval=="")gFuncRefreshTimerInterval=setInterval("RefreshSMB()",gRefreshTimerInterval*1E3)}
function DrawRelationLine(strLineId,x1,y1,x2,y2){if($("#"+strLineId).length>0)$("#"+strLineId).remove();var nAngle,nWidth,nTop,nLeft,nDeg;x1+=C_CHIPAREA_OFFSET_LEFT;x2+=C_CHIPAREA_OFFSET_LEFT;var lenX=x2-x1;var lenY=y2-y1;var temp;if(x2<x1){temp=x1;x1=x2;x2=temp}if(y2<y1){temp=y1;y1=y2;y2=temp}nDeg=Math.atan((y2-y1)/(x2-x1));if(lenX>=0&&lenY>=0||lenX<0&&lenY<0)nAngle=nDeg*180/Math.PI;else nAngle=0-nDeg*180/Math.PI;nWidth=Math.sqrt((x1-x2)*(x1-x2)+(y1-y2)*(y1-y2));nTop=y1+nWidth/2*Math.sin(nDeg);nLeft=
(x2-x1)/2+x1-nWidth/2;var objLine=$("<div />").addClass("RelationalLine RelationLineZIndex");objLine.attr("id",strLineId);$(".ChipArea").append(objLine);$("#"+strLineId).css("left",nLeft);$("#"+strLineId).css("top",nTop);$("#"+strLineId).css("width",nWidth);$("#"+strLineId).css("height",2);$("#"+strLineId).css("transform","rotate("+nAngle+"deg)")}function GetRowNoByCellId(strCellId){return parseInt(strCellId.substring(strCellId.indexOf("_")+1,strCellId.lastIndexOf("_")))}
function InitRedTimeLinePropty(){var nHeight=$(".ChipArea").height();$(".TimingLineSet").css("height",nHeight);$(".TimingLineSet .TimingLine01").css("height",nHeight);$(".TimingLineSet .TimingLine02").css("height",nHeight);$(".TimingLineSet .TimingLine03").css("height",nHeight);$(".TimingLineDeli").css("height",nHeight);$(".TimingLineDeli .TimingLine01").css("height",nHeight);$(".TimingLineDeli .TimingLine02").css("height",nHeight);$(".TimingLineDeli .TimingLine03").css("height",nHeight);setRedTimeLineLeftPos(false);
BindTimeLineClickEvent()}
function BindTimeLineClickEvent(){$(".TimingLineSet").bind("chipTap ",function(e){var nRowNo=GetRowNoByYPos(event.offsetY);var dtNow=GetServerTimeNow();var arrChipIds=new Array;var bMovingChipFlg=false;$(".Row"+nRowNo).children("div").each(function(index,eChildChip){if(IsChipOrSubChip(eChildChip.id)==C_CHIPTYPE_STALL)if(eChildChip.id==C_MOVINGCHIPID)bMovingChipFlg=true;else{if(!bMovingChipFlg)if(gArrObjChip[eChildChip.id]){if(gArrObjChip[eChildChip.id].displayStartDate-dtNow<=0&&gArrObjChip[eChildChip.id].displayEndDate-
dtNow>=0)arrChipIds.push(eChildChip.id)}else;}else;});if(bMovingChipFlg)TapMovingChip();else if(arrChipIds.length==1)TapStallChip(arrChipIds[0]);else if(arrChipIds.length>1);})}function SlideTimeLineInOneMinute(){var dtNow=GetServerTimeNow();if(dtNow.getMinutes()==0)setRedTimeLineLeftPos(true);else setRedTimeLineLeftPos(false)}
function setRedTimeLineLeftPos(bScrollFlag){if(IsTodayPage()==false)$(".TimingLineSet").css("visibility","hidden");else{var dtNow=GetServerTimeNow();var setPosition=GetTimeLinePosByTime(dtNow);$(".TimingLineSet").css("left",setPosition);$(".TimingLineSet").css("visibility","visible")}var strDelayStallNum=$("#FooterButtonCount800")[0].innerText;SetLaterStallColorRed();if(bScrollFlag)if(gSelectedChipId!="")ScrollWindowToNowTime(false);if(strDelayStallNum!=$("#FooterButtonCount800")[0].innerText)if(gShowLaterStallFlg){ShowAllStall();
ShowLaterStall()}}
function ScrollWindowToNowTime(bScrollFlg){if(gCanScrollFlg==false)return;if(IsTodayPage()==false){if(bScrollFlg)$(".ChipArea_trimming").SmbFingerScroll({action:"move",moveY:$(".scroll-inner").position().top,moveX:$(".scroll-inner").position().left});return}var nMoveY=0;if(bScrollFlg)nMoveY=$(".scroll-inner").position().top;var dtNow=new GetServerTimeNow;var hour=dtNow.getHours();var nhours=hour-gStartWorkTime.getHours()-2;var nStartColIndex=4*nhours;$(".ChipArea_trimming").SmbFingerScroll({action:"move",moveY:nMoveY,
moveX:nStartColIndex*C_CELL_WIDTH+$(".scroll-inner").position().left})}function SetTimeLineHeight(nHeight){$(".TimingLineSet").css("height",nHeight);$(".TimingLine01").css("height",nHeight);$(".TimingLine02").css("height",nHeight);$(".TimingLine03").css("height",nHeight)}
function ShowCalendar(){var dtShowDate=new Date($("#hidShowDate").val());$("#pCalendar").text(DateFormat(dtShowDate,gDateFormatMMdd)+GetDay(dtShowDate.getDay()));$("#dtCalendar")[0].value=dtShowDate.getFullYear()+"-"+add_zero(dtShowDate.getMonth()+1)+"-"+add_zero(dtShowDate.getDate())}
function ChangeDateValue(nSetFlg){var dtShowDate=$("#dtCalendar")[0].valueAsDate;if($("#dtCalendar")[0].valueAsDate==null){var dtToday=GetServerTimeNow();dtToday.setHours(0);dtToday.setMinutes(0);dtToday.setSeconds(0);dtToday.setMilliseconds(0);dtShowDate=new Date;dtShowDate.setDate(dtToday.getDate());$("#pCalendar").text(DateFormat(dtShowDate,gDateFormatMMdd)+GetDay(dtShowDate.getDay()));$("#dtCalendar")[0].valueAsDate=dtToday.getFullYear()+"-"+add_zero(dtToday.getMonth()+1)+"-"+add_zero(dtToday.getDate())}else $("#pCalendar").text(DateFormat(dtShowDate,
gDateFormatMMdd)+GetDay(dtShowDate.getDay()));if(nSetFlg==1){var dtPreDate=new Date($("#hidShowDate").val());dtPreDate.setHours(0);dtPreDate.setMinutes(0);dtPreDate.setSeconds(0);dtPreDate.setMilliseconds(0);dtShowDate.setHours(0);dtShowDate.setMinutes(0);dtShowDate.setSeconds(0);dtShowDate.setMilliseconds(0);var nChangeDt=(dtShowDate-dtPreDate)/24/60/60/1E3;if(nChangeDt!=0)ClickChangeDate(nChangeDt)}}function imgbtnPrevDate_onClick(){ClickChangeDate(-1);return false}
function imgbtnNextDate_onClick(){ClickChangeDate(1);return false}function imgbtnDate_onClick(){return false}
function ClickChangeDate(nDays){if(gShowLaterStallFlg==true)ShowAllStall();HideAllPopup();gMainAreaActiveIndicator.show();if(gMovingChipObj!=null){if(IsDefaultDate(gMovingChipObj.rsltStartDateTime))if(gSelectedChipId!=""&&gSelectedChipId!=C_NEWCHIPID)if(gSelectedChipId==C_OTHERDTCHIPID)if(nDays==0)$("#hidSelectedChipId").val("");else $("#hidSelectedChipId").val(gOtherDtChipObj.toJsonSting());else if(gArrObjChip[gSelectedChipId])$("#hidSelectedChipId").val(gArrObjChip[gSelectedChipId].toJsonSting())}else if(gSelectedChipId==
C_OTHERDTCHIPID)if(nDays==0)$("#hidSelectedChipId").val("");else $("#hidSelectedChipId").val(gOtherDtChipObj.toJsonSting());else if($("#"+C_MOVINGUNAVALIABLECHIPID).length==1)if(nDays==0)$("#hidSelectedChipId").val("");else{var nRow=GetRowNoByChipId(C_MOVINGUNAVALIABLECHIPID);var strStallId=$(".stallNo"+nRow)[0].id;var objUnavailableChip=new UnavailableChip;objUnavailableChip.setStallIdleId(right(gSelectedChipId,gSelectedChipId.length-C_UNAVALIABLECHIPID.length));objUnavailableChip.setStallId(right(strStallId,
strStallId.length-8));var nSelectedChipWidth;if($("#"+gSelectedChipId).data("IDLE_TIME"))nSelectedChipWidth=Math.round(C_CELL_WIDTH/15*parseInt($("#"+gSelectedChipId).data("IDLE_TIME"))-1);else nSelectedChipWidth=$("#"+C_MOVINGUNAVALIABLECHIPID).width();objUnavailableChip.setWidth(nSelectedChipWidth);objUnavailableChip.setRowLockVersion($("#"+gSelectedChipId).data("ROW_LOCK_VERSION"));objUnavailableChip.setIdleMemo(document.getElementById(gSelectedChipId).getElementsByTagName("div").item(2).textContent);
$("#hidSelectedChipId").val(objUnavailableChip.toJsonSting())}if(gOtherDtChipObj==null)if(!(gArrObjSubChip[gSelectedChipId]&&gArrObjSubChip[gSelectedChipId].subChipAreaId==C_RECEPTION))SetTableUnSelectedStatus();var dtShowDate=new Date($("#hidShowDate").val());dtShowDate.setDate(dtShowDate.getDate()+nDays);$("#hidShowDate").val(dtShowDate.getFullYear()+"/"+add_zero(dtShowDate.getMonth()+1)+"/"+add_zero(dtShowDate.getDate()));var backSelectedChipId="";if(gSelectedChipId&&nDays!=0){if(gArrObjSubChip[gSelectedChipId])if(gArrObjSubChip[gSelectedChipId].subChipAreaId!=
C_RECEPTION&&gArrObjSubChip[gSelectedChipId].subChipAreaId!=C_NOSHOW&&gArrObjSubChip[gSelectedChipId].subChipAreaId!=C_STOP)CreateFooterButton(C_FT_DISPTP_UNSELECTED,0);else backSelectedChipId=gSelectedChipId;if(gArrObjChip[gSelectedChipId])if(IsDefaultDate(gArrObjChip[gSelectedChipId].rsltStartDateTime)==false&&IsDefaultDate(gArrObjChip[gSelectedChipId].rsltEndDateTime)==true||IsDefaultDate(gArrObjChip[gSelectedChipId].rsltEndDateTime)==false)CreateFooterButton(C_FT_DISPTP_UNSELECTED,0);if(gSelectedChipId==
C_COPYCHIPID){$("#hidSelectedChipId").val(gCopyChipObj.toJsonSting());CreateFooterButton(C_FT_DISPTP_UNSELECTED,0)}}else CreateFooterButton(C_FT_DISPTP_UNSELECTED,0);var jsonData={Method:"ReShowMainArea",ShowDate:$("#hidShowDate").val()};setTimeout(function(){DoCallBack(C_CALLBACK_WND101,jsonData,SC3240101AfterCallBack,jsonData.Method)},0);RemoveAllStallChips();if(backSelectedChipId!="")gSelectedChipId=backSelectedChipId}
function DiffRefresh(){if(gShowLaterStallFlg==true)ShowAllStall();HideAllPopup();gMainAreaActiveIndicator.show();RefreshMainWndTimer(ReDisplay);gUpdatingDisplayFlg=true;SetTableUnSelectedStatus();SetChipUnSelectedStatus();$("#hidSelectedChipId").val("");CreateFooterButton(C_FT_DISPTP_UNSELECTED,0);jsonData={Method:"ReShowMainAreaFromTheTime",ShowDate:$("#hidShowDate").val()};setTimeout(function(){DoCallBack(C_CALLBACK_WND101,jsonData,SC3240101AfterCallBack,jsonData.Method)},0);$("."+C_UNAVALIABLECHIPID).remove();
$(".RestArea").remove();$(".KARIKARI").remove();$(".WhiteBorder").remove()}function HideAllPopup(){HideChipDetailPopup();if($(".popRestWindow").css("display")=="block")$(".popRestWindow").css("display","none");if($(".popStopWindowBase").css("display")=="block")CancelStopWindow();if($(".popTechnicianWindow").css("display")=="block"){$(".popTechnicianWindow .DataListTable")[0].innerHTML="";$(".popTechnicianWindow").fadeOut(300)}}
function HideChipDetailPopup(){if($("#ChipDetailPopup").css("display")=="block"){$("#DetailSMaintenanceTypeList").remove();$("#DetailSMercList").remove();$("#DetailLMaintenanceTypeList").remove();$("#DetailLMercList").remove();$("#ChipDetailPopup").fadeOut(300);ShrinkDisplay(0);commonClearTimer()}}
function GetDay(temp){var day;switch(temp){case 0:day=gSC3240101WordIni[3];break;case 1:day=gSC3240101WordIni[4];break;case 2:day=gSC3240101WordIni[5];break;case 3:day=gSC3240101WordIni[6];break;case 4:day=gSC3240101WordIni[7];break;case 5:day=gSC3240101WordIni[8];break;case 6:default:day=gSC3240101WordIni[9];break}return day}function getTapXPosition(){var xPos=0;if(event.changedTouches!==undefined&&event.changedTouches)xPos=event.touches[0].pageX;else xPos=event.pageX;return xPos}
function getTapYPosition(){var yPos=0;if(event.changedTouches!==undefined&&event.changedTouches)yPos=event.touches[0].pageY;else yPos=event.pageY;return yPos}
function GetColNoByTime(dtTime){var dtShowDate=new Date($("#hidShowDate").val());var nCompareValue=CompareDate(dtShowDate,dtTime);if(nCompareValue<0)return 0;if(nCompareValue>0)return gMaxCol+1;var nHours=dtTime.getHours();var nMinutes=dtTime.getMinutes();nHours=nHours+nMinutes/60;if(nHours<gStartWorkTime.getHours())return 1;var nEndHour=gEndWorkTime.getHours();if(gEndWorkTime.getMinutes()>0)nEndHour+=1;if(nHours>nEndHour)return gMaxCol;var nXPos=GetXPosByTime(dtTime);return Math.floor(nXPos/C_CELL_WIDTH)+
1}function GetTimeLineColNo(){var dtNow=GetServerTimeNow();var dtShowDate=new Date($("#hidShowDate").val());var nCompareValue=CompareDate(dtShowDate,dtNow);if(nCompareValue>0)return C_DATE_AFTER_TOMMORROW;if(nCompareValue<0)return C_DATE_BEFORE_YESTDAY;return GetColNoByTime(dtNow)}
function GetOffsetDays(dtStartTime,dtEndTime){var dt1=new Date(dtStartTime);var dt2=new Date(dtEndTime);dt1.setHours(0);dt1.setMinutes(0);dt1.setSeconds(0);dt1.setMilliseconds(0);dt2.setHours(0);dt2.setMinutes(0);dt2.setSeconds(0);dt2.setMilliseconds(0);return Math.abs(dt2-dt1)/(1E3*60*60*24)}
function ResetBkColor(){$("#ColorDiv1").removeClass(C_BK_COLOR_GRAY+" "+C_BK_COLOR_WHITE).css("display","none");$("#ColorDiv2").removeClass(C_BK_COLOR_GRAY+" "+C_BK_COLOR_WHITE).css("display","none");$("#ColorDiv3").removeClass(C_BK_COLOR_GRAY+" "+C_BK_COLOR_WHITE).css("display","none")}function RefreshSMB(){if(gSelectedChipId)return;if(gOpenningSubBoxId!="")return;if($(".popTechnicianWindow").css("display")!="none")return;if(gUpdatingDisplayFlg==true)return;gCanScrollFlg=false;DiffRefresh()}
function ShowTechnicianDialog(nRow,nLaterRow){$(".popTechnicianWindow").fadeIn(300);$(".popTechnicianWindow .gradationBox .ArrowMaskUpper").css("display","block");$(".popTechnicianWindow .gradationBox .ArrowMaskBelow").css("display","none");gTechnicianActiveIndicator.show();var nScrollTop=$("#divScrollStall").position().top;var nRelativeRowNo;if(gShowLaterStallFlg)nRelativeRowNo=nLaterRow-Math.floor(Math.abs(nScrollTop)/C_CELL_HEIGHT);else nRelativeRowNo=nRow-Math.floor(Math.abs(nScrollTop)/C_CELL_HEIGHT);
var nArrowMaskTop=(nRelativeRowNo-1)*C_CELL_HEIGHT+20;var nScrollHeight=nScrollTop%C_CELL_HEIGHT;if(nScrollHeight!=0){if(nArrowMaskTop>531){nArrowMaskTop-=C_CELL_HEIGHT;nScrollHeight+=C_CELL_HEIGHT}$(".ChipArea_trimming").SmbFingerScroll({action:"move",moveY:nScrollHeight,moveX:0})}$(".popTechnicianWindow .ArrowMask").css("top",nArrowMaskTop).css("left","-17px");$(".popTechnicianWindow").data("ROWNO",nRow);gCancelFlg=true;setTimeout(function(){gCancelFlg=false},500)}
function CancelTechnicianWindow(){if(gCancelFlg){gCancelFlg=false;return}$(".popTechnicianWindow .DataListTable")[0].innerHTML="";$(".popTechnicianWindow").fadeOut(300)}
function ConfirmTechnicianWindow(){if(gCancelFlg){gCancelFlg=false;return}var nSelectedRowNo=$(".popTechnicianWindow").data("ROWNO");var strStallId=GetStallIdByRowNo(nSelectedRowNo);var objChecked=$(".popTechnicianWindow .Check");if(objChecked.length>4){ShowSC3240101Msg(924);return}var arrCheckedStaffCode=new Array;for(var nLoop=0;nLoop<objChecked.length;nLoop++)arrCheckedStaffCode.push(objChecked[nLoop].firstChild.id);for(var i=gArrTapStallTechnician.length-1;i>=0;i--)for(var j=arrCheckedStaffCode.length-
1;j>=0;j--)if(arrCheckedStaffCode[j]==gArrTapStallTechnician[i]){gArrTapStallTechnician.splice(i,1);arrCheckedStaffCode.splice(j,1)}var strDeletedStaffCode="";var strAddStaffCode="";var strAddRowlockVersion="";var strDeletedRowlockVersion="";for(var nLoop=0;nLoop<arrCheckedStaffCode.length;nLoop++){strAddStaffCode+=arrCheckedStaffCode[nLoop]+",";strAddRowlockVersion+=FindRowLockVersionInArray(arrCheckedStaffCode[nLoop])+","}for(var nLoop=0;nLoop<gArrTapStallTechnician.length;nLoop++){strDeletedStaffCode+=
gArrTapStallTechnician[nLoop]+",";strDeletedRowlockVersion+=FindRowLockVersionInArray(gArrTapStallTechnician[nLoop])+","}if(strAddStaffCode.length>0){strAddStaffCode=strAddStaffCode.substring(0,strAddStaffCode.length-1);strAddRowlockVersion=strAddRowlockVersion.substring(0,strAddRowlockVersion.length-1)}if(strDeletedStaffCode.length>0){strDeletedStaffCode=strDeletedStaffCode.substring(0,strDeletedStaffCode.length-1);strDeletedRowlockVersion=strDeletedRowlockVersion.substring(0,strDeletedRowlockVersion.length-
1)}$(".popTechnicianWindow .DataListTable")[0].innerHTML="";$(".popTechnicianWindow").fadeOut(300);if(strAddStaffCode.length>0||strDeletedStaffCode.length>0){var jsonData={Method:"SetStallTechnicians",StallId:strStallId,AddTechnicianAccount:strAddStaffCode,DeleteTechnicianAccount:strDeletedStaffCode,AddStaffRowLockVersion:strAddRowlockVersion,DeleteStaffRowLockVersion:strDeletedRowlockVersion};DoCallBack(C_CALLBACK_WND101,jsonData,SC3240101AfterCallBack,jsonData.Method)}}
function FindRowLockVersionInArray(strStaffCode){for(var nLoop=0;nLoop<gArrObjStall.length;nLoop++)if(strStaffCode==gArrObjStall[nLoop].STF_CD)return gArrObjStall[nLoop].ROW_LOCK_VERSION;return""}
function SetTechnicianWndData(strTechnicianInfo){if($(".popTechnicianWindow").css("display")=="none")return;gTechnicianActiveIndicator.hide();var listStall=$.parseJSON(strTechnicianInfo);var objStartDiv=$(".popTechnicianWindow .DataListTable");objStartDiv[0].innerHTML="";var nRowNo=$(".popTechnicianWindow").data("ROWNO");var strStallId=GetStallIdByRowNo(nRowNo);var nIndex=1;gArrTapStallTechnician=new Array;for(var nLoop=0;nLoop<gArrObjStall.length;nLoop++)if(strStallId==gArrObjStall[nLoop].STALLID){objStartDiv.append(CreateLi(gArrObjStall[nLoop].STF_CD,
gArrObjStall[nLoop].USERNAME,true,false,"",nIndex++));gArrTapStallTechnician.push(gArrObjStall[nLoop].STF_CD)}for(var nLoop=0;nLoop<gArrObjStall.length;nLoop++)if(gArrObjStall[nLoop].STALLID=="0"||gArrObjStall[nLoop].STALLID=="")objStartDiv.append(CreateLi(gArrObjStall[nLoop].STF_CD,gArrObjStall[nLoop].USERNAME,false,false,"",nIndex++));for(var nLoop=0;nLoop<gArrObjStall.length;nLoop++)if(strStallId!=gArrObjStall[nLoop].STALLID&&gArrObjStall[nLoop].STALLID!="0"&&gArrObjStall[nLoop].STALLID!="")objStartDiv.append(CreateLi(gArrObjStall[nLoop].STF_CD,
gArrObjStall[nLoop].USERNAME,false,true,gArrObjStall[nLoop].STALLNAME_S,nIndex));if(gArrObjStall.length>12){$(".popTechnicianWindow .DataListTable ").SC3240101StopmemoFingerscroll();$(".popTechnicianWindow .DataListTable  .scroll-inner").height(44*gArrObjStall.length)}}
function CreateLi(strStaffId,strStaffName,bCheckMark,bGreyMark,strStallName,nIndex){var strClass="onclick='SelectTechnicianArea("+nIndex+")'";if(bCheckMark)strClass="class='Check' onclick='SelectTechnicianArea("+nIndex+")'";else if(bGreyMark){strClass="class='Grey'";strStallName="<span class='RightPad'>"+strStallName+"</span>"}return"<li "+strClass+"><span id='"+strStaffId+"'>"+strStaffName+"</span>"+strStallName+"</li>"}
function GetStallIdByRowNo(nRowNo){var strStallId=$(".stallNo"+nRowNo)[0].id;return strStallId.substring(8,strStallId.length)}function SelectTechnicianArea(nIndex){if($(".popTechnicianWindow .dataBox .innerDataBox .DataListTable li:eq("+(nIndex-1)+")").hasClass("Check"))$(".popTechnicianWindow .dataBox .innerDataBox .DataListTable li:eq("+(nIndex-1)+")").removeClass("Check");else $(".popTechnicianWindow .dataBox .innerDataBox .DataListTable li:eq("+(nIndex-1)+")").addClass("Check")}
function ShowRestTimeDialog(strRestTimeId,nType){$(".popRestWindow").css("display","block");$(".popRestWindow .gradationBox .ArrowMaskUpper").css("display","block");$(".popRestWindow .gradationBox .ArrowMaskBelow").css("display","none");SelectRestArea(0);SetRestTimeDlgPosition(strRestTimeId);gPopupRestType=nType;gCancelFlg=true;setTimeout(function(){gCancelFlg=false},500)}
function SetRestTimeDlgPosition(strRestTimeId){var nMaxTop=507;var nMaxRight=674;var nMinLeft=0;var nRowNo=GetRowNoByChipId(strRestTimeId);var nXPos=$("#"+strRestTimeId).position().left+$("#"+strRestTimeId).width()/2;var nTop=69+C_CELL_HEIGHT*nRowNo+$(".scroll-inner").position().top;if(nTop>nMaxTop)if(nRowNo<gMaxRow-1){var nScroll=nTop-nMaxTop;$(".ChipArea_trimming").SmbFingerScroll({action:"move",moveY:nScroll,moveX:0});nTop=nMaxTop}else{nTop-=273;$(".popRestWindow .gradationBox .ArrowMaskUpper").css("display",
"none");$(".popRestWindow .gradationBox .ArrowMaskBelow").css("display","block");$(".popRestWindow .gradationBox .ArrowMaskBelow").css("left",151)}var nLeft=nXPos-$(".popRestWindow").width()/2+$(".scroll-inner").position().left+156;if(nLeft<nMinLeft){var nScroll=nMinLeft-nLeft;$(".ChipArea_trimming").SmbFingerScroll({action:"move",moveY:0,moveX:-nScroll});nLeft=nMinLeft}else if(nLeft>nMaxRight){var nScroll=nLeft-nMaxRight;$(".ChipArea_trimming").SmbFingerScroll({action:"move",moveY:0,moveX:nScroll});
nLeft=nMaxRight;nXPos=$("#"+strRestTimeId).offset().left+$("#"+strRestTimeId).width()/2;var nArrowLeft=nXPos-nLeft-19;$(".popRestWindow .gradationBox .ArrowMaskBelow").css("left",nArrowLeft)}$(".popRestWindow").css({"top":nTop,"left":nLeft})}
function ConfirmRestWindow(){$(".popRestWindow").css("display","none");var nRestFlg=C_RESTTIMEGETFLG_NOGETREST;if($(".popRestWindow .dataBox .innerDataBox .DataListTable li:first").hasClass("Check"))nRestFlg=C_RESTTIMEGETFLG_GETREST;switch(gPopupRestType){case C_ACTION_MOVE:MoveChip(nRestFlg);break;case C_ACTION_START:StartChip(nRestFlg);break;case C_ACTION_STOP:$(".popStopWindowBase").data("RESTFLG",nRestFlg);var jsonData={Method:"HasBeforeStartJob",JobDtlId:gArrObjChip[gSelectedChipId].jobDtlId};
gMainAreaActiveIndicator.show();DoCallBack(C_CALLBACK_WND101,jsonData,SC3240101AfterCallBack,jsonData.Method);break;case C_ACTION_FINISH:FinishChip(nRestFlg);break;case C_ACTION_MIDFINISH:MidfinishChip(nRestFlg);break;case C_ACTION_SUBCHIPMOVE:MoveSubChip(nRestFlg);break}}function CancelRestWindow(){if(gCancelFlg){gCancelFlg=false;return}$(".popRestWindow").css("display","none")}
function SelectRestArea(nIndex){$(".popRestWindow .dataBox .innerDataBox .DataListTable li").removeClass("Check");if(nIndex==0)$(".popRestWindow .dataBox .innerDataBox .DataListTable li:first").addClass("Check");else $(".popRestWindow .dataBox .innerDataBox .DataListTable li:eq(1)").addClass("Check")}
function ShowStallStopDialog(bShowTime){$(".popStopWindowBase").fadeIn(300);$(".popStopWindowBase .StopTimeLabel").html("0"+gSC3240101WordIni[27]);$(".popStopWindowBase #txtStopMemo").val("").css("height",100);$("#StopMemoScrollBox .scroll-inner").height($("#StopMemoScrollBox .innerDataBox").height());$("#StopMemoScrollBox .scroll-inner").css({"transform":"translate3d(0px, 0px, 0px)"});document.getElementById("dpDetailStopMemo").selectedIndex=0;$("#lblDetailStopMemo").text($("#dpDetailStopMemo")[0].options[0].text);
SelectStopArea(0);SetStopDlgPosition(gSelectedChipId,false);if(!bShowTime){$(".popStopWindowBase .TableWorkingHours").css({"display":"none"});$("#CustomLabel32").css({"display":"none"});$("#lblDetailStopMemo").css({"top":"198px"})}else{$(".popStopWindowBase .TableWorkingHours").css({"display":"block"});$("#CustomLabel32").css({"display":"block"});$("#lblDetailStopMemo").css({"top":"273px"})}}
function ShowStopDialog(blDetailFlg){$(".popStopWindowBase").fadeIn(300);$(".popStopWindowBase .StopTimeLabel").html("0"+gSC3240101WordIni[27]);$(".popStopWindowBase #txtStopMemo").val("").css("height",100);$("#StopMemoScrollBox .scroll-inner").height($("#StopMemoScrollBox .innerDataBox").height());$("#StopMemoScrollBox .scroll-inner").css({"transform":"translate3d(0px, 0px, 0px)"});document.getElementById("dpDetailStopMemo").selectedIndex=0;$("#lblDetailStopMemo").text($("#dpDetailStopMemo")[0].options[0].text);
SelectStopArea(0);SetStopDlgPosition(gSelectedChipId,blDetailFlg);$(".popStopWindowBase").data("RESTFLG",C_RESTTIMEGETFLG_NOSET)}
function SetStopDlgPosition(strChipId,blDetailFlg){var nMinLeft=156;var nMaxLeft=656;var nChipLeft=$("#"+strChipId).offset().left;var nChipWidth=$("#"+strChipId).width();var nChipRight=nChipLeft+nChipWidth;var nDlgWidth=$(".popStopWindowBase").width();var nLeft=-1;if(blDetailFlg)SetStopDlgPositionByChipDetail();else{if(nChipLeft-nDlgWidth-17>=nMinLeft){nLeft=nChipLeft-nDlgWidth-17;$(".popStopWindowBase .gradationBox .ArrowMaskL").css("display","none");$(".popStopWindowBase .gradationBox .ArrowMaskR").css("display",
"block")}if(nChipRight<=nMaxLeft&&nLeft==-1){nLeft=nChipRight+17;$(".popStopWindowBase .gradationBox .ArrowMaskL").css("display","block");$(".popStopWindowBase .gradationBox .ArrowMaskR").css("display","none")}if(nLeft==-1){$(".popStopWindowBase .gradationBox .ArrowMaskL").css("display","none");$(".popStopWindowBase .gradationBox .ArrowMaskR").css("display","block");nLeft=276}var nTop=-1;var nMinTop=63;var nMaxTop=648;var nRowNo=GetRowNoByChipId(strChipId);var nChipTop=$(".Row"+nRowNo).offset().top-
C_CHIPAREA_OFFSET_TOP;var nChipBottom=nChipTop+$(".Row"+nRowNo).height();var nArrowTop;if(nChipTop<95){nTop=40;if(nChipTop<nMinTop){var nScroll=nMinTop-nChipTop;$(".ChipArea_trimming").SmbFingerScroll({action:"move",moveY:-nScroll,moveX:0});nChipTop=$(".Row"+nRowNo).offset().top-C_CHIPAREA_OFFSET_TOP}}else if(nChipBottom>600){nTop=145;if(nChipBottom>nMaxTop){var nScroll=nChipBottom-nMaxTop;$(".ChipArea_trimming").SmbFingerScroll({action:"move",moveY:nScroll,moveX:0});nChipTop=$(".Row"+nRowNo).offset().top-
C_CHIPAREA_OFFSET_TOP}}else nTop=95;nArrowTop=nChipTop-nTop+6;$(".popStopWindowBase .gradationBox .ArrowMaskL").css("top",nArrowTop);$(".popStopWindowBase .gradationBox .ArrowMaskR").css("top",nArrowTop);$(".popStopWindowBase").css({"top":nTop,"left":nLeft,"z-index":1001})}}function BindLoadingScreenTapEvent(){$("#MstPG_LoadingScreen").unbind().bind("chipTap",function(e){$(".popStopWindowBase").fadeOut(300);gMainAreaActiveIndicator.hide();$("#MstPG_LoadingScreen").unbind()})}
function SetStopDlgPositionByChipDetail(){var nDlgWidth=$(".popStopWindowBase").width();var nChipAreaWidth=$(".ChipArea_OutFrame").width();var nSetDlgLeft=nChipAreaWidth/2-nDlgWidth/2+$(".NameList").width()/2;var nChipAreaHeight=$(".ChipArea_OutFrame").height();var nDlgHeight=$(".popStopWindowBase").height();var nSetDlgTop=nChipAreaHeight/2-nDlgHeight/2;$(".popStopWindowBase").css({"top":nSetDlgTop,"left":nSetDlgLeft,"z-index":1001});$(".popStopWindowBase .gradationBox .ArrowMaskL").css("display",
"none");$(".popStopWindowBase .gradationBox .ArrowMaskR").css("display","none");$("#MstPG_LoadingScreen").css({"width":$(window).width()+"px","height":$(window).height()+"px"});$("#MstPG_LoadingScreen").css({"display":"table"});$("#MstPG_LoadingScreen .loadingIcn").css({"display":"none"});if(gStopChipFig=="0"){$(".popStopWindowBase .TableWorkingHours").css({"display":"none"});$("#CustomLabel32").css({"display":"none"});$("#lblDetailStopMemo").css({"top":"198px"})}else{$(".popStopWindowBase .TableWorkingHours").css({"display":"block"});
$("#CustomLabel32").css({"display":"block"});$("#lblDetailStopMemo").css({"top":"273px"})}BindLoadingScreenTapEvent()}function CancelStopWindow(){$(".popStopWindowBase").fadeOut(300);gMainAreaActiveIndicator.hide();$("#MstPG_LoadingScreen").unbind()}
function ConfirmStopWindow(){var strStopReasonType;if($(".popStopWindowBase .dataBox .innerDataBox .DataListTable li:first").hasClass("Check"))strStopReasonType=C_STOPREASONTYPE_STOCKOUT;else if($(".popStopWindowBase .dataBox .innerDataBox .DataListTable li:eq(1)").hasClass("Check"))strStopReasonType=C_STOPREASONTYPE_WAITCONFIRMED;else strStopReasonType=C_STOPREASONTYPE_OTHER;var nStopTime=parseInt($(".popStopWindowBase .StopTimeLabel").html());var strStopMemo=$("#txtStopMemo").val();$(".popStopWindowBase").css("display",
"none");var nRestFlg=$(".popStopWindowBase").data("RESTFLG");var nDispWindow=GetDisplayPopupWindow();if(nDispWindow==C_DISP_DETAIL)StopByChipDetail(strStopReasonType,nStopTime,strStopMemo,null);else if($("#CustomLabel32").css("display")=="none")if(nRestFlg==C_RESTTIMEGETFLG_NOSET)StopJobExceptBeforeJob(strStopReasonType,strStopMemo,null);else StopJobExceptBeforeJob(strStopReasonType,strStopMemo,nRestFlg);else if(nRestFlg==C_RESTTIMEGETFLG_NOSET)StopJob(strStopReasonType,nStopTime,strStopMemo,null);
else StopJob(strStopReasonType,nStopTime,strStopMemo,nRestFlg)}function SelectStopArea(nIndex){$(".popStopWindowBase .dataBox .innerDataBox .DataListTable li").removeClass("Check");if(nIndex==0)$(".popStopWindowBase .dataBox .innerDataBox .DataListTable li:first").addClass("Check");else if(nIndex==1)$(".popStopWindowBase .dataBox .innerDataBox .DataListTable li:eq(1)").addClass("Check");else $(".popStopWindowBase .dataBox .innerDataBox .DataListTable li:eq(2)").addClass("Check")}
function ChangeStopMinutes(nChangeMinutes){var nMinutes=parseInt($(".popStopWindowBase .StopTimeLabel").html());if(nMinutes+nChangeMinutes<0||nMinutes+nChangeMinutes>C_MAXSTOPTIME)return;nMinutes+=nChangeMinutes;$(".popStopWindowBase .StopTimeLabel").text(nMinutes+gSC3240101WordIni[27])}
function ClickStopTime(){var nMinutes=parseInt($(".popStopWindowBase .StopTimeLabel").html());$(".popStopWindowBase .StopTimeLabel").css("display","none");$(".popStopWindowBase #StopTimeTxt").parent().css("display","inline-block");$(".popStopWindowBase #StopTimeTxt").css({"display":"block","font-size":14,"font-weight":"bold","line-height":"22px"}).val(nMinutes).focus()}
function GetRestTimeInServiceTime(strChipId){var nMovingChipLeft=$("#"+strChipId).position().left;var nMovingChipRight=nMovingChipLeft+$("#"+strChipId).width();var nRowNo=GetRowNoByChipId(strChipId);var arrDuplChipId=GetRestTimeInRange(nRowNo,nMovingChipLeft,nMovingChipRight);return arrDuplChipId}
function GetRestTimeInRange(nRowNo,nLeft,nRight){var arrDuplChipId=new Array;var nLoop=0;$(".Row"+nRowNo).children("div").each(function(index,e){if(IsRestArea(e.id)){var nChipLeft=e.offsetLeft;var nChipRight=e.offsetLeft+e.offsetWidth;if(!(nChipRight<nLeft||nChipLeft>nRight)){arrDuplChipId[nLoop]=new Array(e.id,nChipLeft);nLoop++}}});arrDuplChipId.sort(function(x,y){return x[1]-y[1]});return arrDuplChipId}
function GetDuplChipIdInRange(nRowNo,nLeft,nRight){var arrDuplChipId=new Array;var nLoop=0;$(".Row"+nRowNo).children("div").each(function(index,e){if(gArrObjChip[e.id]){var nChipLeft=e.offsetLeft;var nChipRight=e.offsetLeft+e.offsetWidth;if(!(nChipRight<nLeft||nChipLeft>nRight)){arrDuplChipId[nLoop]=new Array(e.id,nChipLeft);nLoop++}}});arrDuplChipId.sort(function(x,y){return x[1]-y[1]});return arrDuplChipId}
function GetWidthByRestTime(strChipId){var nChipWidth=$("#"+strChipId).width();var nNewChipWidth=nChipWidth;var nCompareRestTimeWidth=0;while(1){$("#"+strChipId).css("width",nNewChipWidth);var arrRestTime=GetRestTimeInServiceTime(strChipId);var nNewRestTimeWidth=GetRestTimeAreaWidth(strChipId,arrRestTime);if(nCompareRestTimeWidth==nNewRestTimeWidth)break;else{nCompareRestTimeWidth=nNewRestTimeWidth;nNewChipWidth=nChipWidth+nNewRestTimeWidth}}$("#"+strChipId).css("width",nChipWidth);return nNewChipWidth-
nChipWidth}
function GetRestTimeAreaWidth(strChipId,arrRestTime){var nPlusWidth=0;var nChipLeft=$("#"+strChipId).position().left;var nChipWidth=$("#"+strChipId).width();var nChipRight=nChipWidth+nChipLeft;for(var nLoop=0;nLoop<arrRestTime.length;nLoop++){var nRestLeft=$("#"+arrRestTime[nLoop][0]).position().left;var nRestWidth=$("#"+arrRestTime[nLoop][0]).width();var nRestRight=nRestWidth+nRestLeft;if(nChipLeft<nRestLeft)nPlusWidth+=nRestWidth+1;if($("#hidRestAutoJudgeFlg").val()!="1")if(nRestLeft<=nChipLeft&&
nChipRight<=nRestRight)nPlusWidth+=nRestRight-nChipLeft}return nPlusWidth}function GetLeftByRestTime(strChipId,arrRestTime){var arrRestTime=GetRestTimeInServiceTime(strChipId);var nChipLeft=GetLeftByOneRestTime(strChipId,arrRestTime);while(1){$("#"+strChipId).css("left",nChipLeft);var arrNewRestTime=GetRestTimeInServiceTime(strChipId);var nNewChipLeft=GetLeftByOneRestTime(strChipId,arrNewRestTime);if(nNewChipLeft==nChipLeft)break;else nChipLeft=nNewChipLeft}return nChipLeft}
function GetLeftByOneRestTime(strChipId,arrRestTime){var nChipLeft=$("#"+strChipId).position().left;if(arrRestTime.length>0){var nRestLeft=$("#"+arrRestTime[0][0]).position().left;var nRestRight=$("#"+arrRestTime[0][0]).width()+nRestLeft;if(nRestLeft<=nChipLeft)return nRestRight+1}return nChipLeft}
function ScrollToShowChip(strChipId){var nRowNo=GetRowNoByChipId(strChipId);var nChipLeft,nChipTop;nChipTop=$(".Row"+nRowNo).position().top;nChipLeft=$("#"+strChipId).position().left+$(".scroll-inner").position().left;$(".ChipArea_trimming").SmbFingerScroll({action:"move",moveY:nChipTop,moveX:nChipLeft})}
function ChangeMainScrollHeight(bEnlargeFlag){if(bEnlargeFlag==gEnlargeScrollHeight)return;var nXPos=$(".scroll-inner").position().left;var nYPos=$(".scroll-inner").position().top;var nOffsetHeight=0;if(bEnlargeFlag){if(gShowLaterStallFlg)return;if(gMaxRow>=8)nOffsetHeight=C_CHIPAREA_OFFSET_HEIGHT;else if(gMaxRow==7)nOffsetHeight=C_CHIPAREA_OFFSET_HEIGHT-C_CELL_HEIGHT;else if(gMaxRow==6)nOffsetHeight=C_CHIPAREA_OFFSET_HEIGHT-C_CELL_HEIGHT*2;gEnlargeScrollHeight=true}else gEnlargeScrollHeight=false;
$(".ChipArea_trimming").SmbFingerScroll({minTop:$(".ChipArea_trimming").height()-$(".ChipArea").height()-nOffsetHeight});var nHeight=gMaxRow*C_CELL_HEIGHT+C_CHIPAREA_OFFSET_TOP+nOffsetHeight;$(".ChipArea_trimming .scroll-inner").height(nHeight);$(".ChipArea_trimming").SmbFingerScroll({action:"move",moveX:0,moveY:0});$(".ChipArea_trimming").SmbFingerScroll({action:"move",moveX:-nXPos,moveY:-nYPos})}
function ClickStall(nStallId){if(gOpeCode!=C_OPECODE_CHT)return;var strParam="{";strParam+='"StallId":"'+nStallId+'"';strParam+="}";gMainAreaActiveIndicator.show();__doPostBack("",strParam)}
function JudgeRestFlg(strChipId){var nAutoJudgeRestFlg=C_RESTTIMEGETFLG_GETREST;var arrRestTime=GetRestTimeInServiceTime(strChipId);if(1<=arrRestTime.length){var nAutoJudgeRestFlg=C_RESTTIMEGETFLG_NOGETREST;var nMovingChipLeft=$("#"+strChipId).position().left;for(var nLoop=0;nLoop<arrRestTime.length;nLoop++){var nRestLeft=$("#"+arrRestTime[nLoop][0]).position().left;if(nMovingChipLeft<nRestLeft)nAutoJudgeRestFlg=C_RESTTIMEGETFLG_GETREST}}return nAutoJudgeRestFlg}
function CanRestChange(strChipId){var arrRestTime=GetRestTimeInServiceTime(strChipId);if(1<=arrRestTime.length){var nMovingChipLeft=$("#"+strChipId).position().left;for(var nLoop=0;nLoop<arrRestTime.length;nLoop++){var nRestLeft=$("#"+arrRestTime[nLoop][0]).position().left;if(nMovingChipLeft<nRestLeft)return true}}return false};
