var C_RECEPTION="100";var C_ADDITIONALWORK="200";var C_ADDWORKCONFIRM_REDIRECT="202";var C_COMPLETIONINSPECTION="300";var C_CARWASH="400";var C_COMPLETIONINSPECTION_REDIRECT="402";var C_DELIVERDCAR="500";var C_NOSHOW="600";var C_NOSHOW_MOVING="602";var C_STOP="700";var C_STOP_MOVING="702";var C_UPDATECNT_RECEPTION="101";var C_UPDATECNT_ADDITIONALWORK="201";var C_UPDATECNT_COMPLETIONINSPECTION="301";var C_UPDATECNT_CARWASH="401";var C_UPDATECNT_DELIVERDCAR="501";var C_UPDATECNT_NOSHOW="601";
var C_UPDATECNT_STOP="701";var C_UPDATE_ALLCONUT="1000";var C_OPERATIONTYPE_GETSUBBOXCHIP=0;var C_OPERATIONTYPE_OTHER=1;var C_SubChipWidth=84;var C_RECEPTION_ATTACHMENT="102";var C_UPDATA_STALLCHIP=0;var C_UPDATA_SUBCHIP=1;var C_TEMP_FLG_OFF="0";var INDEX_RELATION_CHIPS_CHIP_ID=0;var INDEX_RELATION_CHIPS_MATCHING_KEY=2;var gSubAreawidth=1024;var gSubMovingChipLeft="-10000px";var gSubMovingChipTop="-10000px";var gArrObjSubChip=new Array;var gstrLateflg=0;var C_EDIT_FLG="0";var C_TEMP_FLG="1";
var gCallbackSC3240301={doCallback:function(argument,callbackFunction){this.packedArgument=JSON.stringify(argument);this.endCallback=callbackFunction;this.beginCallback()}};
function InitializationSubChip(jsonData){var subchipjsonData=$("#hidJsonDatasubchip").val();var subchipinfoList;var subchipinfo;if(!subchipjsonData)subchipinfoList=$.parseJSON(jsonData);else subchipinfoList=$.parseJSON(subchipjsonData);$("#hidJsonDatasubchip").attr("value","");for(var keyString in subchipinfoList){subchipinfo=subchipinfoList[keyString];if(gOpenningSubBoxId==subchipinfo.AREAID)continue;SetSubChipAreaStatus(subchipinfo.AREAID,subchipinfo.COUNT,subchipinfo.LATEFLG);if(subchipinfo.AREAID==
C_RECEPTION){var dtUpdateTime=new Date($("#hiddenupdatetime").val());var dtDBUpdateTime=new Date(subchipinfoList[keyString].CUST_CONFIRMDATE);if(dtUpdateTime<dtDBUpdateTime)BlinkReceprionButtonOn()}}}
function ShowReceptionchip(){if($(".SubChipReception").css("display")==="none"){var strButtonPosition=$("#FooterButtonIcon100").offset().left+12;$(".SubChipReception .Triangle").css("left",""+strButtonPosition+"px");$(".SubChipAdditionalWork").fadeOut(300);$(".SubChipCompletionInspection").fadeOut(300);$(".SubChipCarWash").fadeOut(300);$(".SubChipWaitingDelivered").fadeOut(300);$(".SubChipNoShow").fadeOut(300);$(".SubChipStop").fadeOut(300);$(".SubChipReception").fadeIn(300);if(gOpenningSubBoxId!=
"")gSearchedChipId="";gOpenningSubBoxId=C_RECEPTION;$("#SubChipAreaActiveIndicator").addClass("show");$("#SubChip_LoadingScreen").css({"display":"block"});commonRefreshTimerTabletSMB(ReceptionAreaReLoad);$(".SubChipBox").SC3240301fingerScroll();$(".SCp").remove();var now=GetServerTimeNow();$("#hiddenupdatetime").val(now);BlinkReceprionButtonOff();var prms=CreateCallBackSubChipParam(C_RECEPTION);DoCallBack(C_CALLBACK_WND301,prms,ReceptionAfterCallBack,"ShowReceptionchip")}else{$(".SubChipReception").fadeOut(300);
gOpenningSubBoxId="";gSearchedChipId="";$(".SCp").remove();$("#SubChipAreaActiveIndicator").removeClass("show");$("#SubChip_LoadingScreen").css({"display":"none"});commonClearTimer();ChangeMainScrollHeight(false)}}
function ShowAddWorkchip(){if($(".SubChipAdditionalWork").css("display")==="none"){var strButtonPosition=$("#FooterButtonIcon200").offset().left+12;$(".SubChipAdditionalWork .Triangle").css("left",""+strButtonPosition+"px");$(".SubChipReception").fadeOut(300);$(".SubChipCompletionInspection").fadeOut(300);$(".SubChipCarWash").fadeOut(300);$(".SubChipWaitingDelivered").fadeOut(300);$(".SubChipNoShow").fadeOut(300);$(".SubChipStop").fadeOut(300);$(".SubChipAdditionalWork").fadeIn(300);if(gOpenningSubBoxId!=
"")gSearchedChipId="";gOpenningSubBoxId=C_ADDITIONALWORK;$("#SubChipAreaActiveIndicator").addClass("show");$("#SubChip_LoadingScreen").css({"display":"block"});commonRefreshTimerTabletSMB(AddWorkAreaReLoad);$(".SubChipBox").SC3240301fingerScroll();$(".SCp").remove();var prms=CreateCallBackSubChipParam(C_ADDITIONALWORK);DoCallBack(C_CALLBACK_WND301,prms,AddWorkAfterCallBack,"ShowAddWorkchip")}else{$(".SubChipAdditionalWork").fadeOut(300);gOpenningSubBoxId="";gSearchedChipId="";$(".SCp").remove();$("#SubChipAreaActiveIndicator").removeClass("show");
$("#SubChip_LoadingScreen").css({"display":"none"});commonClearTimer();ChangeMainScrollHeight(false)}}
function ShowCompletionchip(){if($(".SubChipCompletionInspection").css("display")==="none"){var strButtonPosition=$("#FooterButtonIcon300").offset().left+12;$(".SubChipCompletionInspection .Triangle").css("left",""+strButtonPosition+"px");$(".SubChipReception").fadeOut(300);$(".SubChipAdditionalWork").fadeOut(300);$(".SubChipCarWash").fadeOut(300);$(".SubChipWaitingDelivered").fadeOut(300);$(".SubChipNoShow").fadeOut(300);$(".SubChipStop").fadeOut(300);$(".SubChipCompletionInspection").fadeIn(300);
if(gOpenningSubBoxId!="")gSearchedChipId="";gOpenningSubBoxId=C_COMPLETIONINSPECTION;$("#SubChipAreaActiveIndicator").addClass("show");$("#SubChip_LoadingScreen").css({"display":"block"});commonRefreshTimerTabletSMB(ComInspectionAreaReLoad);$(".SubChipBox").SC3240301fingerScroll();$(".SCp").remove();var prms=CreateCallBackSubChipParam(C_COMPLETIONINSPECTION);DoCallBack(C_CALLBACK_WND301,prms,InspectionComAfterCallBack,"ShowCompletionchip")}else{$(".SubChipCompletionInspection").fadeOut(300);gOpenningSubBoxId=
"";gSearchedChipId="";$(".SCp").remove();$("#SubChipAreaActiveIndicator").removeClass("show");$("#SubChip_LoadingScreen").css({"display":"none"});commonClearTimer();ChangeMainScrollHeight(false)}}
function ShowCarWashchip(){if($(".SubChipCarWash").css("display")==="none"){var strButtonPosition=$("#FooterButtonIcon400").offset().left+12;$(".SubChipCarWash .Triangle").css("left",""+strButtonPosition+"px");$(".SubChipReception").fadeOut(300);$(".SubChipAdditionalWork").fadeOut(300);$(".SubChipCompletionInspection").fadeOut(300);$(".SubChipWaitingDelivered").fadeOut(300);$(".SubChipNoShow").fadeOut(300);$(".SubChipStop").fadeOut(300);$(".SubChipCarWash").fadeIn(300);if(gOpenningSubBoxId!="")gSearchedChipId=
"";gOpenningSubBoxId=C_CARWASH;$("#SubChipAreaActiveIndicator").addClass("show");$("#SubChip_LoadingScreen").css({"display":"block"});commonRefreshTimerTabletSMB(CarWashAreaReLoad);$(".SubChipBox").SC3240301fingerScroll();$(".SCp").remove();var prms=CreateCallBackSubChipParam(C_CARWASH);DoCallBack(C_CALLBACK_WND301,prms,CarWashAfterCallBack,"ShowCarWashchip")}else{$(".SubChipCarWash").fadeOut(300);gOpenningSubBoxId="";gSearchedChipId="";$(".SCp").remove();$("#SubChipAreaActiveIndicator").removeClass("show");
$("#SubChip_LoadingScreen").css({"display":"none"});commonClearTimer();ChangeMainScrollHeight(false)}}
function ShowDeliverdCarchip(){if($(".SubChipWaitingDelivered").css("display")==="none"){var strButtonPosition=$("#FooterButtonIcon500").offset().left+12;$(".SubChipWaitingDelivered .Triangle").css("left",""+strButtonPosition+"px");$(".SubChipReception").fadeOut(300);$(".SubChipAdditionalWork").fadeOut(300);$(".SubChipCompletionInspection").fadeOut(300);$(".SubChipCarWash").fadeOut(300);$(".SubChipNoShow").fadeOut(300);$(".SubChipStop").fadeOut(300);$(".SubChipWaitingDelivered").fadeIn(300);if(gOpenningSubBoxId!=
"")gSearchedChipId="";gOpenningSubBoxId=C_DELIVERDCAR;$("#SubChipAreaActiveIndicator").addClass("show");$("#SubChip_LoadingScreen").css({"display":"block"});commonRefreshTimerTabletSMB(DeliverdCarAreaReLoad);$(".SubChipBox").SC3240301fingerScroll();$(".SCp").remove();var prms=CreateCallBackSubChipParam(C_DELIVERDCAR);DoCallBack(C_CALLBACK_WND301,prms,DeliWaitAfterCallBack,"ShowDeliverdCarchip")}else{$(".SubChipWaitingDelivered").fadeOut(300);gOpenningSubBoxId="";gSearchedChipId="";$(".SCp").remove();
$("#SubChipAreaActiveIndicator").removeClass("show");$("#SubChip_LoadingScreen").css({"display":"none"});commonClearTimer();ChangeMainScrollHeight(false)}}
function ShowNoShowchip(){if($(".SubChipNoShow").css("display")==="none"){var strButtonPosition=$("#FooterButtonIcon600").offset().left+12;$(".SubChipNoShow .Triangle").css("left",""+strButtonPosition+"px");$(".SubChipReception").fadeOut(300);$(".SubChipAdditionalWork").fadeOut(300);$(".SubChipCompletionInspection").fadeOut(300);$(".SubChipCarWash").fadeOut(300);$(".SubChipWaitingDelivered").fadeOut(300);$(".SubChipStop").fadeOut(300);$(".SubChipNoShow").fadeIn(300);if(gOpenningSubBoxId!="")gSearchedChipId=
"";gOpenningSubBoxId=C_NOSHOW;$("#SubChipAreaActiveIndicator").addClass("show");$("#SubChip_LoadingScreen").css({"display":"block"});commonRefreshTimerTabletSMB(NoShowAreaReLoad);$(".SubChipBox").SC3240301fingerScroll();$(".SCp").remove();var prms=CreateCallBackSubChipParam(C_NOSHOW);DoCallBack(C_CALLBACK_WND301,prms,NoShowAfterCallBack,"ShowNoShowchip")}else{$(".SubChipNoShow").fadeOut(300);gOpenningSubBoxId="";gSearchedChipId="";$(".SCp").remove();$("#SubChipAreaActiveIndicator").removeClass("show");
$("#SubChip_LoadingScreen").css({"display":"none"});commonClearTimer();ChangeMainScrollHeight(false)}}
function ShowStopchip(){if($(".SubChipStop").css("display")==="none"){var strButtonPosition=$("#FooterButtonIcon700").offset().left+12;$(".SubChipStop .Triangle").css("left",""+strButtonPosition+"px");$(".SubChipReception").fadeOut(300);$(".SubChipAdditionalWork").fadeOut(300);$(".SubChipCompletionInspection").fadeOut(300);$(".SubChipCarWash").fadeOut(300);$(".SubChipWaitingDelivered").fadeOut(300);$(".SubChipNoShow").fadeOut(300);$(".SubChipStop").fadeIn(300);if(gOpenningSubBoxId!="")gSearchedChipId=
"";gOpenningSubBoxId=C_STOP;$("#SubChipAreaActiveIndicator").addClass("show");$("#SubChip_LoadingScreen").css({"display":"block"});commonRefreshTimerTabletSMB(StopAreaReLoad);$(".SubChipBox").SC3240301fingerScroll();$(".SCp").remove();var prms=CreateCallBackSubChipParam(C_STOP);DoCallBack(C_CALLBACK_WND301,prms,StopAfterCallBack,"ShowStopchip")}else{$(".SubChipStop").fadeOut(300);gOpenningSubBoxId="";gSearchedChipId="";$(".SCp").remove();$("#SubChipAreaActiveIndicator").removeClass("show");$("#SubChip_LoadingScreen").css({"display":"none"});
commonClearTimer();ChangeMainScrollHeight(false)}}function UndoWashingChip(){$("#SubChipAreaActiveIndicator").addClass("show");$("#SubChip_LoadingScreen").css({"display":"block"});commonRefreshTimerTabletSMB(CarWashAreaReLoad);var prms=CreateCallBackActionButtonParam(C_FT_BTNID_UNDO);DoCallBack(C_CALLBACK_WND301,prms,AfterCallBackFooterActionButton,"UndoWashingChip")}
function ClickBtnStartWashCar(){$("#SubChipAreaActiveIndicator").addClass("show");$("#SubChip_LoadingScreen").css({"display":"block"});commonRefreshTimerTabletSMB(ReDisplay);var prms=CreateCallBackActionButtonParam(C_FT_BTNID_WASHSTART);DoCallBack(C_CALLBACK_WND301,prms,AfterCallBackFooterActionButton,"ClickBtnStartWashCar")}
function ClickBtnEndWashCar(){$("#SubChipAreaActiveIndicator").addClass("show");$("#SubChip_LoadingScreen").css({"display":"block"});commonRefreshTimerTabletSMB(ReDisplay);var prms=CreateCallBackActionButtonParam(C_FT_BTNID_WASHEND);DoCallBack(C_CALLBACK_WND301,prms,AfterCallBackFooterActionButton,"ClickBtnEndWashCar")}
function ClickBtnDeli(){$("#SubChipAreaActiveIndicator").addClass("show");$("#SubChip_LoadingScreen").css({"display":"block"});commonRefreshTimerTabletSMB(ReDisplay);var prms=CreateCallBackActionButtonParam(C_FT_BTNID_DELI);DoCallBack(C_CALLBACK_WND301,prms,AfterCallBackFooterActionButton,"ClickBtnDeli")}
function ClickMoveToWash(){$("#SubChipAreaActiveIndicator").addClass("show");$("#SubChip_LoadingScreen").css({"display":"block"});commonRefreshTimerTabletSMB(ReDisplay);var prms=CreateCallBackActionButtonParam(C_FT_BTNTP_MOVETOWASH);DoCallBack(C_CALLBACK_WND301,prms,AfterCallBackFooterActionButton,"ClickMoveToWash")}
function ClickMoveToDeliWait(){$("#SubChipAreaActiveIndicator").addClass("show");$("#SubChip_LoadingScreen").css({"display":"block"});commonRefreshTimerTabletSMB(ReDisplay);var prms=CreateCallBackActionButtonParam(C_FT_BTNTP_MOVETODELI);DoCallBack(C_CALLBACK_WND301,prms,AfterCallBackFooterActionButton,"ClickMoveToDeliWait")}
function ClickFinishStopChip(){var dtShowDate=$("#hidShowDate").val();$("#SubChipAreaActiveIndicator").addClass("show");$("#SubChip_LoadingScreen").css({"display":"block"});commonRefreshTimerTabletSMB(ReDisplay);var prms={ButtonID:C_FT_BTNID_FINISHSTOPCHIP,ServiceInId:gArrObjSubChip[gSelectedChipId].svcInId,JobDtlId:gArrObjSubChip[gSelectedChipId].jobDtlId,StalluseId:gArrObjSubChip[gSelectedChipId].stallUseId,RowLockVersion:gArrObjSubChip[gSelectedChipId].rowLockVersion,ShowDate:dtShowDate};DoCallBack(C_CALLBACK_WND301,
prms,AfterCallBackFooterActionButton,"ClickFinishStopChip")}function ReceptionButtonRefresh(){var prms=CreateCallBackSubChipParam(C_UPDATECNT_RECEPTION);DoCallBack(C_CALLBACK_WND301,prms,SC3240301AfterCallBackRefresh,"ReceptionButtonRefresh")}function AddWorkButtonRefresh(){var prms=CreateCallBackSubChipParam(C_UPDATECNT_ADDITIONALWORK);DoCallBack(C_CALLBACK_WND301,prms,SC3240301AfterCallBackRefresh,"AddWorkButtonRefresh")}
function CompletionInspecButtonRefresh(){var prms=CreateCallBackSubChipParam(C_UPDATECNT_COMPLETIONINSPECTION);DoCallBack(C_CALLBACK_WND301,prms,SC3240301AfterCallBackRefresh,"CompletionInspecButtonRefresh")}function CarWashButtonRefresh(){var prms=CreateCallBackSubChipParam(C_UPDATECNT_CARWASH);DoCallBack(C_CALLBACK_WND301,prms,SC3240301AfterCallBackRefresh,"CarWashButtonRefresh")}
function DeliverdCarButtonRefresh(){var prms=CreateCallBackSubChipParam(C_UPDATECNT_DELIVERDCAR);DoCallBack(C_CALLBACK_WND301,prms,SC3240301AfterCallBackRefresh,"DeliverdCarButtonRefresh")}function NoShowButtonRefresh(){var prms=CreateCallBackSubChipParam(C_UPDATECNT_NOSHOW);DoCallBack(C_CALLBACK_WND301,prms,SC3240301AfterCallBackRefresh,"NoShowButtonRefresh")}
function StopButtonRefresh(){var prms=CreateCallBackSubChipParam(C_UPDATECNT_STOP);DoCallBack(C_CALLBACK_WND301,prms,SC3240301AfterCallBackRefresh,"StopButtonRefresh")}function AllButtonRefresh(){var prms=CreateCallBackSubChipParam(C_UPDATE_ALLCONUT);DoCallBack(C_CALLBACK_WND301,prms,SC3240301AfterCallBackRefresh,"AllButtonRefresh")}
function ReceptionAfterCallBack(result){var jsonResult=$.parseJSON(result);if(jsonResult.Message){alert(htmlDecode(jsonResult.Message));ClearOperationList();return}if(gOpenningSubBoxId==C_RECEPTION){CreateSubChips(C_RECEPTION,result);ChangeMainScrollHeight(true)}AfterCallBack()}
function AddWorkAfterCallBack(result){var jsonResult=$.parseJSON(result);if(jsonResult.Message){alert(htmlDecode(jsonResult.Message));ClearOperationList();return}if(gOpenningSubBoxId==C_ADDITIONALWORK){CreateSubChips(C_ADDITIONALWORK,result);ChangeMainScrollHeight(true)}AfterCallBack()}
function InspectionComAfterCallBack(result){var jsonResult=$.parseJSON(result);if(jsonResult.Message){alert(htmlDecode(jsonResult.Message));ClearOperationList();return}if(gOpenningSubBoxId==C_COMPLETIONINSPECTION){CreateSubChips(C_COMPLETIONINSPECTION,result);ChangeMainScrollHeight(true)}AfterCallBack()}
function CarWashAfterCallBack(result){var jsonResult=$.parseJSON(result);if(jsonResult.Message){alert(htmlDecode(jsonResult.Message));ClearOperationList();return}if(gOpenningSubBoxId==C_CARWASH){CreateSubChips(C_CARWASH,result);ChangeMainScrollHeight(true)}AfterCallBack()}
function DeliWaitAfterCallBack(result){var jsonResult=$.parseJSON(result);if(jsonResult.Message){alert(htmlDecode(jsonResult.Message));ClearOperationList();return}if(gOpenningSubBoxId==C_DELIVERDCAR){CreateSubChips(C_DELIVERDCAR,result);ChangeMainScrollHeight(true)}AfterCallBack()}
function NoShowAfterCallBack(result){var jsonResult=$.parseJSON(result);if(jsonResult.Message){alert(htmlDecode(jsonResult.Message));ClearOperationList();return}if(gOpenningSubBoxId==C_NOSHOW){CreateSubChips(C_NOSHOW,result);ChangeMainScrollHeight(true)}AfterCallBack()}
function StopAfterCallBack(result){var jsonResult=$.parseJSON(result);if(jsonResult.Message){alert(htmlDecode(jsonResult.Message));ClearOperationList();return}if(gOpenningSubBoxId==C_STOP){CreateSubChips(C_STOP,result);ChangeMainScrollHeight(true)}AfterCallBack()}
function AfterCallBackFooterActionButton(result){commonClearTimer();var jsonResult=JSON.parse(result);if(jsonResult.ResultCode==0||jsonResult.ResultCode==-9E3){if(jsonResult.ResultCode==-9E3)icropScript.ShowMessageBox(jsonResult.ResultCode,htmlDecode(jsonResult.Message),"");SetTableUnSelectedStatus();SetChipUnSelectedStatus();if(jsonResult.SubButtonID!=C_NOSHOW)ShowLatestChips(htmlDecode(jsonResult.StallChip),false,false);if(gOpenningSubBoxId==jsonResult.SubButtonID)if(jsonResult.SubButtonID==C_CARWASH){CreateSubChips(C_CARWASH,
htmlDecode(jsonResult.CarwrashArea));if(jsonResult.ButtonID==C_FT_BTNID_WASHEND||jsonResult.ButtonID==C_FT_BTNTP_MOVETODELI)InitializationSubChip(htmlDecode(jsonResult.DropofButtonInfo))}else if(jsonResult.SubButtonID==C_DELIVERDCAR){CreateSubChips(C_DELIVERDCAR,htmlDecode(jsonResult.DropoffArea));if(jsonResult.ButtonID==C_FT_BTNTP_MOVETOWASH)InitializationSubChip(htmlDecode(jsonResult.CarWashButtonInfo))}else if(jsonResult.SubButtonID==C_NOSHOW)CreateSubChips(C_NOSHOW,htmlDecode(jsonResult.NoShowArea));
else{if(jsonResult.SubButtonID==C_STOP){CreateSubChips(C_STOP,htmlDecode(jsonResult.JobStopArea));InitializationSubChip(htmlDecode(jsonResult.DropofButtonInfo));InitializationSubChip(htmlDecode(jsonResult.CarWashButtonInfo));InitializationSubChip(htmlDecode(jsonResult.ComplInsButtonInfo));ShowLatestChips(htmlDecode(jsonResult.StallChip),false,false)}}else if(jsonResult.SubButtonID==C_CARWASH){InitializationSubChip(htmlDecode(jsonResult.CarWashButtonInfo));if(jsonResult.ButtonID==C_FT_BTNID_WASHEND||
jsonResult.ButtonID==C_FT_BTNTP_MOVETODELI)InitializationSubChip(htmlDecode(jsonResult.DropofButtonInfo))}else if(jsonResult.SubButtonID==C_DELIVERDCAR){InitializationSubChip(htmlDecode(jsonResult.DropofButtonInfo));if(jsonResult.ButtonID==C_FT_BTNTP_MOVETOWASH)InitializationSubChip(htmlDecode(jsonResult.CarWashButtonInfo))}else if(jsonResult.SubButtonID==C_NOSHOW)InitializationSubChip(htmlDecode(jsonResult.NoShowButtonInfo));else if(jsonResult.SubButtonID==C_STOP){InitializationSubChip(htmlDecode(jsonResult.JobStopArea));
InitializationSubChip(htmlDecode(jsonResult.DropofButtonInfo));InitializationSubChip(htmlDecode(jsonResult.CarWashButtonInfo));InitializationSubChip(htmlDecode(jsonResult.ComplInsButtonInfo));ShowLatestChips(htmlDecode(jsonResult.StallChip),false,false)}AfterCallBack()}else if(jsonResult.ResultCode==3||jsonResult.ResultCode==23||jsonResult.ResultCode==27){alert(htmlDecode(jsonResult.Message));ClearOperationList();SetTableUnSelectedStatus();SetChipUnSelectedStatus();if(gOpenningSubBoxId==jsonResult.SubButtonID)FooterIconReplace(gOpenningSubBoxId);
gArrBackChipObj.length=0;$("#SubChipAreaActiveIndicator").removeClass("show");$("#SubChip_LoadingScreen").css({"display":"none"});$(".SubChipBox").SC3240301fingerScroll({action:"move",moveY:$(".SubChipBox .scroll-inner").position().top,moveX:$(".SubChipBox .scroll-inner").position().left})}else{alert(htmlDecode(jsonResult.Message));ClearOperationList();SetTableUnSelectedStatus();SetChipUnSelectedStatus();gArrBackChipObj.length=0;SetSubChipBoxClose();ClickChangeDate(0)}}
function SC3240301AfterCallBackRefresh(result){var jsonResult=$.parseJSON(result);if(jsonResult.Message){alert(htmlDecode(jsonResult.Message));ClearOperationList();return}InitializationSubChip(result);AfterCallBack()}
function CreateSubChips(buttonID,jsonData){if(gOpenningSubBoxId!=buttonID)return;gArrObjSubChip=null;gArrObjSubChip=new Array;$(".SCp").remove();var strSubChipNo=0;var strTargetArea;var strKey;var strPartsErrorId=0;var strSearchedSubChipId;switch(buttonID){case "100":strTargetArea="SubChipReception";break;case "200":strTargetArea="SubChipAdditionalWork";break;case "300":strTargetArea="SubChipCompletionInspection";break;case "400":strTargetArea="SubChipCarWash";break;case "500":strTargetArea="SubChipWaitingDelivered";
break;case "600":strTargetArea="SubChipNoShow";break;case "700":strTargetArea="SubChipStop";break}var chipDataList=$.parseJSON(jsonData);for(var keyString in chipDataList){var chipData=chipDataList[keyString];switch(buttonID){case "100":if(chipData.TEMP_FLG==C_TEMP_FLG)strKey=chipData.JOB_DTL_ID+"_"+C_RECEPTION;else strKey=chipData.RO_NUM+"_"+chipData.RO_JOB_SEQ+"_"+C_RECEPTION;break;case "200":strKey=chipData.RO_NUM+"_"+chipData.RO_JOB_SEQ+"_"+C_ADDITIONALWORK;break;case "300":strKey=chipData.JOB_DTL_ID+
"_"+C_COMPLETIONINSPECTION;break;case "400":strKey=chipData.SVCIN_ID+"_"+C_CARWASH;break;case "500":strKey=chipData.SVCIN_ID+"_"+C_DELIVERDCAR;break;case "600":strKey=chipData.JOB_DTL_ID+"_"+C_NOSHOW;break;case "700":strKey=chipData.JOB_DTL_ID+"_"+C_STOP;break}if(gArrObjSubChip[strKey])continue;if(gArrObjSubChip[strKey]==undefined)gArrObjSubChip[strKey]=new ReserveSubChip(strKey);gArrObjSubChip[strKey].setSubChipParameter(chipData,buttonID);if(gArrObjSubChip[strKey].roJobSeq>0&&(gArrObjSubChip[strKey].subChipAreaId==
C_RECEPTION||gArrObjSubChip[strKey].subChipAreaId==C_ADDITIONALWORK)){gArrObjSubChip[strKey].rsltStartDateTime=new Date(C_DATE_DEFAULT_VALUE);gArrObjSubChip[strKey].rsltEndDateTime=new Date(C_DATE_DEFAULT_VALUE);gArrObjSubChip[strKey].stallUseId="0"}if(gSearchedChipId)if(gSearchedSubChipAreaId==C_RECEPTION&&gArrObjSubChip[strKey].tempFlg==C_TEMP_FLG_OFF||gSearchedSubChipAreaId==C_ADDITIONALWORK){if(gArrObjSubChip[strKey].roNum==gSearchedChipRoNum&&gArrObjSubChip[strKey].roJobSeq==gSearchedChipRoSeq){strSearchedSubChipId=
strKey;gSearchedChipId=""}}else if(gArrObjSubChip[strKey].stallUseId==gSearchedChipId){strSearchedSubChipId=strKey;gSearchedChipId=""}switch(gArrObjSubChip[strKey].partsFlg){case "24":strPartsErrorId=913;break;case "25":strPartsErrorId=914;break;case "26":strPartsErrorId=915;break}$("#"+strKey).remove();gArrObjSubChip[strKey].createSubChip(strTargetArea,strKey);SetSubChipPosition(strKey,strSubChipNo);BindSubChipClickEvent(gArrObjSubChip[strKey]);strSubChipNo=strSubChipNo+1}$(".SubChipBox .scroll-inner").width(""+
gSubAreawidth+"");$(".SubChipBox .scroll-inner").height("174px");commonClearTimer();$("#SubChipAreaActiveIndicator").removeClass("show");$("#SubChip_LoadingScreen").css({"display":"none"});gSubAreawidth=1024;if($("."+strTargetArea).css("display")==="block")if(strSubChipNo!=0){var count;if(buttonID=="500")count="";else count=strSubChipNo;if(gstrLateflg>0)SetWarningIcon(buttonID,C_FT_BTNDISP_ON,count);else SetNormalIcon(buttonID,C_FT_BTNDISP_ON,count)}else SetVisibilityIcon(buttonID,C_FT_BTNDISP_ON);
else $(".SCp").remove();gstrLateflg=0;commonClearTimer();if(strSearchedSubChipId)if(gArrObjSubChip[strSearchedSubChipId]){SearchChipScroll(strSearchedSubChipId);SubChipTap(gArrObjSubChip[strSearchedSubChipId])}if(strPartsErrorId)ShowSC3240301Msg(strPartsErrorId)}
function SetSubChipPosition(strChipId,strSubChipNo){var nTop,nLeft;var scrollwidth;nTop=64;nLeft=strSubChipNo*140+50;$("#"+strChipId).css({"top":nTop,"left":nLeft,"width":C_SubChipWidth});scrollwidth=nLeft+C_SubChipWidth+50;if(scrollwidth>gSubAreawidth)gSubAreawidth=scrollwidth;AdjustSubChipItemByWidth(strChipId)}function CreateCallBackSubChipParam(buttonID){var rtnVal={ButtonID:buttonID,DisplayDate:$("#hidShowDate").val()};return rtnVal}
function CreateCallBackActionButtonParam(buttonID){var rtnVa;var dtShowDate=$("#hidShowDate").val();if(buttonID==C_FT_BTNID_DEL)rtnVal={ButtonID:buttonID,ServiceInId:gArrObjSubChip[gSelectedChipId].svcInId,JobDtlId:gArrObjSubChip[gSelectedChipId].jobDtlId,StalluseId:gArrObjSubChip[gSelectedChipId].stallUseId,RowLockVersion:gArrObjSubChip[gSelectedChipId].rowLockVersion,ShowDate:dtShowDate};else rtnVal={ButtonID:buttonID,ServiceInId:gArrObjSubChip[gSelectedChipId].svcInId,JobDtlId:gArrObjSubChip[gSelectedChipId].jobDtlId,
StalluseId:gArrObjSubChip[gSelectedChipId].stallUseId,RoNum:gArrObjSubChip[gSelectedChipId].roNum,PickDeliType:gArrObjSubChip[gSelectedChipId].pickDeliType,RowLockVersion:gArrObjSubChip[gSelectedChipId].rowLockVersion,ShowDate:dtShowDate};return rtnVal}
function BindSubChipClickEvent(objChip){$("#"+objChip.KEY).bind("chipTap",function(e){if(GetDisplayPopupWindow())return;if($("#"+objChip.KEY+" .Front").hasClass("BlackBack"))return;if($("#"+objChip.KEY)[0].parentElement.className!="SubChipArea")return;$("#"+objChip.KEY+" .Front").removeClass("TapBlueBack");setTimeout(function(){SubChipTap(objChip)},0)}).bind(C_TOUCH_START,function(e){if($("#"+objChip.KEY+" .Front").hasClass("BlackBack"))return;$("#"+objChip.KEY+" .Front").addClass("TapBlueBack")}).bind(C_TOUCH_MOVE+
" "+C_TOUCH_END,function(e){$("#"+objChip.KEY+" .Front").removeClass("TapBlueBack")})}
function SubChipTap(objChip){var areaId=GetSubChipType(objChip.KEY);SetTranslateValSubBox(areaId);if(gSelectedChipId!=""){var strChipPattern=GetChipUpdatetype(gSelectedChipId);if(gSelectedChipId==objChip.KEY){SetTableUnSelectedStatus();SetChipUnSelectedStatus();if(gOpenningSubBoxId!="")FooterIconReplace(gOpenningSubBoxId);return}else if(!$("#"+objChip.KEY+" .Front").hasClass("BlackBack")&&$("#"+objChip.KEY).length>0)if(strChipPattern==C_UPDATA_SUBCHIP){SetTableUnSelectedStatus();SetChipUnSelectedStatus();
if(gOpenningSubBoxId!="")FooterIconReplace(gOpenningSubBoxId)}return}gSelectedChipId=objChip.KEY;var strRezSEQ=GetSubChipSVCINID(gSelectedChipId);if(gShowLaterStallFlg==true)ShowAllStall();if(objChip.subChipAreaId==C_RECEPTION||objChip.subChipAreaId==C_NOSHOW||objChip.subChipAreaId==C_STOP)drawSelectedSubChip(objChip.KEY);else{var arrRelationChipId=FindRelationChipsFromSubChip("",objChip.svcInId);SetSubChipAreaSelectedStatus(arrRelationChipId)}CreateFooterButton(C_FT_DISPTP_SELECTED,GetSubChipFootButtonType(objChip.KEY),
gArrObjSubChip[objChip.KEY].tlmContractFlg);if(objChip.scheDeliDateTime&&IsDefaultDate(objChip.scheDeliDateTime)==false){var dtScheDeliLater=GetDeliDelayExpectedTimeLine(objChip.carWashNeedFlg,objChip.scheDeliDateTime,objChip.svcStatus,objChip.remainingInspectionType);var setPosition=GetTimeLinePosByTime(dtScheDeliLater);$(".TimingLineDeli").css("left",setPosition);$(".TimingLineDeli").css("visibility","visible")}}
function SetSubChipAreaSelectedStatus(arrRelationChipId){SetTableSelectedStatus();$("#"+gSelectedChipId+" .Front").removeClass("BlackBack");if(arrRelationChipId.length>0)ShowRelationLine(arrRelationChipId[0][0]);if(gArrObjSubChip[gSelectedChipId].tempFlg=="1"&&gArrObjSubChip[gSelectedChipId].subChipAreaId=="100")$(".MCp .Front").addClass("BlackBack");clearInterval(gFuncRefreshTimerInterval);gFuncRefreshTimerInterval="";gScrollTimerInterval=""}
function GetSubChipType(strChipId){if(strChipId=="")return"";if($("#"+strChipId).length==0)return"";switch($("#"+strChipId).offsetParent().offsetParent().offsetParent()[0].className){case "SubChipReception":return C_FT_BTNTP_CONFIRMED_RO;break;case "SubChipAdditionalWork":return C_FT_BTNTP_WAIT_CONFIRMEDADDWORK;break;case "SubChipCompletionInspection":return C_FT_BTNTP_CONFIRMED_INSPECTION;break;case "SubChipCarWash":if(gArrObjSubChip[strChipId].svcStatus=="07")return C_FT_BTNTP_WAITING_WASH;else if(gArrObjSubChip[strChipId].svcStatus==
"08")return C_FT_BTNTP_WASHING;break;case "SubChipWaitingDelivered":return C_FT_BTNTP_WAIT_DELIVERY;break;case "SubChipNoShow":return C_FT_BTNTP_NOSHOW;break;case "SubChipStop":return C_FT_BTNTP_STOP;break;default:return"";break}}
function GetSubChipFootButtonType(strChipId){switch($("#"+strChipId).offsetParent().offsetParent().offsetParent()[0].className){case "SubChipReception":if(gArrObjSubChip[strChipId].stallId=="0"||gArrObjSubChip[strChipId].stallId=="")return C_FT_BTNTP_CONFIRMED_RO_AVOIDCOPY;else return C_FT_BTNTP_CONFIRMED_RO;break;case "SubChipAdditionalWork":if(gArrObjSubChip[strChipId].stallId=="0"||gArrObjSubChip[strChipId].stallId=="")return C_FT_BTNTP_WAIT_CONFIRMEDADDWORK_AVOIDCOPY;else return C_FT_BTNTP_WAIT_CONFIRMEDADDWORK;
break;case "SubChipCompletionInspection":return C_FT_BTNTP_CONFIRMED_INSPECTION;break;case "SubChipCarWash":if(gArrObjSubChip[strChipId].svcStatus=="07")return C_FT_BTNTP_WAITING_WASH;else if(gArrObjSubChip[strChipId].svcStatus=="08")return C_FT_BTNTP_WASHING;break;case "SubChipWaitingDelivered":if(gArrObjSubChip[strChipId].carWashNeedFlg=="1")return C_FT_BTNTP_WAIT_DELIVERY_WASH;else return C_FT_BTNTP_WAIT_DELIVERY;break;case "SubChipNoShow":return C_FT_BTNTP_NOSHOW;break;case "SubChipStop":return C_FT_BTNTP_STOP;
break;default:return"";break}}function SetSubChipAreaStatus(buttonId,Count,lateFlg){if(Count!=0){if(buttonId=="500")Count="";if(lateFlg>0)SetWarningIcon(buttonId,C_FT_BTNDISP_OFF,Count);else SetNormalIcon(buttonId,C_FT_BTNDISP_OFF,Count)}else SetVisibilityIcon(buttonId,C_FT_BTNDISP_OFF)}
function SetSubChipBoxClose(){$(".SubChipAdditionalWork").fadeOut(300);$(".SubChipCompletionInspection").fadeOut(300);$(".SubChipCarWash").fadeOut(300);$(".SubChipWaitingDelivered").fadeOut(300);$(".SubChipReception").fadeOut(300);$(".SubChipNoShow").fadeOut(300);$(".SubChipStop").fadeOut(300);gOpenningSubBoxId="";gSearchedChipId="";$(".SCp").remove();$("#SubChipAreaActiveIndicator").removeClass("show");$("#SubChip_LoadingScreen").css({"display":"none"});commonClearTimer();ChangeMainScrollHeight(false)}
function drawSelectedSubChip(strSubChipId){if(gSelectedChipId=="")return;var arrRelationChipId=FindRelationChipsFromSubChip("",gArrObjSubChip[strSubChipId].svcInId);SetSubChipAreaSelectedStatus(arrRelationChipId);if(gArrObjSubChip[gSelectedChipId].subChipAreaId==C_NOSHOW||gArrObjSubChip[gSelectedChipId].subChipAreaId==C_STOP)drawSelectedNoShowStopChip(gSelectedChipId);if(gMovingChipObj==null){if(arrRelationChipId.length==0){gMovingChipObj=new ReserveChip(C_MOVINGCHIPID);gArrObjSubChip[strSubChipId].copy(gMovingChipObj);
gMovingChipObj.stallUseId=C_MOVINGCHIPID;gMovingChipObj.scheDeliDateTime=gArrObjSubChip[strSubChipId].scheDeliDateTime;if(gArrObjSubChip[strSubChipId].roJobSeq>0){gMovingChipObj.inspectionRsltId=0;gMovingChipObj.cwRsltStartDateTime=new Date(C_DATE_DEFAULT_VALUE);gMovingChipObj.cwRsltEndDateTime=new Date(C_DATE_DEFAULT_VALUE);gMovingChipObj.carWashRsltId="0";gMovingChipObj.rsltStartDateTime=new Date(C_DATE_DEFAULT_VALUE);gMovingChipObj.rsltEndDateTime=new Date(C_DATE_DEFAULT_VALUE);gMovingChipObj.rsltDeliDateTime=
new Date(C_DATE_DEFAULT_VALUE);gMovingChipObj.stallUseStatus="00";gMovingChipObj.upperDisp="";gMovingChipObj.lowerDisp="";gMovingChipObj.svcClassName="";gMovingChipObj.svcClassNameEng=""}gMovingChipObj.createChip(C_CHIPTYPE_STALL_MOVING);$("#"+C_MOVINGCHIPID).css({"left":gSubMovingChipLeft,"top":gSubMovingChipTop});if(gArrObjSubChip[strSubChipId].roJobSeq>0)$("#"+C_MOVINGCHIPID).css("width",C_SubChipWidth-1);else if(gArrObjSubChip[strSubChipId].scheWorkTime!=0)if(gArrObjSubChip[strSubChipId].scheWorkTime<
5)$("#"+C_MOVINGCHIPID).css("width",C_CELL_WIDTH/15*gResizeInterval-1);else $("#"+C_MOVINGCHIPID).css("width",Math.round(gArrObjSubChip[strSubChipId].scheWorkTime*C_CELL_WIDTH/15)-1);else $("#"+C_MOVINGCHIPID).css("width",C_SubChipWidth*3/2-1);$("#"+strSubChipId).css("z-index",5)}else{gMovingChipObj=new ReserveChip(C_MOVINGCHIPID);gArrObjSubChip[strSubChipId].copy(gMovingChipObj);if(gArrObjSubChip[strSubChipId].roJobSeq>0){gMovingChipObj.inspectionRsltId=0;gMovingChipObj.cwRsltStartDateTime=new Date(C_DATE_DEFAULT_VALUE);
gMovingChipObj.cwRsltEndDateTime=new Date(C_DATE_DEFAULT_VALUE);gMovingChipObj.carWashRsltId="0";gMovingChipObj.rsltStartDateTime=new Date(C_DATE_DEFAULT_VALUE);gMovingChipObj.rsltEndDateTime=new Date(C_DATE_DEFAULT_VALUE);gMovingChipObj.rsltDeliDateTime=new Date(C_DATE_DEFAULT_VALUE);gMovingChipObj.stallUseStatus="00";gMovingChipObj.upperDisp="";gMovingChipObj.lowerDisp="";gMovingChipObj.svcClassName="";gMovingChipObj.svcClassNameEng=""}gMovingChipObj.stallUseId=C_MOVINGCHIPID;gMovingChipObj.scheDeliDateTime=
gArrObjSubChip[strSubChipId].scheDeliDateTime;gMovingChipObj.createChip(C_CHIPTYPE_STALL_MOVING);$("#"+C_MOVINGCHIPID).css({"left":gSubMovingChipLeft,"top":gSubMovingChipTop});if(gArrObjSubChip[strSubChipId].roJobSeq!=0)$("#"+C_MOVINGCHIPID).css("width",C_SubChipWidth-1);else $("#"+C_MOVINGCHIPID).css("width",Math.round(gArrObjSubChip[strSubChipId].scheWorkTime*C_CELL_WIDTH/15)-1)}AdjustChipItemByWidth(C_MOVINGCHIPID);BindChipResize(C_MOVINGCHIPID,0,0);$("#"+C_MOVINGCHIPID+" .CpInner").css({"opacity":C_OPACITY_TRANSPARENT,
"visibility":"hidden"});ChangeChipZIndex(C_MOVINGCHIPID,"MovingChipZIndex");BindMovingSubChipTapEvent()}}
function drawSelectedNoShowStopChip(strSubChipId){if(gMovingChipObj==null){gMovingChipObj=new ReserveChip(C_MOVINGCHIPID);gArrObjSubChip[strSubChipId].copy(gMovingChipObj);gMovingChipObj.stallUseId=C_MOVINGCHIPID;if(gArrObjSubChip[strSubChipId].subChipAreaId==C_STOP){gMovingChipObj.stallUseStatus=C_STALLUSE_STATUS_STARTWAIT;gMovingChipObj.rsltStartDateTime=C_DATE_DEFAULT_VALUE;gMovingChipObj.prmsEndDateTime=C_DATE_DEFAULT_VALUE;gMovingChipObj.rsltEndDateTime=C_DATE_DEFAULT_VALUE;gMovingChipObj.rsltWorkTime=
C_NUM_DEFAULT_VALUE;gMovingChipObj.stopReasonType=C_STR_DEFAULT_VALUE;var svcStatus=C_SVCSTATUS_STARTWAIT;for(var keyString in gArrObjSubChip){if(CheckgArrObjSubChip(keyString)==false)continue;if(gArrObjSubChip[keyString].KEY==strSubChipId)continue;if(gArrObjSubChip[keyString].svcInId==gArrObjSubChip[strSubChipId].svcInId&&(gArrObjSubChip[keyString].stallUseStatus==C_STALLUSE_STATUS_FINISH||gArrObjSubChip[keyString].stallUseStatus==C_STALLUSE_STATUS_STOP)){svcStatus=C_SVCSTATUS_NEXTSTARTWAIT;break}}gMovingChipObj.svcStatus=
svcStatus}gMovingChipObj.createChip(C_CHIPTYPE_STALL_MOVING);var dtScheWrokTmie=gArrObjSubChip[strSubChipId].scheWorkTime;$("#"+C_MOVINGCHIPID).css({"left":gSubMovingChipLeft,"top":gSubMovingChipTop});if(gArrObjSubChip[strSubChipId].subChipAreaId==C_STOP){var relocationWorkTime=gArrObjSubChip[strSubChipId].relocationWorkTime;$("#"+C_MOVINGCHIPID).css({"width":GetSubChipWidth(relocationWorkTime*C_CELL_WIDTH/15)-1,"z-index":100})}else $("#"+C_MOVINGCHIPID).css({"width":GetSubChipWidth(dtScheWrokTmie*
C_CELL_WIDTH/15)-1,"z-index":100})}AdjustChipItemByWidth(C_MOVINGCHIPID);BindChipResize(C_MOVINGCHIPID,0,0);$("#"+C_MOVINGCHIPID+" .CpInner").css({"opacity":C_OPACITY_TRANSPARENT,"visibility":"hidden"});ChangeChipZIndex(C_MOVINGCHIPID,"MovingChipZIndex");BindMovingSubChipTapEvent()}
function BindMovingSubChipTapEvent(){$("#"+C_MOVINGCHIPID).bind("chipTap",function(e){if(GetDisplayPopupWindow())return;$("#"+gSelectedChipId+" .Front").removeClass("TapBlueBack");$("#"+C_MOVINGCHIPID+" .Front").removeClass("TapBlueBack").addClass("BlackBack");setTimeout(function(){MovingSubChipTap()},0);gCanTbRowTapFlg=false}).bind(C_TOUCH_START,function(e){gOnTouchingFlg=true;if($("#"+C_MOVINGCHIPID+" .CpInner").css("visibility")=="hidden")$("#"+gSelectedChipId+" .Front").addClass("TapBlueBack");
else $("#"+C_MOVINGCHIPID+" .Front").removeClass("BlackBack").addClass("TapBlueBack")}).bind(C_TOUCH_END,function(e){$("#"+gSelectedChipId+" .Front").removeClass("TapBlueBack");$("#"+C_MOVINGCHIPID+" .Front").removeClass("TapBlueBack").addClass("BlackBack");gOnTouchingFlg=false}).bind(C_TOUCH_MOVE,function(e){$("#"+gSelectedChipId+" .Front").removeClass("TapBlueBack");$("#"+C_MOVINGCHIPID+" .Front").removeClass("TapBlueBack").addClass("BlackBack");gOnTouchingFlg=false})}
function MovingSubChipTap(){var strSubChipId;if(gSelectedChipId!=C_OTHERDTCHIPID)arrBackDuplicateChipsId=GetMovingCpDuplicateSubChips(gSelectedChipId);if(CheckChipPos(C_MOVINGCHIPID)==false){var strSubChipId=gSelectedChipId;ShowSC3240301Msg(903);SetTableUnSelectedStatus();SetChipUnSelectedStatus();if(gOpenningSubBoxId!="")FooterIconReplace(gOpenningSubBoxId);return}var arrDuplChipId=GetMovingCpDuplicateSubChips();if(arrDuplChipId.length>0){strSubChipId=gSelectedChipId;ShowSC3240301Msg(903);SetTableUnSelectedStatus();
SetChipUnSelectedStatus();if(gOpenningSubBoxId!="")FooterIconReplace(gOpenningSubBoxId);return}if($("#hidRestAutoJudgeFlg").val()!="1"){var arrRestTime=GetRestTimeInServiceTime(C_MOVINGCHIPID);if(arrRestTime.length>0){ShowRestTimeDialog(arrRestTime[0][0],C_ACTION_SUBCHIPMOVE);return}}MoveSubChip(null)}
function MoveSubChip(nRestFlg){var nMovingChipLeft=$("#"+C_MOVINGCHIPID).position().left;var nMovingChipWidth=$("#"+C_MOVINGCHIPID).width();var tempChipObject=new ReserveSubChip(gSelectedChipId);gArrObjSubChip[gSelectedChipId].copy(tempChipObject);if(tempChipObject.roNum.Trim()!=""){var afterMovingEndTime=GetTimeByXPos(nMovingChipLeft+nMovingChipWidth);tempChipObject.setDisplayEndDate(afterMovingEndTime);if(IsDelayDelivery(tempChipObject))if(!ConfirmSC3240101Msg(935)){tempChipObject=null;return}}tempChipObject=
null;var strSubChipId;var dtShowDate=new Date($("#hidShowDate").val());var arrRelationChipId=FindRelationChipsFromSubChip("",gArrObjSubChip[gSelectedChipId].svcInId);if(gArrObjSubChip[gSelectedChipId].subChipAreaId!=C_RECEPTION)strSubChipId=gSelectedChipId;else if(0<arrRelationChipId.length&&gArrObjSubChip[gSelectedChipId].roJobSeq==0&&IsDefaultDate(gArrObjSubChip[gSelectedChipId].rsltStartDateTime))strSubChipId=GetChipIdFromRelationChips(arrRelationChipId,gArrObjSubChip[gSelectedChipId].jobDtlId,
gSelectedChipId);else strSubChipId=gSelectedChipId;var strPartFlg=gArrObjSubChip[gSelectedChipId].partsFlg;var nRestTimeWidth=0;if($("#hidRestAutoJudgeFlg").val()!="1"){if(nRestFlg!=null)if(nRestFlg==1){var arrRestTime=GetRestTimeInServiceTime(C_MOVINGCHIPID);var nChipLeft=GetLeftByRestTime(C_MOVINGCHIPID,arrRestTime);if(nChipLeft!=nMovingChipLeft){nMovingChipLeft=nChipLeft;$("#"+C_MOVINGCHIPID).css("left",nMovingChipLeft)}nRestTimeWidth=GetWidthByRestTime(C_MOVINGCHIPID);var dtMovedDate=GetTimeByXPos(nChipLeft-
1);if(dtMovedDate-gEndWorkTime>=0){if(gSC3240301WordIni!=null)if(gSC3240301WordIni[908]!=null){var strMsg=gSC3240301WordIni[908];strMsg=strMsg.replace("{0}",add_zero(gEndWorkTime.getHours()));strMsg=strMsg.replace("{1}",add_zero(gEndWorkTime.getMinutes()));alert(strMsg)}strSubChipId=gSelectedChipId;SetTableUnSelectedStatus();SetChipUnSelectedStatus();if(gOpenningSubBoxId!="")FooterIconReplace(gOpenningSubBoxId);return}}}else{if(IsTodayStartDate(strSubChipId))nRestTimeWidth=GetWidthByRestTime(C_MOVINGCHIPID);
var dtMovedDate=GetTimeByXPos(nMovingChipLeft-1);if(dtMovedDate-gEndWorkTime>=0){if(gSC3240301WordIni!=null)if(gSC3240301WordIni[908]!=null){var strMsg=gSC3240301WordIni[908];strMsg=strMsg.replace("{0}",add_zero(gEndWorkTime.getHours()));strMsg=strMsg.replace("{1}",add_zero(gEndWorkTime.getMinutes()));alert(strMsg)}strSubChipId=gSelectedChipId;SetTableUnSelectedStatus();SetChipUnSelectedStatus();if(gOpenningSubBoxId!="")FooterIconReplace(gOpenningSubBoxId);return}}var nRow=GetRowNoByChipId(C_MOVINGCHIPID);
$(".Row"+nRow).append($("#"+strSubChipId));var workTimeMinutes=(GetTimeByXPos(nMovingChipLeft+nMovingChipWidth)-GetTimeByXPos(nMovingChipLeft-1))/1E3/60;var strStallId=$(".stallNo"+nRow)[0].id;strStallId=strStallId.substring(8,strStallId.length);var startTime=GetTimeByXPos(nMovingChipLeft-1);gMovingSubChipObj=new MovingSubChip;gMovingSubChipObj.setStallId(strStallId);gMovingSubChipObj.setScheWorkTime(workTimeMinutes);gMovingSubChipObj.setStartDateTime(startTime);gMovingSubChipObj.selectedChipId=gSelectedChipId;
if(strPartFlg=="1")gMovingSubChipObj.partsFlg=strPartFlg;if(strSubChipId==gSelectedChipId){gArrObjSubChip[strSubChipId].setScheStartDateTime(startTime);gArrObjSubChip[strSubChipId].setScheEndDateTime(GetTimeByXPos(nMovingChipLeft+nMovingChipWidth+nRestTimeWidth));gArrObjSubChip[strSubChipId].setScheWorkTime(workTimeMinutes);gArrObjSubChip[strSubChipId].setStallId(strStallId);if(strPartFlg=="1")gArrObjSubChip[strSubChipId].setPartsFlg(strPartFlg)}else if(strSubChipId!=gSelectedChipId){gArrObjChip[strSubChipId].setScheStartDateTime(GetTimeByXPos(nMovingChipLeft-
1));gArrObjChip[strSubChipId].setScheEndDateTime(GetTimeByXPos(nMovingChipLeft+nMovingChipWidth+nRestTimeWidth));gArrObjChip[strSubChipId].setScheWorkTime(workTimeMinutes);gArrObjChip[strSubChipId].setStallId(strStallId);if(strPartFlg=="1")gArrObjChip[strSubChipId].setPartsFlg(strPartFlg)}$("#"+strSubChipId).css({"left":nMovingChipLeft,"width":nMovingChipWidth+nRestTimeWidth,"top":1});if((gArrObjSubChip[gSelectedChipId].roJobSeq>0||(IsDefaultDate(gArrObjSubChip[gSelectedChipId].rsltStartDateTime)==
false||IsDefaultDate(gArrObjSubChip[gSelectedChipId].rsltEndDateTime)==false))&&gArrObjSubChip[gSelectedChipId].subChipAreaId==C_RECEPTION){$("#"+strSubChipId+" .infoBox")[0].innerHTML="";gArrObjSubChip[strSubChipId].stallUseId=0}$("#"+strSubChipId).removeClass("SCp");if($("#"+strSubChipId).hasClass("MCp")==false)$("#"+strSubChipId).addClass("MCp");SetTableUnSelectedStatus();SetChipUnSelectedStatus();if(gOpenningSubBoxId!="")FooterIconReplace(gOpenningSubBoxId);AdjustChipItemByWidth(strSubChipId);
GetReadyMovingUpdate(strSubChipId,nRestFlg);if(CheckgArrObjSubChip(strSubChipId)){$("#"+strSubChipId).removeClass("SelectedChipShadow");if(gArrObjSubChip[strSubChipId].subChipAreaId==C_NOSHOW){var strStallChipId=gArrObjSubChip[strSubChipId].stallUseId;$("#"+strSubChipId).attr("id",strStallChipId);gArrObjChip[strStallChipId]=new ReserveChip(strStallChipId);gArrObjSubChip[strSubChipId].copy(gArrObjChip[strStallChipId]);$("#"+strStallChipId).unbind();BindChipClickEvent(strStallChipId);AddRowLockVersionOne(strStallChipId)}else{$("#"+
strSubChipId).removeClass("SelectedChipShadow");$("#"+strSubChipId).unbind();$("#"+strSubChipId).attr("id",C_TEMPCHIPID);AddRowLockVersionOneBySvcInId(gArrObjSubChip[strSubChipId].svcInId)}}else AddRowLockVersionOne(strSubChipId)}
function GetReadyMovingUpdate(strSubChipId,nRestFlg){$("#SubChipAreaActiveIndicator").addClass("show");$("#SubChip_LoadingScreen").css({"display":"block"});commonRefreshTimerTabletSMB(ReDisplay);var subChipAreaId;if(CheckgArrObjSubChip(gMovingSubChipObj.selectedChipId)==true)subChipAreaId=gArrObjSubChip[gMovingSubChipObj.selectedChipId].subChipAreaId;else{var strRelationSubChip=GetRelationSubChipId(strSubChipId);if(CheckgArrObjSubChip(strRelationSubChip)==true)subChipAreaId=gArrObjSubChip[strRelationSubChip].subChipAreaId}if(CheckgArrObjSubChip(strSubChipId)&&
gArrObjSubChip[strSubChipId].subChipAreaId==C_NOSHOW)$("#"+strSubChipId).data(C_DATA_CHIPTAP_FLG,false);var prms=CreateCallBackMovingParam(strSubChipId,nRestFlg);DoCallBack(C_CALLBACK_WND301,prms,MovingAfterCallBackUpData,"GetReadyMovingUpdate")}
function CreateCallBackMovingParam(strSubChipId,nRestFlg){var strButtonID;var strServiceInId;var strJobDtlId;var strStalluseId;var strStallId;var strScheStartDatetime;var strScheEndDatetime;var strScheWorkTime;var strRestFlg;var strRowLockVersion;var dtShowDate=$("#hidShowDate").val();var strMainteCd;var strRoJobSeq;var strRelationSubChip;var strSubChipKey;var strScheDeliDatetime;var strPickDeliType;var strScheSvcinDateTime;var strRoNum;var strInspectionNeedFlg;var strTempFlg;if(nRestFlg==null)strRestFlg=
"1";else strRestFlg=nRestFlg;if(CheckgArrObjSubChip(gMovingSubChipObj.selectedChipId)==true){strSubChipKey=gArrObjSubChip[gMovingSubChipObj.selectedChipId].KEY;if(gArrObjSubChip[gMovingSubChipObj.selectedChipId].subChipAreaId==C_NOSHOW)strButtonID=C_NOSHOW_MOVING;else if(gArrObjSubChip[gMovingSubChipObj.selectedChipId].subChipAreaId==C_STOP)strButtonID=C_STOP_MOVING;else if(gArrObjSubChip[gMovingSubChipObj.selectedChipId].subChipAreaId==C_RECEPTION)strButtonID=C_RECEPTION_ATTACHMENT}else{strRelationSubChip=
GetRelationSubChipId(strSubChipId);strButtonID=C_RECEPTION_ATTACHMENT;strSubChipKey=gArrObjSubChip[strRelationSubChip].KEY}if(strButtonID!=C_RECEPTION_ATTACHMENT){strServiceInId=gArrObjSubChip[strSubChipId].svcInId;strJobDtlId=gArrObjSubChip[strSubChipId].jobDtlId;strStalluseId=gArrObjSubChip[strSubChipId].stallUseId;strStallId=gArrObjSubChip[strSubChipId].stallId;strScheStartDatetime=gArrObjSubChip[strSubChipId].scheStartDateTime;strScheEndDatetime=gArrObjSubChip[strSubChipId].scheEndDateTime;strScheWorkTime=
gArrObjSubChip[strSubChipId].scheWorkTime;strRowLockVersion=gArrObjSubChip[strSubChipId].rowLockVersion;strPickDeliType=gArrObjSubChip[strSubChipId].pickDeliType;strScheSvcinDateTime=gArrObjSubChip[strSubChipId].scheSvcInDateTime;strRoNum=gArrObjSubChip[strSubChipId].roNum}else if(CheckgArrObjSubChip(strSubChipId)==false){strServiceInId=gArrObjChip[strSubChipId].svcInId;strJobDtlId=gArrObjChip[strSubChipId].jobDtlId;strStalluseId=gArrObjChip[strSubChipId].stallUseId;strStallId=gArrObjChip[strSubChipId].stallId;
strScheStartDatetime=gArrObjChip[strSubChipId].scheStartDateTime;strScheEndDatetime=gArrObjChip[strSubChipId].scheEndDateTime;strScheWorkTime=gArrObjChip[strSubChipId].scheWorkTime;strRowLockVersion=gArrObjChip[strSubChipId].rowLockVersion;strPickDeliType=gArrObjChip[strSubChipId].pickDeliType;strScheSvcinDateTime=gArrObjChip[strSubChipId].scheSvcInDateTime;strRoNum=gArrObjChip[strSubChipId].roNum;strInspectionNeedFlg=gArrObjChip[strSubChipId].inspectionNeedFlg;if(CheckgArrObjSubChip(gMovingSubChipObj.selectedChipId)==
true){strMainteCd=gArrObjSubChip[gMovingSubChipObj.selectedChipId].mntnCd;strRoJobSeq=gArrObjSubChip[gMovingSubChipObj.selectedChipId].roJobSeq;strScheDeliDatetime=gArrObjSubChip[gMovingSubChipObj.selectedChipId].scheDeliDateTime;strTempFlg=gArrObjSubChip[gMovingSubChipObj.selectedChipId].tempFlg}else if(CheckgArrObjSubChip(strRelationSubChip)==true){strMainteCd=gArrObjSubChip[strRelationSubChip].mntnCd;strRoJobSeq=gArrObjSubChip[strRelationSubChip].roJobSeq;strScheDeliDatetime=gArrObjSubChip[strRelationSubChip].scheDeliDateTime;
strTempFlg=gArrObjSubChip[strRelationSubChip].tempFlg}else ShowSC3240301Msg(912)}else{strServiceInId=gArrObjSubChip[strSubChipId].svcInId;strJobDtlId=gArrObjSubChip[strSubChipId].jobDtlId;strStalluseId=gArrObjSubChip[strSubChipId].stallUseId;strStallId=gArrObjSubChip[strSubChipId].stallId;strScheStartDatetime=gArrObjSubChip[strSubChipId].scheStartDateTime;strScheEndDatetime=gArrObjSubChip[strSubChipId].scheEndDateTime;strScheWorkTime=gArrObjSubChip[strSubChipId].scheWorkTime;strRowLockVersion=gArrObjSubChip[strSubChipId].rowLockVersion;
strMainteCd=gArrObjSubChip[strSubChipId].mntnCd;strRoJobSeq=gArrObjSubChip[strSubChipId].roJobSeq;strScheDeliDatetime=gArrObjSubChip[strSubChipId].scheDeliDateTime;strPickDeliType=gArrObjSubChip[strSubChipId].pickDeliType;strScheSvcinDateTime=gArrObjSubChip[strSubChipId].scheSvcInDateTime;strRoNum=gArrObjSubChip[strSubChipId].roNum;strInspectionNeedFlg=gArrObjSubChip[strSubChipId].inspectionNeedFlg;strTempFlg=gArrObjSubChip[strSubChipId].tempFlg}var rtnVal={ButtonID:strButtonID,ServiceInId:strServiceInId,
JobDtlId:strJobDtlId,StalluseId:strStalluseId,StallId:strStallId,ScheStartDatetime:strScheStartDatetime,ScheEndDatetime:strScheEndDatetime,ScheWorkTime:strScheWorkTime,RestFlg:strRestFlg,RowLockVersion:strRowLockVersion,SubChipKey:strSubChipKey,ShowDate:dtShowDate,MainteCd:strMainteCd,WorkSeq:strRoJobSeq,ScheDeliDatetime:strScheDeliDatetime,PickDeliType:strPickDeliType,ScheSvcinDateTime:strScheSvcinDateTime,RoNum:strRoNum,InspectionNeedFlg:strInspectionNeedFlg,tempFlg:strTempFlg};return rtnVal}
function MovingAfterCallBackUpData(result){var jsonResult=$.parseJSON(result);if(jsonResult.SubButtonID!=C_RECEPTION)commonClearTimer();var jsonStallChip=$.parseJSON(htmlDecode(jsonResult.StallChip));var strChipId=0;if(jsonResult.SubButtonID==C_STOP){var chipDataList=$.parseJSON(htmlDecode(jsonResult.RelationChipInfo));var strSvcinId="";for(var keyString in chipDataList){var chipData=chipDataList[keyString];strSvcinId=chipData.SVCIN_ID;break}if(strSvcinId!="")for(var strId in gArrObjRelationChip)if(gArrObjRelationChip[strId])if(gArrObjRelationChip[strId].svcinId==
strSvcinId)gArrObjRelationChip[strId]=null}AddRelationChipInfo(htmlDecode(jsonResult.RelationChipInfo));var strSubChipId=jsonResult.SubChipKey;if(jsonResult.ResultCode==0||jsonResult.ResultCode==-9E3){if(jsonResult.ResultCode==-9E3)icropScript.ShowMessageBox(jsonResult.ResultCode,htmlDecode(jsonResult.Message),"");if(gMovingSubChipObj!=null){for(var strKey in jsonStallChip){var chipData=jsonStallChip[strKey];if(chipData.STALL_ID==gMovingSubChipObj.stallId&&new Date(chipData.SCHE_START_DATETIME)-gMovingSubChipObj.startDateTime==
0&&chipData.SCHE_WORKTIME-gMovingSubChipObj.scheWorkTime==0&&CheckgArrObjChip(chipData.STALL_USE_ID)==false&&chipData.CANCEL_FLG=="0"){strChipId=chipData.STALL_USE_ID;break}}if(strChipId){var strBackAddWorkStatus="";if(gArrObjChip[strChipId])strBackAddWorkStatus=gArrObjChip[strChipId].addWorkStatus;gArrObjChip[strChipId]=new ReserveChip(strChipId);if(gArrObjChip[strChipId].addWorkStatus.toString().Trim()=="")gArrObjChip[strChipId].setAddWorkStatus(strBackAddWorkStatus);if(gMovingSubChipObj.partsFlg)if(gMovingSubChipObj.partsFlg==
"1")gArrObjChip[strChipId].setPartsFlg("1");$("#"+C_TEMPCHIPID).css("z-index","");$("#"+C_TEMPCHIPID).attr("id",strChipId)}}ShowLatestChips(htmlDecode(jsonResult.StallChip),false,false);if(strChipId&&jsonResult.SubButtonID==C_STOP)gArrObjChip[strChipId].stopFlg=true;$("#"+strChipId).unbind();BindChipClickEvent(strChipId);var strStallChipId=gArrObjSubChip[jsonResult.SubChipKey].stallUseId;$("#"+strSubChipId).remove();if(gOpenningSubBoxId==jsonResult.SubButtonID){if(jsonResult.SubButtonID==C_NOSHOW)CreateSubChips(C_NOSHOW,
htmlDecode(jsonResult.NoShowArea));else if(jsonResult.SubButtonID==C_STOP)CreateSubChips(C_STOP,htmlDecode(jsonResult.JobStopArea));else if(jsonResult.SubButtonID==C_RECEPTION){CreateSubChips(C_RECEPTION,htmlDecode(jsonResult.ReceptionArea));InitializationSubChip(htmlDecode(jsonResult.NoShowButtonInfo))}$(".SubChipBox").SC3240301fingerScroll({action:"move",moveY:$(".SubChipBox .scroll-inner").position().top,moveX:$(".SubChipBox .scroll-inner").position().left})}else if(jsonResult.SubButtonID==C_NOSHOW)InitializationSubChip(htmlDecode(jsonResult.NoShowButtonInfo));
else if(jsonResult.SubButtonID==C_STOP)InitializationSubChip(htmlDecode(jsonResult.JobStopButtonInfo));else if(jsonResult.SubButtonID==C_RECEPTION)InitializationSubChip(htmlDecode(jsonResult.ReceptionButtonInfo));if(jsonResult.SubButtonID==C_NOSHOW)if($("#"+strStallChipId).length>0){if($("#"+strStallChipId).data(C_DATA_CHIPTAP_FLG)==false)$("#"+strStallChipId).data(C_DATA_CHIPTAP_FLG,true);if($("#WB"+strStallChipId).length>0)$("#WB"+strStallChipId).remove()}gArrBackChipObj.length=0;AfterCallBack()}else{alert(htmlDecode(jsonResult.Message));
ClearOperationList();gArrBackChipObj.length=0;SetSubChipBoxClose();ClickChangeDate(0)}gMovingSubChipObj=null}function ReceptionAreaReLoad(){if(gOpenningSubBoxId!=C_RECEPTION)return;$("#SubChipAreaActiveIndicator").addClass("show");$("#SubChip_LoadingScreen").css({"display":"block"});var prms=CreateCallBackSubChipParam(C_RECEPTION);DoCallBack(C_CALLBACK_WND301,prms,ReceptionAfterCallBack,"ReceptionAreaReLoad")}
function AddWorkAreaReLoad(){if(gOpenningSubBoxId!=C_ADDITIONALWORK)return;$("#SubChipAreaActiveIndicator").addClass("show");$("#SubChip_LoadingScreen").css({"display":"block"});var prms=CreateCallBackSubChipParam(C_ADDITIONALWORK);DoCallBack(C_CALLBACK_WND301,prms,AddWorkAfterCallBack,"AddWorkAreaReLoad")}
function ComInspectionAreaReLoad(){if(gOpenningSubBoxId!=C_COMPLETIONINSPECTION)return;$("#SubChipAreaActiveIndicator").addClass("show");$("#SubChip_LoadingScreen").css({"display":"block"});var prms=CreateCallBackSubChipParam(C_COMPLETIONINSPECTION);DoCallBack(C_CALLBACK_WND301,prms,InspectionComAfterCallBack,"ComInspectionAreaReLoad")}
function CarWashAreaReLoad(){if(gOpenningSubBoxId!=C_CARWASH)return;$("#SubChipAreaActiveIndicator").addClass("show");$("#SubChip_LoadingScreen").css({"display":"block"});var prms=CreateCallBackSubChipParam(C_CARWASH);DoCallBack(C_CALLBACK_WND301,prms,CarWashAfterCallBack,"CarWashAreaReLoad")}
function DeliverdCarAreaReLoad(){if(gOpenningSubBoxId!=C_DELIVERDCAR)return;$("#SubChipAreaActiveIndicator").addClass("show");$("#SubChip_LoadingScreen").css({"display":"block"});var prms=CreateCallBackSubChipParam(C_DELIVERDCAR);DoCallBack(C_CALLBACK_WND301,prms,DeliWaitAfterCallBack,"DeliverdCarAreaReLoad")}
function NoShowAreaReLoad(){if(gOpenningSubBoxId!=C_NOSHOW)return;$("#SubChipAreaActiveIndicator").addClass("show");$("#SubChip_LoadingScreen").css({"display":"block"});var prms=CreateCallBackSubChipParam(C_NOSHOW);DoCallBack(C_CALLBACK_WND301,prms,NoShowAfterCallBack,"NoShowAreaReLoad")}
function StopAreaReLoad(){if(gOpenningSubBoxId!=C_STOP)return;$("#SubChipAreaActiveIndicator").addClass("show");$("#SubChip_LoadingScreen").css({"display":"block"});var prms=CreateCallBackSubChipParam(C_STOP);DoCallBack(C_CALLBACK_WND301,prms,StopAfterCallBack,"StopAreaReLoad")}function GetSubChipSVCINID(strChipId){var strSvcInId="";if(gArrObjSubChip[strChipId])strSvcInId=gArrObjSubChip[strChipId].svcInId;return strSvcInId}
function IsChipOrSubChip(strChipId){var strChipFlg=C_CHIPTYPE_STALL;if(gArrObjSubChip[strChipId]){strChipFlg=C_CHIPTYPE_SUBCHIP;return strChipFlg}return strChipFlg}
function GetRelationChipId(strSubChipId){var strRelationChipId="";var strSvcInId=GetSubChipSVCINID(strSubChipId);if(strSvcInId)for(var keyString in gArrObjChip){if(CheckgArrObjChip(keyString)==false)continue;if(gArrObjChip[keyString].svcInId==strSvcInId&&gArrObjChip[keyString].childNo=="1"){strRelationChipId=gArrObjChip[keyString].stallUseId;return strRelationChipId}}return strRelationChipId}
function GetRelationSubChipId(strChipId){var strRelationSubChipId="";var strSvcInId;if(gArrObjChip[strChipId])strSvcInId=gArrObjChip[strChipId].svcInId;if(strSvcInId)for(var keyString in gArrObjSubChip)if(CheckgArrObjSubChip(keyString)==true)if(gArrObjSubChip[keyString].svcInId==strSvcInId)if(!$("#"+keyString+" .Front").hasClass("BlackBack")&&$("#"+keyString).length>0){strRelationSubChipId=gArrObjSubChip[keyString].KEY;return strRelationSubChipId}return strRelationSubChipId}
function GetChipUpdatetype(strChipId){var strChipUpdatatype=C_UPDATA_STALLCHIP;var strRelationSubChipId;if($(".SubChipBox").css("display")==="none")return strChipUpdatatype;if(gArrObjSubChip[strChipId]){strChipUpdatatype=C_UPDATA_SUBCHIP;return strChipUpdatatype}for(var keyString in gArrObjSubChip){if(CheckgArrObjSubChip(keyString)==false)continue;if(!$("#"+keyString+" .Front").hasClass("BlackBack")&&$("#"+keyString).length>0){strChipUpdatatype=C_UPDATA_SUBCHIP;return strChipUpdatatype}}return strChipUpdatatype}
function CheckgArrObjSubChip(strSubChipId){if(gArrObjSubChip[strSubChipId]==null||typeof gArrObjSubChip[strSubChipId]!="object")return false;else return true}
function SetTranslateValSubBox(areaId){switch(areaId){case C_FT_BTNTP_CONFIRMED_RO:gTranslateValSubBoxX=$(".SubChipReception .SubChipBox").find(".scroll-inner").position().left;break;case C_FT_BTNTP_WAIT_CONFIRMEDADDWORK:gTranslateValSubBoxX=$(".SubChipAdditionalWork .SubChipBox").find(".scroll-inner").position().left;break;case C_FT_BTNTP_CONFIRMED_INSPECTION:gTranslateValSubBoxX=$(".SubChipCompletionInspection .SubChipBox").find(".scroll-inner").position().left;break;case C_FT_BTNTP_WAITING_WASH:case C_FT_BTNTP_WASHING:gTranslateValSubBoxX=
$(".SubChipCarWash .SubChipBox").find(".scroll-inner").position().left;break;case C_FT_BTNTP_WAIT_DELIVERY:gTranslateValSubBoxX=$(".SubChipWaitingDelivered .SubChipBox").find(".scroll-inner").position().left;break;case C_FT_BTNTP_NOSHOW:gTranslateValSubBoxX=$(".SubChipNoShow .SubChipBox").find(".scroll-inner").position().left;break;case C_FT_BTNTP_STOP:gTranslateValSubBoxX=$(".SubChipStop .SubChipBox").find(".scroll-inner").position().left;break}}
function SubChipCancel(){var rtValue=confirm(gSC3240301WordIni[909]);if(rtValue){$("#SubChipAreaActiveIndicator").addClass("show");$("#SubChip_LoadingScreen").css({"display":"block"});commonRefreshTimerTabletSMB(NoShowAreaReLoad);var prms=CreateCallBackActionButtonParam(C_FT_BTNID_DEL);DoCallBack(C_CALLBACK_WND301,prms,AfterCallBackFooterActionButton,"SubChipCancel")}}
function GetSubChipWidth(aWidth){var nWidth=aWidth;if(nWidth<C_CELL_WIDTH/15*gResizeInterval-1)nWidth=C_CELL_WIDTH/15*gResizeInterval-1;return Math.round(nWidth)}
function ClickBtnInspection(){if(!gArrObjSubChip[gSelectedChipId])return;gMainAreaActiveIndicator.show();var strParam="{";strParam+='"OperationCode":"'+C_COMPLETIONINSPECTION_REDIRECT+'"';strParam+=',"OrderNo":"'+gArrObjSubChip[gSelectedChipId].roNum+'"';strParam+=',"VisitId":"'+gArrObjSubChip[gSelectedChipId].visitId+'"';strParam+=',"DmsJobDtlId":"'+gArrObjSubChip[gSelectedChipId].dmsJobDtlId+'"';strParam+=',"Vin":"'+gArrObjSubChip[gSelectedChipId].vclVin+'"';strParam+=',"JobDtlId":"'+gArrObjSubChip[gSelectedChipId].jobDtlId+
'"';strParam+="}";__doPostBack("",strParam);return false}
function ClickBtnAddWorkConfirm(){if(!gArrObjSubChip[gSelectedChipId])return;gMainAreaActiveIndicator.show();var strParam="{";strParam+='"OperationCode":"'+C_ADDWORKCONFIRM_REDIRECT+'"';strParam+=',"OrderNo":"'+gArrObjSubChip[gSelectedChipId].roNum+'"';strParam+=',"RoJobSeq":"'+gArrObjSubChip[gSelectedChipId].roJobSeq+'"';strParam+=',"VisitId":"'+gArrObjSubChip[gSelectedChipId].visitId+'"';strParam+=',"DmsJobDtlId":"'+gArrObjSubChip[gSelectedChipId].dmsJobDtlId+'"';strParam+=',"Vin":"'+gArrObjSubChip[gSelectedChipId].vclVin+
'"';strParam+="}";__doPostBack("",strParam);return false}
function FindRelationChipsFromSubChip(strStallUseId,strSvcinId){var arrRelationChipId=new Array;if(strSvcinId=="")if(gArrObjChip[strStallUseId])strSvcinId=gArrObjChip[strStallUseId].svcInId;else return arrRelationChipId;var nLoop=0;for(var strId in gArrObjChip){if(CheckgArrObjChip(strId)==false)continue;if(gArrObjChip[strId])if(gArrObjChip[strId].svcInId==strSvcinId)if(gArrObjChip[strId].stallUseStatus!=C_STALLUSE_STATUS_STOP&&gArrObjChip[strId].stallUseStatus!=C_STALLUSE_STATUS_MIDFINISH){arrRelationChipId[nLoop]=
new Array(strId,gArrObjChip[strId].startDateTime,gArrObjChip[strId].jobDtlId);nLoop++}}arrRelationChipId.sort(function(x,y){return x[0]-y[0]});return arrRelationChipId}function GetSC3240301WordIni(){var strWordIni=$("#hidSubMsgData").val();if(gSC3240301WordIni==null){gSC3240301WordIni=$.parseJSON(strWordIni);$("#hidSubMsgData").attr("value","")}}function ShowSC3240301Msg(strWordNo){if(gSC3240301WordIni!=null)if(gSC3240301WordIni[strWordNo]!=null)alert(gSC3240301WordIni[strWordNo])}
function AdjustSubChipItemByWidth(strChipId){if($("#"+strChipId+" .CarNoL").length>0){if($("#"+strChipId+" .CarNoL").width()<=$("#"+strChipId+" .CarNoL span").width())$("#"+strChipId+" .CarNoL").addClass("CarNoR").removeClass("CarNoL")}else if($("#"+strChipId+" .CarNoR").width()>$("#"+strChipId+" .CarNoR span").width())$("#"+strChipId+" .CarNoR").addClass("CarNoL").removeClass("CarNoR")}
function SubChipSearch(){if(gSearchedSubChipAreaId){switch(gSearchedSubChipAreaId){case C_RECEPTION:ShowReceptionchip();break;case C_ADDITIONALWORK:ShowAddWorkchip();break;case C_STOP:ShowStopchip();break;case C_NOSHOW:ShowNoShowchip();break;case C_DELIVERDCAR:ShowDeliverdCarchip();break;case C_CARWASH:ShowCarWashchip();break;case C_COMPLETIONINSPECTION:ShowCompletionchip();break}if(gOpenningSubBoxId!="")FooterIconReplace(gOpenningSubBoxId)}}
function SearchChipScroll(strSubChipId){var subChipLeft=$("#"+strSubChipId).position().left;var diffTime=subChipLeft-gSubAreawidth;var moveX;if(diffTime<=0)return;var count=Math.floor(subChipLeft/gSubAreawidth);var surplus=subChipLeft%gSubAreawidth;moveX=(count-1)*gSubAreawidth+surplus+C_SubChipWidth+50;$(".SubChipBox").SC3240301fingerScroll({action:"move",moveY:$(".SubChipBox .scroll-inner").position().top,moveX:moveX})}
function GetMovingCpDuplicateSubChips(){var nMovingChipLeft=$("#"+C_MOVINGCHIPID).position().left;var nMovingChipRight=nMovingChipLeft+$("#"+C_MOVINGCHIPID).width();var nLoop=0;var arrDuplChipId=new Array;$("#"+C_MOVINGCHIPID).offsetParent().children("div").each(function(index,e){if(e.id!=gSelectedChipId&&e.id!=C_MOVINGCHIPID&&!IsUnavailableArea(e.id)&&!IsRestArea(e.id)&&(gArrObjSubChip[gSelectedChipId].RO_JOB_SEQ!=0&&e.id!=gArrObjSubChip[gSelectedChipId].stallUseId)){var nChipLeft=e.offsetLeft;var nChipRight=
e.offsetLeft+e.offsetWidth;if(!(nChipRight<nMovingChipLeft||nChipLeft>nMovingChipRight)&&left(e.id.toString(),2)!="WB"){arrDuplChipId[nLoop]=e.id;nLoop++}}});return arrDuplChipId}function GetOperationType(buttonID){switch(buttonID){case C_RECEPTION:case C_ADDITIONALWORK:case C_COMPLETIONINSPECTION:case C_CARWASH:case C_DELIVERDCAR:case C_NOSHOW:case C_STOP:return C_OPERATIONTYPE_GETSUBBOXCHIP;break;default:return C_OPERATIONTYPE_OTHER}}
function GetChipIdFromRelationChips(arrRelationChipId,matchingKey,selectedChipId){var strChipId=selectedChipId;if(0<arrRelationChipId.length){var relationChipId;for(var count=0;count<arrRelationChipId.length;count++){relationChipId=arrRelationChipId[count];if(relationChipId[INDEX_RELATION_CHIPS_MATCHING_KEY]==matchingKey){strChipId=relationChipId[INDEX_RELATION_CHIPS_CHIP_ID];break}}}return strChipId};
