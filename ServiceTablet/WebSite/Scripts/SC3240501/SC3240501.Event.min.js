function SetNewChipTextEvent(){$("#NewChipPlanVisitDateTimeSelector").change(function(){$("#NewChipPlanVisitTimeLabel").text(smbScript.ConvertDateToStringForDisplay(smbScript.changeStringToDateIcrop($(this).get(0).value)))});$("#NewChipPlanStartDateTimeSelector").change(function(){if($(this).get(0).value!=null&&$(this).get(0).value!=""){var wkDate=new Date(smbScript.RoundUpTimeTo5Units(smbScript.changeStringToDateIcrop($(this).get(0).value)));var newDate=smbScript.GetDateExcludeOutOfTime(wkDate);
$(this).get(0).value=smbScript.getDateTimelocalDate(newDate);$("#NewChipPlanStartTimeLabel").text(smbScript.ConvertDateToStringForDisplay(newDate));calculateScheSvcinDateTime();if($("#NewChipPlanFinishDateTimeSelector").get(0).value!=null&&$("#NewChipPlanFinishDateTimeSelector").get(0).value!=""){var timeSpan=smbScript.CalcTimeSpan_ExcludeOutOfTime(smbScript.changeStringToDateIcrop($(this).get(0).value),smbScript.changeStringToDateIcrop($("#NewChipPlanFinishDateTimeSelector").get(0).value));if(timeSpan!=
null){if(timeSpan>C_SC3240501_MAXWORKTIME){timeSpan=C_SC3240501_MAXWORKTIME;var newEndDateTime=smbScript.CalcEndDate_ExcludeOutOfTime(smbScript.changeStringToDateIcrop($("#NewChipPlanStartDateTimeSelector").get(0).value),C_SC3240501_MAXWORKTIME);$("#NewChipPlanFinishDateTimeSelector").get(0).value=smbScript.getDateTimelocalDate(newEndDateTime);$("#NewChipPlanFinishTimeLabel").text(smbScript.ConvertDateToStringForDisplay(newEndDateTime));calculateScheDeliDateTime()}$("#NewChipWorkTimeHidden").val(timeSpan)}}}else $("#NewChipPlanStartTimeLabel").text("");
$("#NewChipRegisterBtn").attr("disabled",IsMandatoryNewChipTextEmpty())});$("#NewChipPlanFinishDateTimeSelector").change(function(){if($(this).get(0).value!=null&&$(this).get(0).value!=""){var wkDate=new Date(smbScript.RoundUpTimeTo5Units(smbScript.changeStringToDateIcrop($(this).get(0).value)));var newDate=smbScript.GetDateExcludeOutOfTime(wkDate);$(this).get(0).value=smbScript.getDateTimelocalDate(newDate);$("#NewChipPlanFinishTimeLabel").text(smbScript.ConvertDateToStringForDisplay(newDate));if($("#NewChipPlanStartDateTimeSelector").get(0).value!=
null&&$("#NewChipPlanStartDateTimeSelector").get(0).value!=""){var timeSpan=smbScript.CalcTimeSpan_ExcludeOutOfTime(smbScript.changeStringToDateIcrop($("#NewChipPlanStartDateTimeSelector").get(0).value),smbScript.changeStringToDateIcrop($(this).get(0).value));if(timeSpan!=null){if(timeSpan>C_SC3240501_MAXWORKTIME){timeSpan=C_SC3240501_MAXWORKTIME;var newEndDateTime=smbScript.CalcEndDate_ExcludeOutOfTime(smbScript.changeStringToDateIcrop($("#NewChipPlanStartDateTimeSelector").get(0).value),C_SC3240501_MAXWORKTIME);
$("#NewChipPlanFinishDateTimeSelector").get(0).value=smbScript.getDateTimelocalDate(newEndDateTime);$("#NewChipPlanFinishTimeLabel").text(smbScript.ConvertDateToStringForDisplay(newEndDateTime))}$("#NewChipWorkTimeHidden").val(timeSpan)}}calculateScheDeliDateTime()}else $("#NewChipPlanFinishTimeLabel").text("");$("#NewChipRegisterBtn").attr("disabled",IsMandatoryNewChipTextEmpty())});$("#NewChipPlanDeriveredDateTimeSelector").change(function(){$("#NewChipPlanDeriveredTimeLabel").text(smbScript.ConvertDateToStringForDisplay(smbScript.changeStringToDateIcrop($(this).get(0).value)))});
$("#NewChipRegNoText").blur(function(){$("#NewChipRegisterBtn").attr("disabled",IsMandatoryNewChipTextEmpty())});$("#NewChipVinText").blur(function(){$("#NewChipRegisterBtn").attr("disabled",IsMandatoryNewChipTextEmpty())});$("#NewChipVehicleText").blur(function(){$("#NewChipRegisterBtn").attr("disabled",IsMandatoryNewChipTextEmpty())});$("#NewChipCstNameText").blur(function(){$("#NewChipRegisterBtn").attr("disabled",IsMandatoryNewChipTextEmpty())});$("#NewChipTitleList").change(function(){var e=
document.getElementById("NewChipTitleList");$("#NewChipTitleLabel").text(e.options[e.selectedIndex].text);$("#NewChipRegisterBtn").attr("disabled",IsMandatoryNewChipTextEmpty())});$("#NewChipMobileText").blur(function(){$("#NewChipRegisterBtn").attr("disabled",IsMandatoryNewChipTextEmpty())});$("#NewChipHomeText").blur(function(){$("#NewChipRegisterBtn").attr("disabled",IsMandatoryNewChipTextEmpty())});$("#NewChipSAList").change(function(){var e=document.getElementById("NewChipSAList");$("#NewChipSALabel").text(e.options[e.selectedIndex].text)});
$("#NewChipCstAddressText").blur(function(){$("#NewChipRegisterBtn").attr("disabled",IsMandatoryNewChipTextEmpty());ControlLengthTextarea($("#NewChipCstAddressText"));AdjusterNewChipTextAreaAddress();$("#NewChipContent").animate({scrollTop:0,scrollLeft:0},"normal")}).bind("paste",function(e){setTimeout(function(){ControlLengthTextarea($("#NewChipCstAddressText"));AdjusterNewChipTextAreaAddress()},0)}).bind("keyup",function(){ControlLengthTextarea($("#NewChipCstAddressText"));AdjusterNewChipTextAreaAddress()}).bind("keydown",
function(){ControlLengthTextarea($("#NewChipCstAddressText"))});$("#NewChipMaintenanceTypeList").change(function(){var e=document.getElementById("NewChipMaintenanceTypeList");$("#NewChipMaintenanceTypeLabel").text(e.options[e.selectedIndex].text)});$("#NewChipMaintenanceTypeList").bind("focusin",NewChipSvcClassIDFocusIn);$("#NewChipMaintenanceTypeList").bind("change",NewChipSvcClassIDFocusOut);$("#NewChipMercList").change(function(){var e=document.getElementById("NewChipMercList");$("#NewChipMercLabel").text(e.options[e.selectedIndex].text)});
$("#NewChipMercList").bind("focusin",NewChipMercIDFocusIn);$("#NewChipMercList").bind("change",NewChipMercIDFocusOut);$("#NewChipOrderTxt").click(function(){$(this).focus()}).blur(function(){ControlLengthTextarea($("#NewChipOrderTxt"));AdjusterNewChipTextArea($("#NewChipOrderTxt"),$("#NewChipOrderDt"));$("#NewChipContent").animate({scrollTop:0,scrollLeft:0},"normal")}).bind("paste",function(e){setTimeout(function(){ControlLengthTextarea($("#NewChipOrderTxt"));AdjusterNewChipTextArea($("#NewChipOrderTxt"),
$("#NewChipOrderDt"))},0)}).bind("keyup",function(){ControlLengthTextarea($("#NewChipOrderTxt"));AdjusterNewChipTextArea($("#NewChipOrderTxt"),$("#NewChipOrderDt"))}).bind("keydown",function(){ControlLengthTextarea($("#NewChipOrderTxt"))})}function NewChipNameTitleFocusIn(){gSC3240501BeforeNameTitle=$(this).val()}function NewChipNameTitleFocusOut(){var beforeValue=gSC3240501BeforeNameTitle;gSC3240501BeforeNameTitle=null}
function NewChipSvcClassIDFocusIn(){gSC3240501BeforeSvcClassID=$(this).val()}
function NewChipSvcClassIDFocusOut(){var beforeValue=gSC3240501BeforeSvcClassID;gSC3240501BeforeSvcClassID=null;var afterValue=$(this).val();if(beforeValue==afterValue)return;else if(afterValue.trim()=="0"){var e=document.getElementById("NewChipMercList");e.options.length=0;$("#NewChipMercLabel").text("");$("#NewChipMercList").attr("disabled",true);$("#NewChipMercList").attr("MERCITEM",0);return false}else{$("#NewChipRegisterBtn").attr("disabled",true);gNewChipActiveIndicator.show();gNewChipOverlay.show();
commonRefreshTimer(ReDisplayNewChip);var svcClassInfo=afterValue.split(",");var prms=CreateCallBackGetMercParam(C_SC3240501CALLBACK_GETMERC,svcClassInfo[0]);SetNewChip_StandardWorkTime(svcClassInfo[1]);SetNewChip_CompleteExaminationArea(svcClassInfo[2]);SetNewChip_CarWashArea(svcClassInfo[3]);calculateScheDeliDateTime();DoCallBack(C_CALLBACK_WND501,prms,SC3240501AfterCallBack,"NewChipSvcClassIDFocusOut");return false}}function NewChipMercIDFocusIn(){gSC3240501BeforeMercID=$(this).val()}
function NewChipMercIDFocusOut(){var beforeValue=gSC3240501BeforeMercID;gSC3240501BeforeMercID=null;var afterValue=$(this).val();if(afterValue==null)afterValue="0";if(beforeValue==afterValue)return;else if(afterValue.trim()=="0")return false;else{var mercInfo=afterValue.split(",");SetNewChip_StandardWorkTime(mercInfo[1]);calculateScheDeliDateTime();return false}}
function SetEventNewChipChipArea(){$("#NewChipTableChipUl .Cassette").bind("click",function(e){var closestDl=$(e.target).closest("dl");var closestDiv=$(e.target).closest("div");var selectRowIndex=0;var selectChipIndex=0;var selectChipRezId=-1;var selectTxt="";if(closestDl.find("dd").hasClass(C_SC3240501CLASS_BACKGROUNDGRAY))return;if(closestDiv.hasClass(C_SC3240501CLASS_BACKGROUNDGRAY))return;if(closestDl.attr("openFlg")=="0"){closestDl.find(".SingleLine").hide();closestDl.height(closestDl.attr("maxh"));
closestDl.attr("openFlg","1")}else{closestDl.find("div").removeClass(C_SC3240501CLASS_CHECKBLUE);closestDiv.addClass(C_SC3240501CLASS_CHECKBLUE);if(closestDiv.hasClass("Unselected"))selectTxt=$("#WordChipUnselectedHidden").val();else selectTxt=closestDl.find(".CheckBlue").children("span").text();closestDl.find("dd").children(".SingleLine").text(selectTxt);selectChipRezId=closestDiv.attr("rezid");closestDl.attr("selectrezid",selectChipRezId);closestDl.find("dd").children(".SingleLine").css("display",
"block");if($("#MyJobDtlIdHidden").val()==selectChipRezId||closestDiv.hasClass("Unselected"))closestDl.find("dd").children(".SingleLine").css("font-weight","bold");else closestDl.find("dd").children(".SingleLine").css("font-weight","normal");closestDl.height(29);closestDl.attr("openFlg","0");selectRowIndex=closestDl.attr("rowindex");selectChipIndex=closestDiv.attr("chipindex")}})}
function SetNewChipReservationArea(){$("#NewChipRezFlgHidden").val("0");$("#NewChipReserveLi dd").addClass(C_SC3240501CLASS_TEXTBLUE);$("#NewChipReserveLi dd:first").addClass(C_SC3240501CLASS_CHECKBLUE);$("#NewChipReserveLi dd:first").bind(C_SC3240501_TOUCH,function(){$("#NewChipReserveLi dd").removeClass(C_SC3240501CLASS_CHECKBLUE);$("#NewChipReserveLi dd:first").addClass(C_SC3240501CLASS_CHECKBLUE);$("#NewChipRezFlgHidden").val("0")});$("#NewChipReserveLi dd:last").bind(C_SC3240501_TOUCH,function(){$("#NewChipReserveLi dd").removeClass(C_SC3240501CLASS_CHECKBLUE);
$("#NewChipReserveLi dd:last").addClass(C_SC3240501CLASS_CHECKBLUE);$("#NewChipRezFlgHidden").val("1")})}
function SetEventNewChipCompleteExaminationArea(){$("#NewChipCompleteExaminationLi dd").addClass(C_SC3240501CLASS_TEXTBLUE);if("1"==$("#NewChipCompleteExaminationFlgHidden").val())$("#NewChipCompleteExaminationLi dd:first").addClass(C_SC3240501CLASS_CHECKBLUE);else $("#NewChipCompleteExaminationLi dd:last").addClass(C_SC3240501CLASS_CHECKBLUE);$("#NewChipCompleteExaminationLi dd:first").bind(C_SC3240501_TOUCH,function(){$("#NewChipCompleteExaminationLi dd").removeClass(C_SC3240501CLASS_CHECKBLUE);
$("#NewChipCompleteExaminationLi dd:first").addClass(C_SC3240501CLASS_CHECKBLUE);$("#NewChipCompleteExaminationFlgHidden").val("1");calculateScheDeliDateTime()});$("#NewChipCompleteExaminationLi dd:last").bind(C_SC3240501_TOUCH,function(){$("#NewChipCompleteExaminationLi dd").removeClass(C_SC3240501CLASS_CHECKBLUE);$("#NewChipCompleteExaminationLi dd:last").addClass(C_SC3240501CLASS_CHECKBLUE);$("#NewChipCompleteExaminationFlgHidden").val("0");calculateScheDeliDateTime()})}
function SetNewChipCarWashArea(){$("#NewChipCarWashLi dd").addClass(C_SC3240501CLASS_TEXTBLUE);if("1"==$("#NewChipCarWashFlgHidden").val())$("#NewChipCarWashLi dd:first").addClass(C_SC3240501CLASS_CHECKBLUE);else $("#NewChipCarWashLi dd:last").addClass(C_SC3240501CLASS_CHECKBLUE);$("#NewChipCarWashLi dd:first").bind(C_SC3240501_TOUCH,function(){$("#NewChipCarWashLi dd").removeClass(C_SC3240501CLASS_CHECKBLUE);$("#NewChipCarWashLi dd:first").addClass(C_SC3240501CLASS_CHECKBLUE);$("#NewChipCarWashFlgHidden").val("1");
calculateScheDeliDateTime()});$("#NewChipCarWashLi dd:last").bind(C_SC3240501_TOUCH,function(){$("#NewChipCarWashLi dd").removeClass(C_SC3240501CLASS_CHECKBLUE);$("#NewChipCarWashLi dd:last").addClass(C_SC3240501CLASS_CHECKBLUE);$("#NewChipCarWashFlgHidden").val("0");calculateScheDeliDateTime()})}
function SetNewChipWaitingArea(){$("#NewChipWaitingFlgHidden").val("0");$("#NewChipWaitingLi dd").addClass(C_SC3240501CLASS_TEXTBLUE);$("#NewChipWaitingLi dd:first").addClass(C_SC3240501CLASS_CHECKBLUE);$("#NewChipWaitingLi dd:first").bind(C_SC3240501_TOUCH,function(){$("#NewChipWaitingLi dd").removeClass(C_SC3240501CLASS_CHECKBLUE);$("#NewChipWaitingLi dd:first").addClass(C_SC3240501CLASS_CHECKBLUE);$("#NewChipWaitingFlgHidden").val("0")});$("#NewChipWaitingLi dd:last").bind(C_SC3240501_TOUCH,function(){$("#NewChipWaitingLi dd").removeClass(C_SC3240501CLASS_CHECKBLUE);
$("#NewChipWaitingLi dd:last").addClass(C_SC3240501CLASS_CHECKBLUE);$("#NewChipWaitingFlgHidden").val("4")})}
function SetNewChip_StandardWorkTime(standardWorkTime){var min;if(standardWorkTime==""||standardWorkTime=="0")min=gResizeInterval;else min=smbScript.RoundUpToNumUnits(standardWorkTime,gResizeInterval,gResizeInterval,C_SC3240501_MAXWORKTIME);$("#NewChipWorkTimeHidden").val(min);var startDateTime=smbScript.changeStringToDateIcrop($("#NewChipPlanStartDateTimeSelector").get(0).value);if(startDateTime!=null){var newEndDateTime=smbScript.CalcEndDate_ExcludeOutOfTime(startDateTime,min);$("#NewChipPlanFinishDateTimeSelector").get(0).value=
smbScript.getDateTimelocalDate(newEndDateTime);$("#NewChipPlanFinishTimeLabel").text(smbScript.ConvertDateToStringForDisplay(newEndDateTime));$("#NewChipRegisterBtn").attr("disabled",IsMandatoryNewChipTextEmpty())}return false}
function SetNewChip_CompleteExaminationArea(svcClassType){if(svcClassType.trim()!="")if(svcClassType=="1"||svcClassType=="2"){$("#NewChipCompleteExaminationLi dd").removeClass(C_SC3240501CLASS_CHECKBLUE);$("#NewChipCompleteExaminationLi dd:last").addClass(C_SC3240501CLASS_CHECKBLUE);$("#NewChipCompleteExaminationFlgHidden").val("0")}else{$("#NewChipCompleteExaminationLi dd").removeClass(C_SC3240501CLASS_CHECKBLUE);$("#NewChipCompleteExaminationLi dd:first").addClass(C_SC3240501CLASS_CHECKBLUE);$("#NewChipCompleteExaminationFlgHidden").val("1")}return false}
function SetNewChip_CarWashArea(carWashNeedFlg){if(carWashNeedFlg.trim()!="")if(carWashNeedFlg=="1"){$("#NewChipCarWashLi dd").removeClass(C_SC3240501CLASS_CHECKBLUE);$("#NewChipCarWashLi dd:first").addClass(C_SC3240501CLASS_CHECKBLUE);$("#NewChipCarWashFlgHidden").val("1")}else{$("#NewChipCarWashLi dd").removeClass(C_SC3240501CLASS_CHECKBLUE);$("#NewChipCarWashLi dd:last").addClass(C_SC3240501CLASS_CHECKBLUE);$("#NewChipCarWashFlgHidden").val("0")}return false}
function SetSearchTextEvent(){$("#SearchText").keydown(function(e){if(e.which==13){SearchCustomer();$("#SearchText").blur();return false}})}function ControlLengthTextarea(ta){var maxLen=ta.attr("maxlen");var overFlg=0;var v=ta.val();if(v.length>maxLen)var overFlg=1;if(overFlg=="1"){var AfterStr=v.substr(0,maxLen);ta.val(AfterStr)}};
