var C_NEWCHIP_MESSAGEID_ERROR="9999";var C_NEWCHIP_TA_DEFAULTHEIGHT=90;var C_NEWCHIP_TA_DEFAULTHEIGHT_ADDRESS=54;var C_NEWCHIP_TA_DEFAULTHEIGHT_CUSTINFO=204;var C_NEWCHIP_TA_OFFSET_PADDING_ADDRESS=16;var C_NEWCHIP_POP_DISPLEFT_ARROW_X=362;var C_NEWCHIP_POP_DISPRIGHT_ARROW_X=-17;var C_NEWCHIP_POP_DISPRIGHT_DEFAULT_X=635;var C_SC3240501_TOUCH="mousedown touchstart";var gNewChipPopX;var gNewChipSearchedFlg;var selectSearchTypeIndex=0;var aryPostCtrl=new Array;
$(function(){$(document).ready(function(){var prm=Sys.WebForms.PageRequestManager.getInstance();prm.add_beginRequest(function(){});prm.add_endRequest(EndRequest);function EndRequest(sender,args){if(aryPostCtrl.length>0){var postBackControl=aryPostCtrl.shift();if(IsJudgeEndRequest(postBackControl)==false)return;switch(postBackControl){case "SearchCustomer":$(".SearchData").bind("click",function(event){$(".SearchData").removeClass("SelectionOn");$(this).addClass("SelectionOn");$("#SearchRegistrationNumberChange").val($(this).children("#SearchRegistrationNumber").text());
$("#SearchVinChange").val($(this).children("#SearchVinNo").text());$("#SearchCustomerNameChange").val($(this).children("#SearchCustomerName").text());$("#SearchPhoneChange").val($(this).children("#SearchPhone").text());$("#SearchMobileChange").val($(this).children("#SearchMobile").text());var ChangeParameterDiv=$(this).children("#CustomerChangeParameter");$("#SearchVehicleChange").val(ChangeParameterDiv.attr("VehicleParameter"));$("#SearchSANameChange").val(ChangeParameterDiv.attr("SaNameParameter"));
$("#SearchCustomerAddressChange").val(ChangeParameterDiv.attr("CustomerAddressParameter"));$("#SearchDmsCstCodeChange").val(ChangeParameterDiv.attr("DmsCstCodeParameter"));$("#SearchTitleCodeChange").val(ChangeParameterDiv.attr("NameTitleCodeParameter"));$("#SearchTitleChange").val(ChangeParameterDiv.attr("NameTitleNameParameter"));$("#InsertSaCode").val(ChangeParameterDiv.attr("SaCodeParameter"));$("#InsertCstId").val(ChangeParameterDiv.attr("CstIdParameter"));$("#InsertVin").val(ChangeParameterDiv.attr("VinParameter"));
$("#InsertVclId").val(ChangeParameterDiv.attr("VclIdParameter"));$("#InsertCstVclType").val(ChangeParameterDiv.attr("CustomerVehicleTypeParameter"));$("#SearchRegisterBtn").attr("disabled",false);$("#SearchBottomButton").removeClass("BottomButtonDisable");$("#SearchBottomButton").attr("disabled",false)});break;default:break}}}})});
function IsJudgeEndRequest(postBackCtrl){var rtn=true;if(aryPostCtrl.length>0){var str="";for(var i=0;i<aryPostCtrl.length;i++){str=aryPostCtrl[i];if(postBackCtrl==str){rtn=false;break}}}return rtn}var gNewChipActiveIndicator={show:function(){$("#NewChipActiveIndicator").addClass("show")},hide:function(){$("#NewChipActiveIndicator").removeClass("show")}};
var gNewChipOverlay={show:function(){$("#MstPG_registOverlayBlack").css({"display":"block","z-index":"10002","opacity":"0.1","height":"768px"})},hide:function(){$("#MstPG_registOverlayBlack").css({"display":"none","z-index":"4","opacity":"0","height":"703px"})}};function SetNewChipHeaderButton(val){$("#NewChipCancelBtn").css("display",val);$("#NewChipRegisterBtn").css("display",val)}
function SetSearchHeaderButton(val){$("#SearchCancelBtn").css("display",val);$("#SearchRegisterBtn").css("display",val)}
function ShowNewChip(){gNewChipActiveIndicator.hide();gNewChipOverlay.hide();$("#SearchDataLoading").css("display","none");SetSearchHeaderButton("none");$("#SearchHeaderLabel").css("display","none");SetNewChipHeaderButton("block");$("#NewChipHeaderLabel").css("display","inline-block");$("#NewChipRegisterBtn").attr("disabled",true);$("#SearchRegisterBtn").attr("disabled",true);$("#NewChipContent>div").remove();var baseCtrl=$("#"+gSelectedChipId);SetNewChipPopoverPosition(CalcNewChipPopoverPosition(baseCtrl));
$("#NewChipPopup").fadeIn(300);gNewChipActiveIndicator.show();commonRefreshTimer(ReDisplayNewChip);CreateNewChipPage()}function CreateNewChipPage(){var prms=CreateNewChipCallBackDisplayParam(C_SC3240501CALLBACK_CREATEDISP,gSelectedChipId);DoCallBack(C_CALLBACK_WND501,prms,SC3240501AfterCallBack,"CreateNewChipPage")}
function CreateNewChipCallBackDisplayParam(method,chipId){var rtnVal={Method:method,DisplayStartDate:gArrObjChip[C_NEWCHIPID].displayStartDate,DisplayEndDate:gArrObjChip[C_NEWCHIPID].displayEndDate,StallId:gArrObjChip[C_NEWCHIPID].stallId};return rtnVal}
function CreateNewChipCallBackRegistParam(method,chipId,restFlg){var e=document.getElementById("NewChipMaintenanceTypeList");var regSvcClassId;if(e.selectedIndex<0)regSvcClassId=0;else{var svcClassInfo=e.options[e.selectedIndex].value.split(",");regSvcClassId=svcClassInfo[0]}var f=document.getElementById("NewChipMercList");var regMercId;if(f.selectedIndex<0)regMercId=0;else{var mercInfo=f.options[f.selectedIndex].value.split(",");regMercId=mercInfo[0]}var regNameTitleCd;var regNameTitleName;var regSACd;
if(gNewChipSearchedFlg==1){regNameTitleCd=$("#SearchTitleCodeChange").val();regNameTitleName=$("#SearchTitleChange").val();regSACd=$("#InsertSaCode").val()}else{var g=document.getElementById("NewChipTitleList");regNameTitleCd=g.options[g.selectedIndex].value;regNameTitleName=g.options[g.selectedIndex].text;var h=document.getElementById("NewChipSAList");regSACd=h.options[h.selectedIndex].value}var rtnVal={Method:method,DlrCD:$("#hidDlrCD").val(),StrCD:$("#hidBrnCD").val(),ShowDate:$("#hidShowDate").val(),
Account:icropScript.ui.account,StallId:gArrObjChip[C_NEWCHIPID].stallId,VisitPlanTime:smbScript.ConvertDateToString2(smbScript.changeStringToDateIcrop($("#NewChipPlanVisitDateTimeSelector").get(0).value)),StartPlanTime:smbScript.ConvertDateToString2(smbScript.changeStringToDateIcrop($("#NewChipPlanStartDateTimeSelector").get(0).value)),FinishPlanTime:smbScript.ConvertDateToString2(smbScript.changeStringToDateIcrop($("#NewChipPlanFinishDateTimeSelector").get(0).value)),DeriveredPlanTime:smbScript.ConvertDateToString2(smbScript.changeStringToDateIcrop($("#NewChipPlanDeriveredDateTimeSelector").get(0).value)),
NewChipDispStartDate:smbScript.changeStringToDateIcrop($("#NewChipPlanStartDateTimeSelector").get(0).value),WorkTime:$("#NewChipWorkTimeHidden").val(),Order:$("#NewChipOrderTxt").val(),RezFlg:$("#NewChipRezFlgHidden").val(),CarWashFlg:$("#NewChipCarWashFlgHidden").val(),WaitingFlg:$("#NewChipWaitingFlgHidden").val(),CstId:$("#InsertCstId").val(),Vin:$("#NewChipVinText").val(),VclId:$("#InsertVclId").val(),CstVclType:$("#InsertCstVclType").val(),SACode:regSACd,RegNo:$("#NewChipRegNoText").val(),ValidateCode:CheckNewChipInputValue(),
Vehicle:$("#NewChipVehicleText").val(),CstName:$("#NewChipCstNameText").val(),Mobile:$("#NewChipMobileText").val(),Home:$("#NewChipHomeText").val(),Merc:$("#NewChipMercLabel").text(),CstAddress:$("#NewChipCstAddressText").val(),DmsCstCode:$("#SearchDmsCstCodeChange").val(),CompleteExaminationFlg:$("#NewChipCompleteExaminationFlgHidden").val(),SvcClassId:regSvcClassId,MercId:regMercId,NameTitleCD:regNameTitleCd,NameTitleName:regNameTitleName,RowLockVersion:gArrObjChip[C_NEWCHIPID].rowLockVersion,RestFlg:restFlg,
StallStartTime:$("#hidStallStartTime").val(),StallEndTime:$("#hidStallEndTime").val(),InputStallStartTime:GetInputStallStartTime(),InputStallEndTime:GetInputStallEndTime(),SearchedFlg:gNewChipSearchedFlg};return rtnVal}function CreateCallBackGetMercParam(method,aftValue){var rtnVal={Method:method,DlrCD:$("#hidDlrCD").val(),StrCD:$("#hidBrnCD").val(),SvcClassId:aftValue};return rtnVal}
function SC3240501AfterCallBack(result,context){var jsonResult=JSON.parse(result);commonClearTimer();if(jsonResult.ResultCode==3){gNewChipActiveIndicator.hide();gNewChipOverlay.hide();var e=document.getElementById("NewChipMercList");e.options.length=0;$("#NewChipMercLabel").text("");$("#NewChipMercList").attr("disabled",true);$("#NewChipRegisterBtn").attr("disabled",IsMandatoryNewChipTextEmpty());AfterCallBack();$("#NewChipMercList").attr("MERCITEM",0);return false}else if(jsonResult.ResultCode!=
0&&jsonResult.ResultCode!=-9E3){if(jsonResult.ResultCode!=4)icropScript.ShowMessageBox(jsonResult.ResultCode,jsonResult.Message,"");gNewChipActiveIndicator.hide();gNewChipOverlay.hide();$("#NewChipCancelBtn").attr("disabled",false);if(jsonResult.ResultCode==4){var result=confirm(htmlDecode($("#NewChipWordDuplicateRestOrUnavailableHidden").val()));var restFlg=0;if(result)restFlg=1;else if(!$("#NewChipPlanFinishDateTimeSelector").attr("readonly")){var newEndDateTime=smbScript.CalcEndDate_ExcludeOutOfTime(smbScript.changeStringToDateIcrop($("#NewChipPlanStartDateTimeSelector").get(0).value),
$("#NewChipWorkTimeHidden").val());$("#NewChipPlanFinishDateTimeSelector").get(0).value=smbScript.getDateTimelocalDate(newEndDateTime);$("#NewChipPlanFinishLabel").text(smbScript.ConvertDateOrTime(newEndDateTime,$("#hidShowDate").val()))}gNewChipActiveIndicator.show();gNewChipOverlay.show();commonRefreshTimer(ReDisplayNewChip);var prms=CreateNewChipCallBackRegistParam(C_SC3240501CALLBACK_REGISTER,gSelectedChipId,restFlg);AfterCallBack();DoCallBack(C_CALLBACK_WND501,prms,SC3240501AfterCallBack,"NewChipRegisterButton")}else if(jsonResult.ResultCode==
6){CloseNewChip();SetTableUnSelectedStatus(gSelectedChipId);SetChipUnSelectedStatus();ClearOperationList();ClickChangeDate(0)}else{AfterCallBack();return false}}else if(jsonResult.Caller==C_SC3240501CALLBACK_CREATEDISP){InitNewChipPage(result,context);gNewChipActiveIndicator.hide();gNewChipOverlay.hide();if(jsonResult.NewChipJson!=null){var mercDataList=$.parseJSON(htmlDecode(jsonResult.NewChipJson));var e=document.getElementById("NewChipMercList");e.options.length=0;$("#NewChipMercLabel").text("");
e.options[0]=new Option("",0);var i=1;for(var keyString in mercDataList){var mercData=mercDataList[keyString];e.options[i]=new Option(mercData.MERC_NAME,mercData.MERCID_TIME);i=i+1}$("#NewChipMercList").attr("MERCITEM",1);$("#NewChipMercList").attr("disabled",false)}$("#NewChipRegisterBtn").attr("disabled",IsMandatoryNewChipTextEmpty());AfterCallBack()}else if(jsonResult.Caller==C_SC3240501CALLBACK_GETMERC){gNewChipActiveIndicator.hide();gNewChipOverlay.hide();var mercDataList=$.parseJSON(htmlDecode(jsonResult.NewChipJson));
var e=document.getElementById("NewChipMercList");e.options.length=0;$("#NewChipMercLabel").text("");e.options[0]=new Option("",0);var i=1;for(var keyString in mercDataList){var mercData=mercDataList[keyString];e.options[i]=new Option(mercData.MERC_NAME,mercData.MERCID_TIME);i=i+1}$("#NewChipMercList").attr("MERCITEM",1);$("#NewChipMercList").attr("disabled",false);$("#NewChipRegisterBtn").attr("disabled",IsMandatoryNewChipTextEmpty());AfterCallBack()}else{gNewChipActiveIndicator.hide();gNewChipOverlay.hide();
if(jsonResult.ResultCode==-9E3)icropScript.ShowMessageBox(jsonResult.ResultCode,jsonResult.Message,"");CloseNewChip();var newChipDataList=$.parseJSON(htmlDecode(jsonResult.NewChipJson));var otherChipsInfo=htmlDecode(jsonResult.Contents);for(var keyString in newChipDataList){var newChipData=newChipDataList[keyString];var strKey=newChipData.STALL_USE_ID;if(gArrObjChip[strKey]==undefined)gArrObjChip[strKey]=new ReserveChip(strKey);gArrObjChip[strKey].setChipParameter(newChipData);gArrObjChip[strKey].createChip(C_CHIPTYPE_STALL);
$("#"+C_NEWCHIPID).remove();SetChipPosition(strKey,"","","");AdjustChipItemByWidth(strKey,gArrObjChip[strKey].vclRegNo);BindChipClickEvent(strKey);UpdateChipColorByDelayDate(strKey);SetTableUnSelectedStatus(strKey);SetChipUnSelectedStatus()}ShowLatestChips(otherChipsInfo,false,false);AfterCallBack()}}
function InitNewChipPage(result,context){var jsonResult=JSON.parse(result);SetNewChipContents(jsonResult.Contents);$("#NewChipContent").fingerScroll();$("#NewChipPopup .NewChipEllipsis").CustomLabel({useEllipsis:true});SetNewChipReservationArea();SetEventNewChipCompleteExaminationArea();SetNewChipCarWashArea();SetNewChipWaitingArea();gNewChipSearchedFlg=0;InitNewChipTextBoxArea();InitNewChipHiddenSearchArea();InitNewChipTextArea($("#NewChipOrderTxt"),$("#NewChipOrderDt"));var timeSpan=smbScript.CalcTimeSpan(smbScript.changeStringToDateIcrop($("#NewChipPlanStartDateTimeSelector").get(0).value),
smbScript.changeStringToDateIcrop($("#NewChipPlanFinishDateTimeSelector").get(0).value));if(timeSpan!=null)$("#NewChipWorkTimeHidden").val(timeSpan);SetNewChipTextEvent();SetSearchTextEvent();$("#Selection1").addClass("ButtonOn");$(".TextArea")[0].placeholder=$("#SearchPlaceRegNo").html();$("#NewChipCustDetailBtn").attr("disabled",true);$("#NewChipRORefBtn").attr("disabled",true)}
function SetNewChipContents(cbResult){var contents=$("<Div>").html(cbResult).text();var newChip=$(contents).find("#NewChipContent");var search=$(contents).find("#search");var newChipHidden=$(contents).find("#SC3240501HiddenArea");$("#NewChipContent>div").remove();newChip.children("div").clone(true).appendTo("#NewChipContent");$("#search>div").remove();search.children("div").clone(true).appendTo("#search");$("#SC3240501HiddenArea>div").remove();newChipHidden.children("div").clone(true).appendTo("#SC3240501HiddenArea")}
function CheckNewChipInputValue(){var rtnVal=0;var planStart=smbScript.changeStringToDateIcrop($("#NewChipPlanStartDateTimeSelector").get(0).value);var planEnd=smbScript.changeStringToDateIcrop($("#NewChipPlanFinishDateTimeSelector").get(0).value);var planVisit=smbScript.changeStringToDateIcrop($("#NewChipPlanVisitDateTimeSelector").get(0).value);var planDeli=smbScript.changeStringToDateIcrop($("#NewChipPlanDeriveredDateTimeSelector").get(0).value);var mercMandType=$("#NewChipMercMandatoryTypeHidden").val();
if(!smbScript.CheckChipInStallTime(planStart,planEnd))rtnVal=906;else if(!smbScript.CheckContextOfPlan(planVisit,planStart,planEnd,planDeli))rtnVal=904;else if($("#NewChipMandatoryFlgHidden").val()=="1")if(planVisit==null)rtnVal=911;else if(planDeli==null)rtnVal=912;if(mercMandType!=C_SC3240501_NOCHECK&&rtnVal==0){var maintenanceType=$("#NewChipMaintenanceTypeList").val();var mercType=$("#NewChipMercList").val();switch(mercMandType){case C_SC3240501_CHECK_MAINTE_AND_MERC:if(maintenanceType=="0"||
maintenanceType==null)rtnVal=914;else if(mercType=="0"||mercType==null)if($("#NewChipMercList").attr("MERCITEM")==1)rtnVal=915;break;case C_SC3240501_CHECK_MAINTE:if(maintenanceType=="0"||maintenanceType==null)rtnVal=914;break;default:break}}return rtnVal}
function IsMandatoryNewChipTextEmpty(){var rtnVal=false;var checkItem1=$("#NewChipRegNoText").val();var checkItem2=$("#NewChipVinText").val();var checkItem3=$("#NewChipVehicleText").val();var checkItem4=$("#NewChipCstNameText").val();var checkItem5=$("#NewChipMobileText").val();var checkItem6=$("#NewChipHomeText").val();var checkItem7=$("#NewChipPlanStartTimeLabel").text();var checkItem8=$("#NewChipPlanFinishTimeLabel").text();var checkItem9=$("#NewChipWorkTimeHidden").val();var checkItem10=$("#NewChipCstAddressText").val();
var checkItem11=$("#NewChipTitleLabel").text();if(checkItem1==""&&checkItem2=="")rtnVal=true;else if(checkItem5==""&&checkItem6=="")rtnVal=true;else if(checkItem3==""||checkItem4==""||checkItem7==""||checkItem8==""||checkItem9==""||checkItem10==""||checkItem11=="")rtnVal=true;return rtnVal}
function InitNewChipTextArea(ctrlTa,ctrlDt){var settingHeight=0;var textArea=ctrlTa;var headerDt=ctrlDt;if(C_NEWCHIP_TA_DEFAULTHEIGHT<textArea.attr("scrollHeight"))settingHeight=textArea.attr("scrollHeight");else settingHeight=C_NEWCHIP_TA_DEFAULTHEIGHT;textArea.height(settingHeight);headerDt.css("line-height",settingHeight+12+"px")}
function SetNewChipTextAreaAddress(ctrlTa,ctrlDt){var settingHeight=0;var textArea=$("#NewChipCstAddressText");var textAreaDt=$("#NewChipCstAddressDt");var textAreaDd=$("#NewChipCstAddressDd");var textAreaDl=$("#NewChipCstAddressDl");var textAreali=$(".newChipCstAddress");var CustInfoUi=$("#NewChipCustInfoUl");if(C_NEWCHIP_TA_DEFAULTHEIGHT_ADDRESS<textArea.attr("scrollHeight"))settingHeight=textArea.attr("scrollHeight");else settingHeight=C_NEWCHIP_TA_DEFAULTHEIGHT_ADDRESS;CustInfoUi.height(C_NEWCHIP_TA_DEFAULTHEIGHT_CUSTINFO+
settingHeight-C_NEWCHIP_TA_DEFAULTHEIGHT_ADDRESS);textArea.height(settingHeight-C_NEWCHIP_TA_OFFSET_PADDING_ADDRESS);textAreaDt.height(settingHeight);textAreaDt.css("line-height",settingHeight+"px");textAreaDd.height(settingHeight);textAreaDl.height(settingHeight);textAreali.height(settingHeight)}
function InitNewChipTextBoxArea(){$("#NewChipRegNoText").val("");$("#NewChipVinText").val("");$("#NewChipVehicleText").val("");$("#NewChipCstNameText").val("");$("#NewChipMobileText").val("");$("#NewChipHomeText").val("");$("#NewChipCstAddressText").val("")}
function InitNewChipHiddenSearchArea(){$("#SearchRegistrationNumberChange").val("");$("#SearchVinChange").val("");$("#SearchVehicleChange").val("");$("#SearchCustomerNameChange").val("");$("#SearchMobileChange").val("");$("#SearchPhoneChange").val("");$("#SearchCustomerAddressChange").val("");$("#SearchSANameChange").val("");$("#SearchDmsCstCodeChange").val("");$("#SearchTitleChange").val("");$("#SearchTitleCodeChange").val("");$("#InsertSaCode").val("");$("#InsertCstId").val("");$("#InsertVin").val("");
$("#InsertVclId").val("");$("#InsertCstVclType").val("")}
function AdjusterNewChipTextArea(ctrlTa,ctrlDt){var textArea=ctrlTa;var headerDt=ctrlDt;textArea.height(C_NEWCHIP_TA_DEFAULTHEIGHT);var tmp_sh=textArea.attr("scrollHeight");while(tmp_sh>textArea.attr("scrollHeight")){tmp_sh=textArea.attr("scrollHeight");textarea[0].scrollHeight++}if(textArea.attr("scrollHeight")>=textArea.attr("offsetHeight")){textArea.height(textArea.attr("scrollHeight"));headerDt.css("line-height",textArea.attr("scrollHeight")+12+"px")}}
function AdjusterNewChipTextAreaAddress(){var textArea=$("#NewChipCstAddressText");var textAreaDt=$("#NewChipCstAddressDt");var textAreaDd=$("#NewChipCstAddressDd");var textAreaDl=$("#NewChipCstAddressDl");var textAreali=$(".newChipCstAddress");var CustInfoUi=$("#NewChipCustInfoUl");textArea.height(C_NEWCHIP_TA_DEFAULTHEIGHT_ADDRESS-C_NEWCHIP_TA_OFFSET_PADDING_ADDRESS);if(textArea.attr("scrollHeight")>=textArea.attr("offsetHeight")){CustInfoUi.height(C_NEWCHIP_TA_DEFAULTHEIGHT_CUSTINFO+textArea.attr("scrollHeight")-
C_NEWCHIP_TA_DEFAULTHEIGHT_ADDRESS);textArea.height(textArea.attr("scrollHeight")-C_NEWCHIP_TA_OFFSET_PADDING_ADDRESS);textAreaDt.height(textArea.attr("scrollHeight"));textAreaDt.css("line-height",textArea.attr("scrollHeight")+"px");textAreaDd.height(textArea.attr("scrollHeight"));textAreaDl.height(textArea.attr("scrollHeight"));textAreali.height(textArea.attr("scrollHeight"))}}
function AdjustNewChipDisplay(){$("#NewChipPopup").css("display","inline-block");setTimeout(function(){$("#NewChipPopup").css("display","block")},0)}function ControlLengthNewChipTextarea(ta){var maxLen=ta.attr("maxlen");if(ta.val().length>maxLen)ta.val(ta.val().substr(0,maxLen))}function NewChipCancelButton(){CloseNewChip();return false}
function SearchCancelButton(){SetSearchHeaderButton("none");$("#SearchHeaderLabel").css("display","none");SetNewChipHeaderButton("block");$("#NewChipHeaderLabel").css("display","inline-block");SlideStatus();return false}
function NewChipRegisterButton(){gNewChipActiveIndicator.show();gNewChipOverlay.show();commonRefreshTimer(ReDisplayNewChip);var prms=CreateNewChipCallBackRegistParam(C_SC3240501CALLBACK_REGISTER,gSelectedChipId,-1);DoCallBack(C_CALLBACK_WND501,prms,SC3240501AfterCallBack,"NewChipRegisterButton");return false}
function SearchRegisterButton(){gNewChipSearchedFlg=1;SetSearchValue();SetSearchHeaderButton("none");$("#SearchHeaderLabel").css("display","none");SetNewChipHeaderButton("block");$("#NewChipHeaderLabel").css("display","inline-block");$("#NewChipCustDetailBtn").attr("disabled",false);SlideStatus();$("#NewChipRegisterBtn").attr("disabled",IsMandatoryNewChipTextEmpty());return false}
function SetSearchValue(){$("#NewChipRegNoText").val($("#SearchRegistrationNumberChange").val());$("#NewChipRegNoText").addClass(C_SC3240501CLASS_TEXTBLACK);$("#NewChipRegNoText").attr("readonly",true);$("#NewChipVinText").val($("#SearchVinChange").val());$("#NewChipVinText").addClass(C_SC3240501CLASS_TEXTBLACK);$("#NewChipVinText").attr("readonly",true);$("#NewChipVehicleText").val($("#SearchVehicleChange").val());$("#NewChipVehicleText").addClass(C_SC3240501CLASS_TEXTBLACK);$("#NewChipVehicleText").attr("readonly",
true);$("#NewChipCstNameText").val($("#SearchCustomerNameChange").val());$("#NewChipCstNameText").addClass(C_SC3240501CLASS_TEXTBLACK);$("#NewChipCstNameText").attr("readonly",true);$("#NewChipTitleLabel").text($("#SearchTitleChange").val());$("#NewChipTitleLabel").addClass(C_SC3240501CLASS_TEXTBLACK);$("#NewChipTitleList").attr("disabled",true);$("#NewChipTitle").attr("style","background:none;");$("#NewChipMobileText").val($("#SearchMobileChange").val());$("#NewChipMobileText").addClass(C_SC3240501CLASS_TEXTBLACK);
$("#NewChipMobileText").attr("readonly",true);$("#NewChipHomeText").val($("#SearchPhoneChange").val());$("#NewChipHomeText").addClass(C_SC3240501CLASS_TEXTBLACK);$("#NewChipHomeText").attr("readonly",true);$("#NewChipSALabel").text($("#SearchSANameChange").val());$("#NewChipSALabel").addClass(C_SC3240501CLASS_TEXTBLACK);$("#NewChipSAList").attr("disabled",true);$("#NewChipSA").attr("style","background:none;");$("#NewChipCstAddressText").height(C_NEWCHIP_TA_DEFAULTHEIGHT_ADDRESS-C_NEWCHIP_TA_OFFSET_PADDING_ADDRESS);
$("#NewChipCstAddressText").val($("#SearchCustomerAddressChange").val());$("#NewChipCstAddressText").addClass(C_SC3240501CLASS_TEXTBLACK);$("#NewChipCstAddressText").attr("onFocus","this.blur()").attr("readonly",true);SetNewChipTextAreaAddress()}function CloseNewChip(){$("#NewChipRegisterBtn").unbind();$("#NewChipPopup").fadeOut(300);setTimeout(function(){SlideStatus()},300);CreateFooterButton(C_FT_DISPTP_SELECTED,C_FT_BTNTP_REZ_NEW);commonClearTimer();return false}
function CalcNewChipPopoverPosition(baseCtrl){var possibleDir={left:false,right:false};var ctrlPosition={popX:0,arrowX:0,arrowY:0};var popDispLeftX=baseCtrl.offset().left-($("#NewChipPopup .ArrowMask").width()/2-3)-$("#NewChipPopupContent").width();var popDispRightX=baseCtrl.offset().left+baseCtrl.width()+($("#NewChipPopup .ArrowMask").width()/2-3);if(popDispRightX+$("#NewChipPopupContent").width()<=$(document.body).width())possibleDir.right=true;else if(0<=popDispLeftX)possibleDir.left=true;if(possibleDir.right){ctrlPosition.popX=
popDispRightX;ctrlPosition.arrowX=C_NEWCHIP_POP_DISPRIGHT_ARROW_X}else if(possibleDir.left){ctrlPosition.popX=popDispLeftX;ctrlPosition.arrowX=C_NEWCHIP_POP_DISPLEFT_ARROW_X}else{ctrlPosition.popX=C_NEWCHIP_POP_DISPRIGHT_DEFAULT_X;ctrlPosition.arrowX=C_NEWCHIP_POP_DISPRIGHT_ARROW_X}ctrlPosition.arrowY=baseCtrl.offset().top+baseCtrl.height()/2-79;return ctrlPosition}
function SetNewChipPopoverPosition(ctrlPosition){$("#NewChipPopupContent").css("left",ctrlPosition.popX);$(".ArrowMask").css("left",ctrlPosition.arrowX);$(".ArrowMask").css("top",ctrlPosition.arrowY);gNewChipPopX=ctrlPosition.popX}
function SlideSearch(){SetNewChipHeaderButton("none");$("#NewChipHeaderLabel").css("display","none");SetSearchHeaderButton("block");$("#SearchHeaderLabel").css("display","inline-block");$("#SearchRegisterBtn").attr("disabled",true);$(".SearchDataBox .scroll-inner").css("transform","translate3d(0px, 0px, 0px)");$("#NoSearchImage").css("display","block");$(".contentInner").css("-webkit-transition","transform 500ms ease-in-out 0").css("transform","translate3d(-401px, 0, 0)");
$("#Selection1").addClass("ButtonOn");$(".TextArea")[0].placeholder=$("#SearchPlaceRegNo").html();$("#SearchBottomButton").addClass("BottomButtonDisable");$("#SearchBottomButton").attr("disabled",true);return false}
function SlideStatus(){$(".contentInner").css("transform","translate3d(0, 0, 0)");$(".SelectionButton").children("ul").children("li").removeClass("ButtonOn");$("#Selection1").addClass("ButtonOn");selectSearchTypeIndex=0;$(".TextArea")[0].placeholder=$("#SearchPlaceRegNo").html();searchListClear();$("#SearchBottomButton").addClass("BottomButtonDisable");$("#SearchBottomButton").attr("disabled",true);return false}
function SelectSearchType(select){$(".TextArea").blur();this.selectSearchTypeIndex=$(".SelectionButton ul li").index(select);selectButton=$(select).attr("className");switch(selectSearchTypeIndex){case 0:$(".TextArea")[0].placeholder=$("#SearchPlaceRegNo").html();break;case 1:$(".TextArea")[0].placeholder=$("#SearchPlaceVin").html();break;case 2:$(".TextArea")[0].placeholder=$("#SearchPlaceName").html();break;case 3:$(".TextArea")[0].placeholder=$("#SearchPlacePhone").html();break;default:break}if(selectButton===
"ButtonOn"){$(".TextArea").focus();return false}searchUl=$(".SelectionButton").children("ul");$(searchUl).children("li").removeClass("ButtonOn");$(select).addClass("ButtonOn");return false}
function SearchCustomer(){if(SearchInputCheck()==false)return;searchListClear();searchText=$(".TextArea").attr("value");$("#SearchRegistrationNumberHidden").val("");$("#SearchVinHidden").val("");$("#SearchCustomerNameHidden").val("");$("#SearchPhoneNumberHidden").val("");switch(this.selectSearchTypeIndex){case 0:$("#SearchRegistrationNumberHidden").val(searchText);break;case 1:$("#SearchVinHidden").val(searchText);break;case 2:$("#SearchCustomerNameHidden").val(searchText);break;case 3:$("#SearchPhoneNumberHidden").val(searchText);
break;default:break}$("#SearchStartRowHidden").val("1");$("#SearchEndRowHidden").val("1");$("#SearchSelectTypeHidden").val("0");$("#SearchDataLoading").css("display","block");aryPostCtrl.push("SearchCustomer");commonRefreshTimer(ReDisplayNewChip);$("#SearchCustomerDummyButton").click();return false}
function SearchInputCheck(){var rtnVal=true;searchText=$(".TextArea").attr("value");if(searchText.trim()==""){icropScript.ShowMessageBox(903,$("#SearchErrMsg1Hidden").val(),"");rtnVal=false}return rtnVal}function TextClear(){searchText=$(".TextArea").attr("value");if(searchText==undefined||searchText=="")return false;searchText="";$(".TextArea").attr("value",searchText)}
function SearchNextList(){$("#SearchSelectTypeHidden").val("1");aryPostCtrl.push("SearchCustomer");$("#SearchRegisterBtn").attr("disabled",true);$("#SearchBottomButton").addClass("BottomButtonDisable");$("#SearchBottomButton").attr("disabled",true);$(".NextList").css("display","none");$(".NextSearchingImage").css("display","block");$(".NextListSearching").css("display","block");commonRefreshTimer(ReDisplayNewChip);$("#SearchCustomerDummyButton").click()}
function SearchFrontList(){$("#SearchSelectTypeHidden").val("-1");aryPostCtrl.push("SearchCustomer");$("#SearchRegisterBtn").attr("disabled",true);$("#SearchBottomButton").addClass("BottomButtonDisable");$("#SearchBottomButton").attr("disabled",true);$(".FrontList").css("display","none");$(".FrontSearchingImage").css("display","block");$(".FrontListSearching").css("display","block");commonRefreshTimer(ReDisplayNewChip);$("#SearchCustomerDummyButton").click()}
function searchListClear(){var searchList=$("#SearchListBox");$(searchList).remove();$(searchList).empty();if($(".NoSearchImage").css("display")==="block")$(".NoSearchImage").css("display","none");if($(".FrontLink").css("display")==="block")$(".FrontLink").css("display","none");if($(".EndLink").css("display")==="block")$(".EndLink").css("display","none");$("#SearchRegisterBtn").attr("disabled",true);$("#SearchBottomButton").addClass("BottomButtonDisable");$("#SearchBottomButton").attr("disabled",
true)}function ReDisplayNewChip(){CloseNewChip();ClearOperationList();setTimeout(function(){FooterEvent(C_FT_BTNID_DETAIL)},200)}function SC3240501SubmitCancel(){return false}
function NewChipCustButton(){$("#NewChipCustBtnDiv").addClass("icrop-pressed");if($("#SearchDmsCstCodeChange").val()==""){icropScript.ShowMessageBox(910,$("#NewChipCstBtnErrMsgHidden").val(),"");$("#NewChipCustBtnDiv").removeClass("icrop-pressed")}else{setTimeout(function(){gNewChipActiveIndicator.show();gNewChipOverlay.show();$("#NewChipCustBtnDiv").removeClass("icrop-pressed")},300);commonRefreshTimer(ReDisplayNewChip);$("#NewChipCustButtonDummy").click()}return false}
function NewChipCustButton_Serch(){$("#SearchBottomButton").attr("style","background:#126EE4;");if($("#SearchDmsCstCodeChange").val()==""){icropScript.ShowMessageBox(910,$("#NewChipCstBtnErrMsgHidden").val(),"");$("#SearchBottomButton").attr("style","background:-webkit-gradient(linear, left top, left bottom, from(#fff), color-stop(0.50, #f7f8f9), color-stop(0.51, #edeff3), to(#edeff3));")}else{setTimeout(function(){gNewChipActiveIndicator.show();gNewChipOverlay.show();$("#SearchBottomButton").attr("style",
"background:-webkit-gradient(linear, left top, left bottom, from(#fff), color-stop(0.50, #f7f8f9), color-stop(0.51, #edeff3), to(#edeff3));")},300);commonRefreshTimer(ReDisplayNewChip);$("#NewChipCustButtonDummy").click()}return false}
function GetInputStallStartTime(){var rtnVal=0;var planStart=smbScript.changeStringToDateIcrop($("#NewChipPlanStartDateTimeSelector").get(0).value);var wkStart;wkStart=new Date(planStart);rtnVal=new Date(wkStart.getFullYear()+"/"+(wkStart.getMonth()+1)+"/"+wkStart.getDate()+" "+$("#hidStallStartTime").val()+":00");return rtnVal}
function GetInputStallEndTime(){var rtnVal=0;var planEnd=smbScript.changeStringToDateIcrop($("#NewChipPlanFinishDateTimeSelector").get(0).value);var wkEnd;wkEnd=new Date(planEnd);rtnVal=new Date(wkEnd.getFullYear()+"/"+(wkEnd.getMonth()+1)+"/"+wkEnd.getDate()+" "+$("#hidStallEndTime").val()+":00");return rtnVal}
function calculateScheSvcinDateTime(){if($("#ScheSvcinDeliAutoDispFlg").val()!=C_SCHESVCINDELIAUTODISPFLG_ENABLE)return;var newChipPlanStart=$("#NewChipPlanStartDateTimeSelector").get(0).value;if(!newChipPlanStart)return;var scheSvcinDateTime=smbScript.changeStringToDateIcrop(newChipPlanStart);scheSvcinDateTime=smbScript.CalcEndDateTime(scheSvcinDateTime,-1*$("#StdAcceptanceTime").val());$("#NewChipPlanVisitDateTimeSelector").get(0).value=smbScript.getDateTimelocalDate(scheSvcinDateTime);$("#NewChipPlanVisitTimeLabel").text(smbScript.ConvertDateToStringForDisplay(scheSvcinDateTime))}
function calculateScheDeliDateTime(){if($("#ScheSvcinDeliAutoDispFlg").val()!=C_SCHESVCINDELIAUTODISPFLG_ENABLE)return;var newChipPlanFinish=$("#NewChipPlanFinishDateTimeSelector").get(0).value;if(!newChipPlanFinish)return;var scheDeliDateTime=smbScript.changeStringToDateIcrop(newChipPlanFinish);if($("#NewChipCompleteExaminationFlgHidden").val()==C_INSPECTIONNEEDFLG_NEED)scheDeliDateTime=smbScript.CalcEndDateTime(scheDeliDateTime,$("#StdInspectionTime").val());var addTime=Number($("#StdDeliPreparationTime").val());
var stdCarwashTime=Number($("#StdCarwashTime").val());if($("#NewChipCarWashFlgHidden").val()==C_CARWASHNEEDFLG_NEED&&addTime<stdCarwashTime)addTime=stdCarwashTime;scheDeliDateTime=smbScript.CalcEndDateTime(scheDeliDateTime,addTime);scheDeliDateTime=smbScript.CalcEndDateTime(scheDeliDateTime,$("#StdDeliTime").val());$("#NewChipPlanDeriveredDateTimeSelector").get(0).value=smbScript.getDateTimelocalDate(scheDeliDateTime);$("#NewChipPlanDeriveredTimeLabel").text(smbScript.ConvertDateToStringForDisplay(scheDeliDateTime))}
;
